<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillMatrix Enterprise PRO v3.0</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

    <style>
        /* =========================================
           CORE STYLES & VARIABLES
           ========================================= */
        :root {
            --primary: #6366f1;
            --primary-hover: #4f46e5;
            --primary-light: #e0e7ff;
            --secondary: #64748b;
            --secondary-hover: #475569;
            --success: #10b981;
            --success-hover: #059669;
            --success-light: #d1fae5;
            --warning: #f59e0b;
            --warning-hover: #d97706;
            --warning-light: #fef3c7;
            --danger: #ef4444;
            --danger-hover: #dc2626;
            --danger-light: #fee2e2;
            --info: #06b6d4;
            --info-hover: #0891b2;
            --purple: #8b5cf6;
            --pink: #ec4899;
            
            --bg-body: #f8fafc;
            --bg-card: #ffffff;
            --bg-sidebar: #0f172a;
            --bg-header: #ffffff;
            --bg-hover: #f1f5f9;
            
            --text-main: #0f172a;
            --text-sec: #475569;
            --text-light: #94a3b8;
            --text-inverse: #ffffff;
            
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            --border-dark: #1e293b;
            
            --radius-xs: 4px;
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;
            
            --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-sm: 0 2px 4px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --shadow-xxl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
            
            --font-main: 'Inter', sans-serif;
            --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            
            --sidebar-width: 280px;
            --sidebar-collapsed: 80px;
            --header-height: 70px;
        }

        /* Dark Theme */
        .dark-mode {
            --bg-body: #0f172a;
            --bg-card: #1e293b;
            --bg-sidebar: #0c1425;
            --bg-header: #1e293b;
            --bg-hover: #334155;
            
            --text-main: #f1f5f9;
            --text-sec: #cbd5e1;
            --text-light: #94a3b8;
            
            --border: #334155;
            --border-light: #1e293b;
            --border-dark: #475569;
        }

        * {
            box-sizing: border-box;
            outline: none;
            margin: 0;
            padding: 0;
        }

        body {
            margin: 0;
            font-family: var(--font-main);
            background: var(--bg-body);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            transition: var(--transition-slow);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
            border-radius: var(--radius-full);
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: var(--radius-full);
            border: 2px solid transparent;
            background-clip: padding-box;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        .dark-mode ::-webkit-scrollbar-thumb {
            background: #475569;
        }
        .dark-mode ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* =========================================
           LAYOUT & FRAMEWORK
           ========================================= */
        #app {
            display: flex;
            height: 100vh;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        #app.loaded {
            opacity: 1;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-sidebar);
            color: white;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            transition: var(--transition);
            position: relative;
            z-index: 100;
            box-shadow: var(--shadow-xl);
        }
        .sidebar.collapsed {
            width: var(--sidebar-collapsed);
        }
        .sidebar.collapsed .nav-text,
        .sidebar.collapsed .user-info,
        .sidebar.collapsed .sidebar-header span {
            display: none;
        }
        .sidebar.collapsed .nav-link {
            justify-content: center;
            padding: 16px;
        }
        .sidebar.collapsed .nav-link i {
            margin-right: 0;
            font-size: 1.3rem;
        }
        .sidebar.collapsed .user-mini-profile {
            justify-content: center;
            padding: 20px 0;
        }
        .sidebar.collapsed .logout-btn {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
        }

        .sidebar-header {
            height: var(--header-height);
            display: flex;
            align-items: center;
            padding: 0 24px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 1.5rem;
            font-weight: 800;
            letter-spacing: -0.5px;
            position: relative;
        }
        .sidebar-header i {
            color: var(--primary);
            margin-right: 12px;
            font-size: 1.8rem;
        }
        .sidebar-toggle {
            position: absolute;
            right: -12px;
            background: var(--primary);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-md);
        }
        .sidebar-toggle:hover {
            transform: scale(1.1);
        }

        .nav-list {
            list-style: none;
            padding: 24px 12px;
            margin: 0;
            flex: 1;
            overflow-y: auto;
        }
        .nav-item {
            margin-bottom: 8px;
            position: relative;
        }
        .nav-link {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            color: #94a3b8;
            text-decoration: none;
            border-radius: var(--radius-md);
            transition: var(--transition);
            cursor: pointer;
            font-weight: 500;
            font-size: 0.95rem;
            position: relative;
            overflow: hidden;
        }
        .nav-link:before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--primary);
            transform: translateX(-100%);
            transition: var(--transition);
        }
        .nav-link:hover {
            background: rgba(255,255,255,0.05);
            color: white;
            transform: translateX(4px);
        }
        .nav-link:hover:before {
            transform: translateX(0);
        }
        .nav-link.active {
            background: rgba(99, 102, 241, 0.15);
            color: white;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }
        .nav-link.active:before {
            transform: translateX(0);
        }
        .nav-link i {
            width: 24px;
            text-align: center;
            margin-right: 12px;
            font-size: 1.2rem;
            transition: var(--transition);
        }
        .nav-link.active i {
            transform: scale(1.1);
        }
        .nav-badge {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--danger);
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: var(--radius-full);
            min-width: 20px;
            text-align: center;
        }

        .user-mini-profile {
            padding: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(0,0,0,0.1);
            transition: var(--transition);
        }
        .avatar {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--primary), var(--purple));
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }
        .avatar.online:after {
            content: '';
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 10px;
            height: 10px;
            background: var(--success);
            border-radius: 50%;
            border: 2px solid var(--bg-sidebar);
        }
        .user-info {
            flex: 1;
            min-width: 0;
        }
        .user-info div:first-child {
            font-weight: 600;
            font-size: 0.95rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .user-info div:last-child {
            font-size: 0.75rem;
            color: #94a3b8;
            text-transform: capitalize;
            margin-top: 2px;
        }
        .logout-btn {
            background: rgba(239, 68, 68, 0.1);
            border: none;
            color: #ef4444;
            cursor: pointer;
            padding: 8px;
            border-radius: var(--radius-md);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
        }
        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: rotate(15deg);
        }

        /* Main Content */
        .main-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }
        .top-header {
            height: var(--header-height);
            background: var(--bg-header);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 32px;
            box-shadow: var(--shadow-sm);
            z-index: 50;
            transition: var(--transition);
        }
        .page-title {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--text-main);
            background: linear-gradient(90deg, var(--primary), var(--purple));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
        }
        .page-title i {
            margin-right: 12px;
        }
        .header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        .page-content {
            flex: 1;
            overflow-y: auto;
            padding: 32px;
            scroll-behavior: smooth;
            position: relative;
        }
        .page-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--purple));
            opacity: 0;
            animation: slideInRight 0.8s ease 0.3s forwards;
        }

        /* =========================================
           UI COMPONENTS
           ========================================= */
        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: var(--transition);
            font-size: 0.95rem;
            position: relative;
            overflow: hidden;
        }
        .btn:after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        .btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.4);
        }
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        .btn-secondary:hover {
            background: var(--secondary-hover);
            transform: translateY(-1px);
        }
        .btn-success {
            background: var(--success);
            color: white;
        }
        .btn-success:hover {
            background: var(--success-hover);
            transform: translateY(-1px);
        }
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        .btn-warning:hover {
            background: var(--warning-hover);
            transform: translateY(-1px);
        }
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        .btn-danger:hover {
            background: var(--danger-hover);
            transform: translateY(-1px);
        }
        .btn-outline {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text-sec);
        }
        .btn-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: var(--primary-light);
        }
        .btn-ghost {
            background: transparent;
            color: var(--text-sec);
        }
        .btn-ghost:hover {
            background: var(--bg-hover);
            color: var(--text-main);
        }
        .btn-icon {
            padding: 12px;
            border-radius: var(--radius-md);
            width: 44px;
            height: 44px;
        }
        .btn-sm {
            padding: 8px 16px;
            font-size: 0.85rem;
        }
        .btn-lg {
            padding: 16px 32px;
            font-size: 1.1rem;
        }
        .btn-group {
            display: inline-flex;
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        .btn-group .btn {
            border-radius: 0;
            border-right: 1px solid rgba(255,255,255,0.2);
        }
        .btn-group .btn:last-child {
            border-right: none;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 28px;
            box-shadow: var(--shadow-md);
            margin-bottom: 24px;
            border: 1px solid var(--border);
            animation: slideUp 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }
        .card:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--purple));
            opacity: 0;
            transition: var(--transition);
        }
        .card:hover:before {
            opacity: 1;
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }
        .card-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .card-subtitle {
            font-size: 0.9rem;
            color: var(--text-sec);
            margin-top: 4px;
        }
        .card-body {
            margin-top: 16px;
        }
        .card-footer {
            margin-top: 20px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }
        .stat-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 24px;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            border: 1px solid var(--border);
            animation: fadeIn 0.6s ease-out;
        }
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            flex-shrink: 0;
        }
        .stat-icon.primary {
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            color: white;
        }
        .stat-icon.success {
            background: linear-gradient(135deg, var(--success-light), var(--success));
            color: white;
        }
        .stat-icon.warning {
            background: linear-gradient(135deg, var(--warning-light), var(--warning));
            color: white;
        }
        .stat-icon.danger {
            background: linear-gradient(135deg, var(--danger-light), var(--danger));
            color: white;
        }
        .stat-info {
            flex: 1;
        }
        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            line-height: 1;
            margin-bottom: 4px;
            background: linear-gradient(90deg, var(--primary), var(--purple));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-sec);
            font-weight: 500;
        }
        .stat-change {
            font-size: 0.8rem;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: var(--radius-full);
            display: inline-block;
            margin-top: 8px;
        }
        .stat-change.positive {
            background: var(--success-light);
            color: var(--success);
        }
        .stat-change.negative {
            background: var(--danger-light);
            color: var(--danger);
        }

        /* Forms */
        .form-group {
            margin-bottom: 24px;
            position: relative;
        }
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-main);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .form-label.required:after {
            content: '*';
            color: var(--danger);
            margin-left: 4px;
        }
        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius-md);
            font-size: 0.95rem;
            transition: var(--transition);
            background: var(--bg-card);
            color: var(--text-main);
            font-family: var(--font-main);
        }
        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
            transform: translateY(-1px);
        }
        .form-control:hover:not(:focus) {
            border-color: var(--text-light);
        }
        .form-text {
            font-size: 0.85rem;
            color: var(--text-sec);
            margin-top: 6px;
            display: block;
        }
        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 16px;
            padding-right: 48px;
        }
        .form-check {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            margin-bottom: 12px;
        }
        .form-check-input {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--bg-card);
            cursor: pointer;
            position: relative;
            transition: var(--transition);
        }
        .form-check-input:checked {
            background: var(--primary);
            border-color: var(--primary);
        }
        .form-check-input:checked:after {
            content: 'âœ“';
            position: absolute;
            color: white;
            font-size: 14px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .form-check-label {
            font-size: 0.95rem;
            color: var(--text-main);
        }

        /* Badges & Tags */
        .badge {
            padding: 6px 12px;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }
        .badge-sm {
            padding: 4px 8px;
            font-size: 0.7rem;
        }
        .badge-lg {
            padding: 8px 16px;
            font-size: 0.85rem;
        }
        .badge-primary {
            background: var(--primary-light);
            color: var(--primary);
        }
        .badge-success {
            background: var(--success-light);
            color: var(--success);
        }
        .badge-warning {
            background: var(--warning-light);
            color: var(--warning);
        }
        .badge-danger {
            background: var(--danger-light);
            color: var(--danger);
        }
        .badge-info {
            background: #dbeafe;
            color: #1d4ed8;
        }
        .badge-purple {
            background: #ede9fe;
            color: #7c3aed;
        }
        .badge-pending {
            background: var(--bg-hover);
            color: var(--text-sec);
        }
        .badge-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
            box-shadow: var(--shadow-sm);
            background: var(--bg-card);
            animation: fadeIn 0.5s ease-out;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
            background: var(--bg-card);
        }
        th, td {
            padding: 16px 20px;
            text-align: left;
            border-bottom: 1px solid var(--border);
            transition: var(--transition);
        }
        th {
            background: var(--bg-hover);
            font-weight: 700;
            color: var(--text-main);
            position: sticky;
            top: 0;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }
        tr:hover td {
            background: var(--bg-hover);
        }
        tr:last-child td {
            border-bottom: none;
        }
        .table-striped tr:nth-child(even) td {
            background: var(--bg-body);
        }
        .table-hover tr {
            cursor: pointer;
        }
        .table-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        /* Skill Tree */
        .category-block {
            margin-bottom: 20px;
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            background: var(--bg-card);
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
            animation: slideInLeft 0.5s ease-out;
        }
        .category-block:hover {
            box-shadow: var(--shadow-md);
            transform: translateX(4px);
        }
        .category-header {
            padding: 20px 24px;
            background: var(--bg-hover);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            transition: var(--transition);
            user-select: none;
        }
        .category-header:hover {
            background: var(--bg-body);
        }
        .category-header i {
            transition: var(--transition);
        }
        .category-header.collapsed i {
            transform: rotate(-90deg);
        }
        .skill-list {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .skill-list.open {
            max-height: 1000px;
        }
        .skill-row {
            padding: 20px 24px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
            animation: fadeInUp 0.4s ease-out;
        }
        .skill-row:hover {
            background: var(--bg-hover);
            transform: translateX(8px);
        }
        .skill-info {
            flex: 1;
        }
        .skill-name {
            font-weight: 600;
            font-size: 1rem;
            color: var(--text-main);
            margin-bottom: 4px;
        }
        .skill-desc {
            font-size: 0.85rem;
            color: var(--text-sec);
        }
        .skill-tags {
            display: flex;
            gap: 8px;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        /* Rating System */
        .rating-input {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .star-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            border: 2px solid var(--border);
            background: var(--bg-card);
            color: var(--text-light);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1rem;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        .star-btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--warning), #f59e0b);
            opacity: 0;
            transition: var(--transition);
        }
        .star-btn:hover {
            border-color: var(--warning);
            color: var(--warning);
            transform: scale(1.1) rotate(5deg);
        }
        .star-btn:hover:before {
            opacity: 0.1;
        }
        .star-btn.active {
            background: var(--warning);
            border-color: var(--warning);
            color: white;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }
        .star-btn.active:before {
            opacity: 0;
        }
        .star-btn.readonly {
            cursor: default;
            transform: none !important;
        }
        .rating-label {
            font-size: 0.9rem;
            color: var(--text-sec);
            margin-left: 12px;
            min-width: 100px;
        }

        /* Progress Bars */
        .progress-bar {
            height: 8px;
            background: var(--border);
            border-radius: var(--radius-full);
            overflow: hidden;
            margin: 12px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--purple));
            border-radius: var(--radius-full);
            transition: width 1s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }
        .progress-fill:after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 20px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }
        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--text-sec);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 2px solid var(--border);
            margin-bottom: 24px;
            position: relative;
        }
        .tab {
            padding: 16px 24px;
            font-weight: 600;
            color: var(--text-sec);
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
        }
        .tab:hover {
            color: var(--text-main);
        }
        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        .tab-indicator {
            position: absolute;
            bottom: -2px;
            height: 2px;
            background: var(--primary);
            transition: var(--transition);
        }
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        .tab-content.active {
            display: block;
        }

        /* Accordion */
        .accordion {
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            margin-bottom: 16px;
        }
        .accordion-header {
            padding: 20px 24px;
            background: var(--bg-hover);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            transition: var(--transition);
        }
        .accordion-header:hover {
            background: var(--bg-body);
        }
        .accordion-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .accordion-content.open {
            padding: 24px;
            max-height: 2000px;
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(8px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            padding: 20px;
        }
        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        .modal {
            background: var(--bg-card);
            width: 90%;
            max-width: 800px;
            border-radius: var(--radius-xl);
            padding: 0;
            box-shadow: var(--shadow-xxl);
            transform: translateY(30px) scale(0.95);
            transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex;
            flex-direction: column;
            max-height: 90vh;
            border: 1px solid var(--border);
            overflow: hidden;
        }
        .modal-overlay.active .modal {
            transform: translateY(0) scale(1);
        }
        .modal-header {
            padding: 24px 32px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--bg-card), var(--bg-hover));
        }
        .modal-body {
            padding: 32px;
            overflow-y: auto;
            flex: 1;
        }
        .modal-footer {
            padding: 20px 32px;
            border-top: 1px solid var(--border);
            background: var(--bg-hover);
            display: flex;
            justify-content: flex-end;
            gap: 16px;
            border-bottom-left-radius: var(--radius-xl);
            border-bottom-right-radius: var(--radius-xl);
        }
        .modal-close {
            background: none;
            border: none;
            color: var(--text-sec);
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        .modal-close:hover {
            background: var(--danger-light);
            color: var(--danger);
            transform: rotate(90deg);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 32px;
            right: 32px;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        .toast {
            min-width: 320px;
            padding: 18px 24px;
            background: var(--bg-card);
            border-left: 6px solid var(--primary);
            box-shadow: var(--shadow-xl);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: flex-start;
            gap: 16px;
            animation: slideInRight 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            transform-origin: right center;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }
        .toast:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--purple));
            opacity: 0.3;
        }
        .toast.success {
            border-left-color: var(--success);
        }
        .toast.success i {
            color: var(--success);
        }
        .toast.error {
            border-left-color: var(--danger);
        }
        .toast.error i {
            color: var(--danger);
        }
        .toast.warning {
            border-left-color: var(--warning);
        }
        .toast.warning i {
            color: var(--warning);
        }
        .toast.info {
            border-left-color: var(--info);
        }
        .toast.info i {
            color: var(--info);
        }
        .toast-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
            margin-top: 2px;
        }
        .toast-content {
            flex: 1;
        }
        .toast-title {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 4px;
            color: var(--text-main);
        }
        .toast-message {
            font-size: 0.9rem;
            color: var(--text-sec);
            line-height: 1.5;
        }
        .toast-close {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            padding: 4px;
            border-radius: var(--radius-sm);
            transition: var(--transition);
            flex-shrink: 0;
        }
        .toast-close:hover {
            background: var(--bg-hover);
            color: var(--text-main);
        }

        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        .spinner-sm {
            width: 20px;
            height: 20px;
            border-width: 2px;
        }
        .spinner-lg {
            width: 60px;
            height: 60px;
            border-width: 4px;
        }

        /* Tooltips */
        [data-tooltip] {
            position: relative;
        }
        [data-tooltip]:before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-8px);
            background: var(--text-main);
            color: white;
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
            font-weight: 500;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 1000;
            box-shadow: var(--shadow-md);
            pointer-events: none;
        }
        [data-tooltip]:after {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(0);
            border: 6px solid transparent;
            border-top-color: var(--text-main);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 1000;
            pointer-events: none;
        }
        [data-tooltip]:hover:before,
        [data-tooltip]:hover:after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-4px);
        }

        /* Animations */
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-100%); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        @keyframes ripple {
            0% { transform: scale(0, 0); opacity: 1; }
            20% { transform: scale(25, 25); opacity: 1; }
            100% { opacity: 0; transform: scale(40, 40); }
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Login Page */
        .login-container {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #06b6d4 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            overflow: hidden;
        }
        .login-container:before {
            content: '';
            position: absolute;
            inset: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            animation: backgroundMove 20s linear infinite;
        }
        @keyframes backgroundMove {
            from { transform: translateY(0); }
            to { transform: translateY(60px); }
        }
        .login-card {
            width: 480px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 48px;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xxl);
            text-align: center;
            position: relative;
            z-index: 1;
            animation: slideUp 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .login-logo {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 24px;
            animation: bounce 2s infinite;
        }
        .login-title {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 8px;
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .login-subtitle {
            color: #64748b;
            margin-bottom: 40px;
            font-size: 1.1rem;
        }
        .login-form {
            text-align: left;
        }
        .login-footer {
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid #e2e8f0;
            font-size: 0.9rem;
            color: #94a3b8;
        }
        .login-footer strong {
            color: #4f46e5;
            font-weight: 700;
        }

        /* Dashboard Specific */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 24px;
            margin-top: 24px;
        }
        .dashboard-card {
            grid-column: span 4;
        }
        .dashboard-card-wide {
            grid-column: span 8;
        }
        .dashboard-card-full {
            grid-column: span 12;
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        .timeline:before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, var(--primary), var(--purple));
        }
        .timeline-item {
            position: relative;
            margin-bottom: 24px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border);
        }
        .timeline-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .timeline-item:before {
            content: '';
            position: absolute;
            left: -30px;
            top: 4px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: var(--primary);
            border: 3px solid var(--bg-card);
            box-shadow: 0 0 0 3px var(--primary-light);
        }
        .timeline-date {
            font-size: 0.85rem;
            color: var(--text-sec);
            margin-bottom: 8px;
            font-weight: 600;
        }
        .timeline-content {
            background: var(--bg-hover);
            padding: 16px;
            border-radius: var(--radius-md);
            border-left: 4px solid var(--primary);
        }

        /* Calendar */
        .calendar {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid var(--border);
        }
        .calendar-header {
            padding: 20px;
            background: var(--bg-hover);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: var(--border);
        }
        .calendar-day {
            background: var(--bg-card);
            padding: 12px;
            min-height: 80px;
            font-weight: 600;
            color: var(--text-main);
        }
        .calendar-day.header {
            background: var(--bg-hover);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-sec);
            text-align: center;
            padding: 12px;
        }
        .calendar-day.other-month {
            color: var(--text-light);
            background: var(--bg-body);
        }
        .calendar-day.today {
            background: var(--primary-light);
            position: relative;
        }
        .calendar-day.today:before {
            content: '';
            position: absolute;
            top: 4px;
            right: 4px;
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
        }
        .calendar-event {
            font-size: 0.8rem;
            padding: 4px 8px;
            margin-top: 4px;
            border-radius: var(--radius-sm);
            background: var(--success-light);
            color: var(--success);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            cursor: pointer;
            transition: var(--transition);
        }
        .calendar-event:hover {
            transform: translateX(4px);
        }

        /* File Upload */
        .file-upload {
            border: 2px dashed var(--border);
            border-radius: var(--radius-lg);
            padding: 48px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: var(--bg-body);
        }
        .file-upload:hover {
            border-color: var(--primary);
            background: var(--primary-light);
            transform: translateY(-4px);
        }
        .file-upload i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 20px;
            display: block;
        }
        .file-upload input[type="file"] {
            display: none;
        }

        /* Chat */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 600px;
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            background: var(--bg-card);
        }
        .chat-header {
            padding: 20px;
            background: var(--bg-hover);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        .message {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: var(--radius-lg);
            position: relative;
            animation: fadeInUp 0.3s ease-out;
        }
        .message.sent {
            align-self: flex-end;
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            border-bottom-right-radius: var(--radius-sm);
        }
        .message.received {
            align-self: flex-start;
            background: var(--bg-hover);
            color: var(--text-main);
            border-bottom-left-radius: var(--radius-sm);
        }
        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 4px;
            text-align: right;
        }
        .chat-input {
            padding: 20px;
            border-top: 1px solid var(--border);
            background: var(--bg-hover);
            display: flex;
            gap: 12px;
        }

        /* Kanban Board */
        .kanban-board {
            display: flex;
            gap: 24px;
            overflow-x: auto;
            padding: 20px;
            height: 600px;
        }
        .kanban-column {
            min-width: 300px;
            background: var(--bg-hover);
            border-radius: var(--radius-lg);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        .kanban-column-header {
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
            color: var(--text-main);
        }
        .kanban-cards {
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .kanban-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 16px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-sm);
            cursor: move;
            transition: var(--transition);
        }
        .kanban-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary);
        }
        .kanban-card-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-main);
        }
        .kanban-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 12px;
            font-size: 0.85rem;
            color: var(--text-sec);
        }

        /* Dark Mode Toggle */
        .theme-toggle {
            width: 60px;
            height: 32px;
            background: var(--border);
            border-radius: var(--radius-full);
            position: relative;
            cursor: pointer;
            transition: var(--transition);
        }
        .theme-toggle:before {
            content: '';
            position: absolute;
            top: 4px;
            left: 4px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }
        .dark-mode .theme-toggle:before {
            transform: translateX(28px);
            background: var(--primary);
        }
        .theme-toggle i {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.9rem;
        }
        .theme-toggle i.fa-sun {
            left: 8px;
            color: #f59e0b;
        }
        .theme-toggle i.fa-moon {
            right: 8px;
            color: #64748b;
        }

        /* Utility Classes */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-left { text-align: left; }
        .text-primary { color: var(--primary); }
        .text-success { color: var(--success); }
        .text-warning { color: var(--warning); }
        .text-danger { color: var(--danger); }
        .text-muted { color: var(--text-sec); }
        .text-light { color: var(--text-light); }
        
        .bg-primary { background: var(--primary); }
        .bg-success { background: var(--success); }
        .bg-warning { background: var(--warning); }
        .bg-danger { background: var(--danger); }
        
        .mt-0 { margin-top: 0; }
        .mt-1 { margin-top: 4px; }
        .mt-2 { margin-top: 8px; }
        .mt-3 { margin-top: 12px; }
        .mt-4 { margin-top: 16px; }
        .mt-5 { margin-top: 20px; }
        .mt-6 { margin-top: 24px; }
        
        .mb-0 { margin-bottom: 0; }
        .mb-1 { margin-bottom: 4px; }
        .mb-2 { margin-bottom: 8px; }
        .mb-3 { margin-bottom: 12px; }
        .mb-4 { margin-bottom: 16px; }
        .mb-5 { margin-bottom: 20px; }
        .mb-6 { margin-bottom: 24px; }
        
        .p-0 { padding: 0; }
        .p-1 { padding: 4px; }
        .p-2 { padding: 8px; }
        .p-3 { padding: 12px; }
        .p-4 { padding: 16px; }
        .p-5 { padding: 20px; }
        .p-6 { padding: 24px; }
        
        .d-flex { display: flex; }
        .d-inline-flex { display: inline-flex; }
        .flex-column { flex-direction: column; }
        .align-items-center { align-items: center; }
        .justify-content-between { justify-content: space-between; }
        .justify-content-center { justify-content: center; }
        .flex-wrap { flex-wrap: wrap; }
        .gap-1 { gap: 4px; }
        .gap-2 { gap: 8px; }
        .gap-3 { gap: 12px; }
        .gap-4 { gap: 16px; }
        .gap-5 { gap: 20px; }
        
        .w-100 { width: 100%; }
        .h-100 { height: 100%; }
        
        .rounded { border-radius: var(--radius-md); }
        .rounded-circle { border-radius: var(--radius-full); }
        
        .shadow { box-shadow: var(--shadow-md); }
        .shadow-sm { box-shadow: var(--shadow-sm); }
        .shadow-lg { box-shadow: var(--shadow-lg); }
        
        .cursor-pointer { cursor: pointer; }
        .user-select-none { user-select: none; }
        
        .overflow-hidden { overflow: hidden; }
        .overflow-auto { overflow: auto; }
        
        .position-relative { position: relative; }
        .position-absolute { position: absolute; }
        
        .animate__animated { animation-duration: 0.6s; }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: repeat(6, 1fr);
            }
            .dashboard-card {
                grid-column: span 3;
            }
            .dashboard-card-wide {
                grid-column: span 6;
            }
            .dashboard-card-full {
                grid-column: span 6;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -280px;
                z-index: 1000;
            }
            .sidebar.active {
                left: 0;
            }
            .sidebar-toggle {
                display: none;
            }
            .mobile-menu-toggle {
                display: block !important;
            }
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            .dashboard-card,
            .dashboard-card-wide,
            .dashboard-card-full {
                grid-column: span 1;
            }
            .page-content {
                padding: 16px;
            }
            .top-header {
                padding: 0 16px;
            }
            .modal {
                width: 95%;
                max-height: 80vh;
            }
            .modal-body {
                padding: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .login-card {
                width: 90%;
                padding: 32px;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
            .btn-group {
                flex-wrap: wrap;
            }
            .btn-group .btn {
                flex: 1;
                min-width: 120px;
            }
        }

        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--text-main);
            font-size: 1.5rem;
            cursor: pointer;
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            transition: var(--transition);
        }
        .mobile-menu-toggle:hover {
            background: var(--bg-hover);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        /**
         * ==================================================================================
         * PART 1: EXTENDED MOCK DATA & CONFIG
         * ==================================================================================
         */
        const CONFIG = {
            roles: { 
                EMPLOYEE: 'employee', 
                MANAGER: 'manager', 
                ADMIN: 'admin',
                HR: 'hr',
                DIRECTOR: 'director'
            },
            depts: ['Frontend', 'Backend', 'Design', 'QA', 'HR', 'Marketing', 'Sales', 'Support', 'DevOps'],
            positions: [
                'Junior Developer', 'Middle Developer', 'Senior Developer', 
                'Team Lead', 'Project Manager', 'Designer', 'QA Engineer',
                'HR Manager', 'Marketing Specialist', 'Sales Manager'
            ],
            skillLevels: ['ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº', 'ÐÐ°Ñ‡Ð¸Ð½Ð°ÑŽÑ‰Ð¸Ð¹', 'ÐšÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ‚Ð½Ñ‹Ð¹', 'ÐžÐ¿Ñ‹Ñ‚Ð½Ñ‹Ð¹', 'Ð­ÐºÑÐ¿ÐµÑ€Ñ‚'],
            icons: {
                'code': 'fa-code', 'server': 'fa-server', 'paint': 'fa-paint-brush',
                'bug': 'fa-bug', 'users': 'fa-users', 'brain': 'fa-brain',
                'chart': 'fa-chart-line', 'database': 'fa-database', 'mobile': 'fa-mobile-alt',
                'cloud': 'fa-cloud', 'security': 'fa-shield-alt', 'ai': 'fa-robot'
            },
            statuses: {
                pending: { text: 'ÐÐ° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ', color: 'warning' },
                approved: { text: 'ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¾', color: 'success' },
                rejected: { text: 'ÐžÑ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¾', color: 'danger' },
                draft: { text: 'Ð§ÐµÑ€Ð½Ð¾Ð²Ð¸Ðº', color: 'secondary' }
            }
        };

        // Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ð°Ñ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð°Ñ Ð±Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…
        const SEED_DB = {
            users: [
                { 
                    id: 1, 
                    name: 'Ð˜Ð²Ð°Ð½ ÐŸÐµÑ‚Ñ€Ð¾Ð²', 
                    login: 'user', 
                    password: '123', 
                    role: 'employee', 
                    dept: 'Frontend', 
                    position: 'Middle Developer',
                    avatar: 'IP', 
                    skillsRequiredRated: false,
                    email: 'ivan.petrov@company.com',
                    phone: '+7 (999) 123-45-67',
                    hireDate: '2023-01-15',
                    salary: 120000,
                    performance: 4.2,
                    status: 'active',
                    bio: 'Frontend Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ñ Ð¾Ð¿Ñ‹Ñ‚Ð¾Ð¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ 3 Ð³Ð¾Ð´Ð°. Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽÑÑŒ Ð½Ð° React Ð¸ TypeScript.'
                },
                { 
                    id: 2, 
                    name: 'ÐŸÐµÑ‚Ñ€ Ð¡Ð¸Ð´Ð¾Ñ€Ð¾Ð²', 
                    login: 'manager', 
                    password: '123', 
                    role: 'manager', 
                    dept: 'Frontend', 
                    position: 'Team Lead',
                    avatar: 'PS', 
                    skillsRequiredRated: true,
                    email: 'peter.sidorov@company.com',
                    phone: '+7 (999) 987-65-43',
                    hireDate: '2021-03-10',
                    salary: 200000,
                    performance: 4.8,
                    status: 'active',
                    bio: 'Ð ÑƒÐºÐ¾Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒ frontend-Ð¾Ñ‚Ð´ÐµÐ»Ð°. ÐžÐ¿Ñ‹Ñ‚ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹ 5 Ð»ÐµÑ‚.'
                },
                { 
                    id: 3, 
                    name: 'ÐÐ½Ð½Ð° Ð˜Ð²Ð°Ð½Ð¾Ð²Ð°', 
                    login: 'admin', 
                    password: '123', 
                    role: 'admin', 
                    dept: 'HR', 
                    position: 'HR Manager',
                    avatar: 'AI', 
                    skillsRequiredRated: true,
                    email: 'anna.ivanova@company.com',
                    phone: '+7 (999) 555-12-34',
                    hireDate: '2020-11-05',
                    salary: 180000,
                    performance: 4.5,
                    status: 'active',
                    bio: 'HR ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚ Ñ Ñ„Ð¾ÐºÑƒÑÐ¾Ð¼ Ð½Ð° Ñ€Ð°Ð·Ð²Ð¸Ñ‚Ð¸Ð¸ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»Ð° Ð¸ Ð¾Ñ†ÐµÐ½ÐºÐµ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹.'
                },
                { 
                    id: 4, 
                    name: 'Ð¡ÐµÑ€Ð³ÐµÐ¹ Ð‘ÑÐºÐµÐ½Ð´Ð¾Ð²', 
                    login: 'dev2', 
                    password: '123', 
                    role: 'employee', 
                    dept: 'Backend', 
                    position: 'Senior Developer',
                    avatar: 'Ð¡Ð‘', 
                    skillsRequiredRated: true,
                    email: 'sergey.backend@company.com',
                    phone: '+7 (999) 777-88-99',
                    hireDate: '2022-06-20',
                    salary: 180000,
                    performance: 4.7,
                    status: 'active',
                    bio: 'Backend Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð½Ð° Node.js Ð¸ Python. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð² Ð¼Ð¸ÐºÑ€Ð¾ÑÐµÑ€Ð²Ð¸ÑÐ½Ð¾Ð¹ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ðµ.'
                },
                { 
                    id: 5, 
                    name: 'Ð•Ð»ÐµÐ½Ð° Ð”Ð¸Ð·Ð°Ð¹Ð½ÐµÑ€Ð¾Ð²Ð°', 
                    login: 'des1', 
                    password: '123', 
                    role: 'employee', 
                    dept: 'Design', 
                    position: 'Senior Designer',
                    avatar: 'Ð•Ð”', 
                    skillsRequiredRated: true,
                    email: 'elena.design@company.com',
                    phone: '+7 (999) 333-22-11',
                    hireDate: '2021-09-12',
                    salary: 150000,
                    performance: 4.3,
                    status: 'active',
                    bio: 'UI/UX Ð´Ð¸Ð·Ð°Ð¹Ð½ÐµÑ€ Ñ Ð¾Ð¿Ñ‹Ñ‚Ð¾Ð¼ 4 Ð³Ð¾Ð´Ð°. Ð Ð°Ð±Ð¾Ñ‚Ð°Ð»Ð° Ð½Ð°Ð´ ÐºÑ€ÑƒÐ¿Ð½Ñ‹Ð¼Ð¸ ÐºÐ¾Ñ€Ð¿Ð¾Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¼Ð¸ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°Ð¼Ð¸.'
                },
                { 
                    id: 6, 
                    name: 'ÐœÐ°Ñ€Ð¸Ñ HR', 
                    login: 'hr1', 
                    password: '123', 
                    role: 'hr', 
                    dept: 'HR', 
                    position: 'HR Specialist',
                    avatar: 'ÐœÐ', 
                    skillsRequiredRated: true,
                    email: 'maria.hr@company.com',
                    phone: '+7 (999) 444-55-66',
                    hireDate: '2023-02-28',
                    salary: 90000,
                    performance: 4.0,
                    status: 'active',
                    bio: 'Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚ Ð¿Ð¾ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ñƒ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»Ð° Ð¸ Ð°Ð´Ð°Ð¿Ñ‚Ð°Ñ†Ð¸Ð¸ Ð½Ð¾Ð²Ñ‹Ñ… ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð².'
                }
            ],
            categories: [
                { id: 'c1', name: 'Frontend Ñ‚ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¸', icon: 'fa-code', color: '#6366f1', description: 'ÐÐ°Ð²Ñ‹ÐºÐ¸ frontend Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸' },
                { id: 'c2', name: 'Backend Ñ‚ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¸', icon: 'fa-server', color: '#10b981', description: 'ÐÐ°Ð²Ñ‹ÐºÐ¸ backend Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸' },
                { id: 'c3', name: 'Ð”Ð¸Ð·Ð°Ð¹Ð½', icon: 'fa-paint-brush', color: '#8b5cf6', description: 'UI/UX Ð´Ð¸Ð·Ð°Ð¹Ð½ Ð¸ Ð¿Ñ€Ð¾Ñ‚Ð¾Ñ‚Ð¸Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ' },
                { id: 'c4', name: 'Ð‘Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…', icon: 'fa-database', color: '#f59e0b', description: 'Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð±Ð°Ð·Ð°Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…' },
                { id: 'c5', name: 'DevOps', icon: 'fa-cloud', color: '#06b6d4', description: 'DevOps Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð¸ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸' },
                { id: 'c6', name: 'Ð“Ð¸Ð±ÐºÐ¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¸', icon: 'fa-brain', color: '#ec4899', description: 'Soft skills Ð¸ ÐºÐ¾Ð¼Ð¼ÑƒÐ½Ð¸ÐºÐ°Ñ†Ð¸Ñ' }
            ],
            skills: [
                { id: 's1', catId: 'c1', name: 'JavaScript/ES6+', description: 'Ð¡Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ JavaScript', requiredFor: ['Frontend'], level: 5 },
                { id: 's2', catId: 'c1', name: 'React + hooks', description: 'Ð‘Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ° React Ñ Ñ…ÑƒÐºÐ°Ð¼Ð¸', requiredFor: ['Frontend'], level: 5 },
                { id: 's3', catId: 'c1', name: 'TypeScript', description: 'Ð¢Ð¸Ð¿Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ JavaScript', requiredFor: ['Frontend'], level: 4 },
                { id: 's4', catId: 'c1', name: 'Vue.js', description: 'Ð¤Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€Ðº Vue.js', requiredFor: ['Frontend'], level: 3 },
                { id: 's5', catId: 'c1', name: 'CSS/Sass/SCSS', description: 'Ð¡Ñ‚Ð¸Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¸ Ð¿Ñ€ÐµÐ¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ñ€Ñ‹', requiredFor: ['Frontend', 'Design'], level: 4 },
                { id: 's6', catId: 'c2', name: 'Node.js', description: 'Ð¡ÐµÑ€Ð²ÐµÑ€Ð½Ñ‹Ð¹ JavaScript', requiredFor: ['Backend'], level: 5 },
                { id: 's7', catId: 'c2', name: 'Python/Django', description: 'Python Ð¸ Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€Ðº Django', requiredFor: ['Backend'], level: 4 },
                { id: 's8', catId: 'c2', name: 'Java/Spring', description: 'Java Ð¸ Spring Framework', requiredFor: ['Backend'], level: 3 },
                { id: 's9', catId: 'c3', name: 'Figma/Adobe XD', description: 'Ð”Ð¸Ð·Ð°Ð¹Ð½ Ð¸ Ð¿Ñ€Ð¾Ñ‚Ð¾Ñ‚Ð¸Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ', requiredFor: ['Design'], level: 5 },
                { id: 's10', catId: 'c3', name: 'UI/UX Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ñ‹', description: 'ÐŸÑ€Ð¸Ð½Ñ†Ð¸Ð¿Ñ‹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¾Ð³Ð¾ Ð¾Ð¿Ñ‹Ñ‚Ð°', requiredFor: ['Design'], level: 4 },
                { id: 's11', catId: 'c4', name: 'PostgreSQL', description: 'Ð ÐµÐ»ÑÑ†Ð¸Ð¾Ð½Ð½Ð°Ñ Ð±Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…', requiredFor: ['Backend'], level: 4 },
                { id: 's12', catId: 'c4', name: 'MongoDB', description: 'NoSQL Ð±Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…', requiredFor: ['Backend'], level: 3 },
                { id: 's13', catId: 'c5', name: 'Docker/Kubernetes', description: 'ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¸ Ð¾Ñ€ÐºÐµÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ', requiredFor: ['DevOps', 'Backend'], level: 4 },
                { id: 's14', catId: 'c5', name: 'CI/CD', description: 'ÐÐµÐ¿Ñ€ÐµÑ€Ñ‹Ð²Ð½Ð°Ñ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ°', requiredFor: ['DevOps'], level: 4 },
                { id: 's15', catId: 'c6', name: 'ÐšÐ¾Ð¼Ð¼ÑƒÐ½Ð¸ÐºÐ°Ñ†Ð¸Ñ', description: 'Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð°Ñ ÐºÐ¾Ð¼Ð¼ÑƒÐ½Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ðµ', requiredFor: ['Frontend', 'Backend', 'Design', 'QA', 'HR', 'Marketing'], level: 5 },
                { id: 's16', catId: 'c6', name: 'Ð Ð°Ð±Ð¾Ñ‚Ð° Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ðµ', description: 'ÐšÐ¾Ð»Ð»Ð°Ð±Ð¾Ñ€Ð°Ñ†Ð¸Ñ Ð¸ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð½Ð°Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð°', requiredFor: ['Frontend', 'Backend', 'Design', 'QA', 'HR', 'Marketing'], level: 5 },
                { id: 's17', catId: 'c6', name: 'Ð ÐµÑˆÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼', description: 'ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¼Ñ‹ÑˆÐ»ÐµÐ½Ð¸Ðµ', requiredFor: ['Frontend', 'Backend', 'Design', 'QA'], level: 4 }
            ],
            ratings: [
                { userId: 1, skillId: 's1', value: 4, status: 'approved', date: '2024-01-15', comment: 'Ð¥Ð¾Ñ€Ð¾ÑˆÐµÐµ Ð·Ð½Ð°Ð½Ð¸Ðµ ES6+' },
                { userId: 1, skillId: 's2', value: 3, status: 'approved', date: '2024-01-15', comment: 'Ð Ð°Ð±Ð¾Ñ‚Ð°Ð» Ñ React 1 Ð³Ð¾Ð´' },
                { userId: 1, skillId: 's3', value: 2, status: 'pending', date: '2024-01-20', comment: 'Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ð½Ð°Ñ‡Ð°Ð» Ð¸Ð·ÑƒÑ‡ÐµÐ½Ð¸Ðµ' },
                { userId: 4, skillId: 's6', value: 5, status: 'approved', date: '2024-01-10', comment: 'Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð² Node.js' },
                { userId: 4, skillId: 's11', value: 4, status: 'approved', date: '2024-01-10', comment: 'Ð“Ð»ÑƒÐ±Ð¾ÐºÐ¸Ðµ Ð·Ð½Ð°Ð½Ð¸Ñ PostgreSQL' },
                { userId: 4, skillId: 's13', value: 3, status: 'approved', date: '2024-01-12', comment: 'Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ð·Ð½Ð°Ð½Ð¸Ñ Docker' },
                { userId: 5, skillId: 's9', value: 5, status: 'approved', date: '2024-01-05', comment: 'ÐŸÑ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð» Ð² Figma' },
                { userId: 5, skillId: 's10', value: 4, status: 'approved', date: '2024-01-05', comment: 'Ð¡Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð·Ð½Ð°Ð½Ð¸Ñ UX' },
                { userId: 2, skillId: 's15', value: 5, status: 'approved', date: '2024-01-18', comment: 'ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¸ ÐºÐ¾Ð¼Ð¼ÑƒÐ½Ð¸ÐºÐ°Ñ†Ð¸Ð¸' },
                { userId: 2, skillId: 's16', value: 5, status: 'approved', date: '2024-01-18', comment: 'Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð½Ñ‹Ð¹ Ð¸Ð³Ñ€Ð¾Ðº' },
                { userId: 3, skillId: 's15', value: 4, status: 'approved', date: '2024-01-22', comment: 'Ð¥Ð¾Ñ€Ð¾ÑˆÐ¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¸ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ' },
                { userId: 6, skillId: 's15', value: 3, status: 'approved', date: '2024-01-25', comment: 'Ð Ð°Ð·Ð²Ð¸Ð²Ð°ÑŽ Ð½Ð°Ð²Ñ‹ÐºÐ¸ ÐºÐ¾Ð¼Ð¼ÑƒÐ½Ð¸ÐºÐ°Ñ†Ð¸Ð¸' }
            ],
            goals: [
                { id: 'g1', userId: 1, title: 'Ð˜Ð·ÑƒÑ‡Ð¸Ñ‚ÑŒ TypeScript', description: 'ÐŸÑ€Ð¾Ð¹Ð´Ð¸ ÐºÑƒÑ€Ñ TypeScript Ð¸ Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ð¸ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ', 
                  deadline: '2024-03-01', status: 'in_progress', progress: 40, priority: 'high' },
                { id: 'g2', userId: 1, title: 'ÐŸÐ¾Ð²Ñ‹ÑÐ¸Ñ‚ÑŒ Ð½Ð°Ð²Ñ‹ÐºÐ¸ React', description: 'ÐžÑÐ²Ð¾Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð´Ð²Ð¸Ð½ÑƒÑ‚Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ React', 
                  deadline: '2024-02-15', status: 'not_started', progress: 0, priority: 'medium' },
                { id: 'g3', userId: 4, title: 'Ð˜Ð·ÑƒÑ‡Ð¸Ñ‚ÑŒ Kubernetes', description: 'Ð Ð°Ð·Ð¾Ð±Ñ€Ð°Ñ‚ÑŒÑÑ Ñ Ð¾Ñ€ÐºÐµÑÑ‚Ñ€Ð°Ñ†Ð¸ÐµÐ¹ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¾Ð²', 
                  deadline: '2024-04-01', status: 'in_progress', progress: 20, priority: 'medium' },
                { id: 'g4', userId: 5, title: 'ÐžÑÐ²Ð¾Ð¸Ñ‚ÑŒ 3D Ð´Ð¸Ð·Ð°Ð¹Ð½', description: 'Ð˜Ð·ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¾ÑÐ½Ð¾Ð²Ñ‹ 3D Ð¼Ð¾Ð´ÐµÐ»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð´Ð»Ñ UI', 
                  deadline: '2024-03-15', status: 'completed', progress: 100, priority: 'low' }
            ],
            notifications: [
                { id: 'n1', userId: 1, title: 'ÐÐ¾Ð²Ð°Ñ Ð¾Ñ†ÐµÐ½ÐºÐ° Ð½Ð°Ð²Ñ‹ÐºÐ°', message: 'Ð’Ð°Ñˆ Ð½Ð°Ð²Ñ‹Ðº TypeScript Ð±Ñ‹Ð» Ð¾Ñ†ÐµÐ½ÐµÐ½ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð¼', 
                  type: 'info', read: false, date: '2024-01-20T10:30:00' },
                { id: 'n2', userId: 1, title: 'ÐÐ°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ðµ', message: 'Ð—Ð°Ð²Ñ‚Ñ€Ð° Ð²ÑÑ‚Ñ€ÐµÑ‡Ð° Ð¿Ð¾ Ð¾Ñ†ÐµÐ½ÐºÐµ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹', 
                  type: 'warning', read: false, date: '2024-01-21T09:00:00' },
                { id: 'n3', userId: 2, title: 'ÐÐ¾Ð²Ñ‹Ðµ Ð¾Ñ†ÐµÐ½ÐºÐ¸', message: '2 ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¸ Ð¾Ñ†ÐµÐ½ÐºÐ¸ Ð½Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ', 
                  type: 'info', read: true, date: '2024-01-19T14:20:00' }
            ],
            events: [
                { id: 'e1', title: 'Ð•Ð¶ÐµÐ½ÐµÐ´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¼Ð¸Ñ‚Ð¸Ð½Ð³', description: 'ÐšÐ¾Ð¼Ð°Ð½Ð´Ð½Ð¾Ðµ ÑÐ¾Ð²ÐµÑ‰Ð°Ð½Ð¸Ðµ', 
                  start: '2024-01-22T10:00:00', end: '2024-01-22T11:00:00', participants: [1, 2, 4], type: 'meeting' },
                { id: 'e2', title: 'ÐžÐ±ÑƒÑ‡ÐµÐ½Ð¸Ðµ React', description: 'Ð’Ð¾Ñ€ÐºÑˆÐ¾Ð¿ Ð¿Ð¾ Ð¿Ñ€Ð¾Ð´Ð²Ð¸Ð½ÑƒÑ‚Ð¾Ð¼Ñƒ React', 
                  start: '2024-01-23T14:00:00', end: '2024-01-23T16:00:00', participants: [1, 2], type: 'training' },
                { id: 'e3', title: 'ÐžÑ†ÐµÐ½ÐºÐ° ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹', description: 'Ð¡ÐµÑÑÐ¸Ñ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾Ð¹ ÑÐ²ÑÐ·Ð¸', 
                  start: '2024-01-24T15:00:00', end: '2024-01-24T16:30:00', participants: [1, 2], type: 'review' }
            ],
            feedback: [
                { id: 'f1', fromUserId: 2, toUserId: 1, skillId: 's2', rating: 3, 
                  comment: 'Ð¥Ð¾Ñ€Ð¾ÑˆÐµÐµ Ð¿Ð¾Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ Ð¾ÑÐ½Ð¾Ð² React, Ð½Ð¾ Ð½ÑƒÐ¶Ð½Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ñ Ñ…ÑƒÐºÐ°Ð¼Ð¸', 
                  date: '2024-01-18', status: 'approved' },
                { id: 'f2', fromUserId: 3, toUserId: 1, skillId: 's15', rating: 4, 
                  comment: 'ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð¼ÑƒÐ½Ð¸ÐºÐ°Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¸ Ð½Ð° Ð²ÑÑ‚Ñ€ÐµÑ‡Ð°Ñ…', 
                  date: '2024-01-19', status: 'approved' }
            ]
        };

        /**
         * ==================================================================================
         * PART 2: ENHANCED CORE FRAMEWORK
         * ==================================================================================
         */
        
        // --- Extended Store with LocalStorage ---
        class Store {
            constructor() {
                this.state = this.load();
                this.listeners = [];
                this.eventBus = new EventTarget();
            }
            
            load() {
                const data = localStorage.getItem('skill_matrix_db_pro');
                return data ? JSON.parse(data) : JSON.parse(JSON.stringify(SEED_DB));
            }
            
            save() {
                localStorage.setItem('skill_matrix_db_pro', JSON.stringify(this.state));
                this.notify();
                this.eventBus.dispatchEvent(new CustomEvent('statechange'));
            }
            
            subscribe(fn) { 
                this.listeners.push(fn);
                fn(this.state);
            }
            
            unsubscribe(fn) {
                this.listeners = this.listeners.filter(listener => listener !== fn);
            }
            
            notify() { 
                this.listeners.forEach(fn => fn(this.state));
            }
            
            // Event system
            on(event, callback) {
                this.eventBus.addEventListener(event, callback);
            }
            
            off(event, callback) {
                this.eventBus.removeEventListener(event, callback);
            }
            
            emit(event, data) {
                this.eventBus.dispatchEvent(new CustomEvent(event, { detail: data }));
            }
            
            // Auth Methods
            getUser(login, password) { 
                return this.state.users.find(u => u.login === login && u.password === password); 
            }
            
            getUserById(id) {
                return this.state.users.find(u => u.id === id);
            }
            
            getUsersByDept(dept) { 
                return this.state.users.filter(u => u.dept === dept && u.role === 'employee'); 
            }
            
            getAllUsers() { 
                return this.state.users; 
            }
            
            getManagers() {
                return this.state.users.filter(u => u.role === 'manager' || u.role === 'admin');
            }
            
            getSkills() { 
                return this.state.skills; 
            }
            
            getCategories() { 
                return this.state.categories; 
            }
            
            getSkillById(id) {
                return this.state.skills.find(s => s.id === id);
            }
            
            getCategoryById(id) {
                return this.state.categories.find(c => c.id === id);
            }
            
            // Rating Methods
            getRating(userId, skillId) {
                return this.state.ratings.find(r => r.userId === userId && r.skillId === skillId);
            }
            
            getUserRatings(userId) {
                return this.state.ratings.filter(r => r.userId === userId);
            }
            
            getSkillRatings(skillId) {
                return this.state.ratings.filter(r => r.skillId === skillId);
            }
            
            setRating(userId, skillId, value, status = 'pending', comment = '') {
                let rating = this.getRating(userId, skillId);
                if (rating) {
                    rating.history = rating.history || [];
                    rating.history.push({ 
                        date: new Date().toISOString(), 
                        value: rating.value,
                        status: rating.status,
                        comment: rating.comment
                    });
                    rating.value = value;
                    rating.status = status;
                    rating.comment = comment;
                    rating.date = new Date().toISOString().split('T')[0];
                } else {
                    this.state.ratings.push({ 
                        userId, 
                        skillId, 
                        value, 
                        status, 
                        comment,
                        date: new Date().toISOString().split('T')[0],
                        history: []
                    });
                }
                this.save();
                this.emit('rating:updated', { userId, skillId, value });
            }
            
            approveRating(userId, skillId) {
                const rating = this.getRating(userId, skillId);
                if (rating) {
                    rating.status = 'approved';
                    this.save();
                    
                    // Create notification
                    this.addNotification(
                        userId,
                        'ÐžÑ†ÐµÐ½ÐºÐ° Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð°',
                        `Ð’Ð°Ñˆ Ð½Ð°Ð²Ñ‹Ðº "${this.getSkillById(skillId).name}" Ð±Ñ‹Ð» Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð¼`,
                        'success'
                    );
                    
                    return true;
                }
                return false;
            }
            
            rejectRating(userId, skillId, reason = '') {
                const rating = this.getRating(userId, skillId);
                if (rating) {
                    rating.status = 'rejected';
                    rating.rejectReason = reason;
                    this.save();
                    
                    this.addNotification(
                        userId,
                        'ÐžÑ†ÐµÐ½ÐºÐ° Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð°',
                        `Ð’Ð°Ñˆ Ð½Ð°Ð²Ñ‹Ðº "${this.getSkillById(skillId).name}" Ð±Ñ‹Ð» Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½. ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°: ${reason}`,
                        'error'
                    );
                    
                    return true;
                }
                return false;
            }
            
            // Goal Methods
            getUserGoals(userId) {
                return this.state.goals.filter(g => g.userId === userId);
            }
            
            addGoal(userId, goal) {
                goal.id = 'g' + Date.now();
                goal.userId = userId;
                goal.createdAt = new Date().toISOString();
                goal.status = goal.status || 'not_started';
                goal.progress = goal.progress || 0;
                this.state.goals.push(goal);
                this.save();
                
                this.addNotification(
                    userId,
                    'ÐÐ¾Ð²Ð°Ñ Ñ†ÐµÐ»ÑŒ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð°',
                    `Ð’Ð°Ð¼ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð° Ð½Ð¾Ð²Ð°Ñ Ñ†ÐµÐ»ÑŒ: "${goal.title}"`,
                    'info'
                );
                
                return goal;
            }
            
            updateGoal(goalId, updates) {
                const goal = this.state.goals.find(g => g.id === goalId);
                if (goal) {
                    Object.assign(goal, updates);
                    this.save();
                    
                    if (updates.progress === 100 && goal.status !== 'completed') {
                        goal.status = 'completed';
                        this.addNotification(
                            goal.userId,
                            'Ð¦ÐµÐ»ÑŒ Ð´Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚Ð°!',
                            `ÐŸÐ¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÐµÐ¼! Ð’Ñ‹ Ð´Ð¾ÑÑ‚Ð¸Ð³Ð»Ð¸ Ñ†ÐµÐ»Ð¸: "${goal.title}"`,
                            'success'
                        );
                    }
                    
                    return true;
                }
                return false;
            }
            
            deleteGoal(goalId) {
                this.state.goals = this.state.goals.filter(g => g.id !== goalId);
                this.save();
                return true;
            }
            
            // Notification Methods
            getUserNotifications(userId) {
                return this.state.notifications
                    .filter(n => n.userId === userId)
                    .sort((a, b) => new Date(b.date) - new Date(a.date));
            }
            
            addNotification(userId, title, message, type = 'info') {
                const notification = {
                    id: 'n' + Date.now(),
                    userId,
                    title,
                    message,
                    type,
                    read: false,
                    date: new Date().toISOString()
                };
                this.state.notifications.push(notification);
                this.save();
                this.emit('notification:new', notification);
                return notification;
            }
            
            markNotificationAsRead(notificationId) {
                const notification = this.state.notifications.find(n => n.id === notificationId);
                if (notification && !notification.read) {
                    notification.read = true;
                    this.save();
                    return true;
                }
                return false;
            }
            
            markAllNotificationsAsRead(userId) {
                this.state.notifications
                    .filter(n => n.userId === userId && !n.read)
                    .forEach(n => n.read = true);
                this.save();
                return true;
            }
            
            deleteNotification(notificationId) {
                this.state.notifications = this.state.notifications.filter(n => n.id !== notificationId);
                this.save();
                return true;
            }
            
            getUnreadNotificationCount(userId) {
                return this.state.notifications.filter(n => n.userId === userId && !n.read).length;
            }
            
            // Event Methods
            getUserEvents(userId) {
                return this.state.events.filter(e => e.participants.includes(userId));
            }
            
            addEvent(event) {
                event.id = 'e' + Date.now();
                this.state.events.push(event);
                this.save();
                
                // Add notifications for participants
                event.participants.forEach(userId => {
                    this.addNotification(
                        userId,
                        'ÐÐ¾Ð²Ð¾Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ',
                        `Ð’Ð°Ð¼ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾ Ð½Ð¾Ð²Ð¾Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ: "${event.title}"`,
                        'info'
                    );
                });
                
                return event;
            }
            
            updateEvent(eventId, updates) {
                const event = this.state.events.find(e => e.id === eventId);
                if (event) {
                    Object.assign(event, updates);
                    this.save();
                    return true;
                }
                return false;
            }
            
            deleteEvent(eventId) {
                this.state.events = this.state.events.filter(e => e.id !== eventId);
                this.save();
                return true;
            }
            
            // Feedback Methods
            getFeedbackForUser(userId) {
                return this.state.feedback.filter(f => f.toUserId === userId);
            }
            
            addFeedback(feedback) {
                feedback.id = 'f' + Date.now();
                feedback.date = new Date().toISOString().split('T')[0];
                feedback.status = 'pending';
                this.state.feedback.push(feedback);
                this.save();
                
                this.addNotification(
                    feedback.toUserId,
                    'ÐÐ¾Ð²Ñ‹Ð¹ Ð¾Ñ‚Ð·Ñ‹Ð²',
                    `Ð’Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð»Ð¸ Ð½Ð¾Ð²Ñ‹Ð¹ Ð¾Ñ‚Ð·Ñ‹Ð² Ð¾Ñ‚ ÐºÐ¾Ð»Ð»ÐµÐ³Ð¸`,
                    'info'
                );
                
                return feedback;
            }
            
            // Admin Methods
            addCategory(name, icon, color, description) {
                const category = { 
                    id: 'c' + Date.now(), 
                    name, 
                    icon, 
                    color: color || this.getRandomColor(),
                    description: description || ''
                };
                this.state.categories.push(category);
                this.save();
                return category;
            }
            
            updateCategory(id, updates) {
                const category = this.getCategoryById(id);
                if (category) {
                    Object.assign(category, updates);
                    this.save();
                    return true;
                }
                return false;
            }
            
            deleteCategory(id) {
                // Don't delete category if it has skills
                const skillsInCategory = this.state.skills.filter(s => s.catId === id);
                if (skillsInCategory.length > 0) {
                    throw new Error('ÐÐµÐ»ÑŒÐ·Ñ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð½Ð°Ð²Ñ‹ÐºÐ¸');
                }
                this.state.categories = this.state.categories.filter(c => c.id !== id);
                this.save();
                return true;
            }
            
            addSkill(name, catId, description, requiredFor, level) {
                const skill = { 
                    id: 's' + Date.now(), 
                    catId, 
                    name, 
                    description: description || '',
                    requiredFor: requiredFor || [],
                    level: level || 3
                };
                this.state.skills.push(skill);
                this.save();
                return skill;
            }
            
            updateSkill(id, updates) {
                const skill = this.getSkillById(id);
                if (skill) {
                    Object.assign(skill, updates);
                    this.save();
                    return true;
                }
                return false;
            }
            
            deleteSkill(id) {
                // Also delete ratings for this skill
                this.state.ratings = this.state.ratings.filter(r => r.skillId !== id);
                this.state.skills = this.state.skills.filter(s => s.id !== id);
                this.save();
                return true;
            }
            
            createUser(userData) {
                const user = {
                    id: Date.now(),
                    login: userData.login,
                    password: userData.password || '123',
                    name: userData.name,
                    role: userData.role || 'employee',
                    dept: userData.dept,
                    position: userData.position || 'Employee',
                    avatar: userData.name.substring(0,2).toUpperCase(),
                    skillsRequiredRated: false,
                    email: userData.email || `${userData.login}@company.com`,
                    phone: userData.phone || '',
                    hireDate: userData.hireDate || new Date().toISOString().split('T')[0],
                    salary: userData.salary || 0,
                    performance: 0,
                    status: 'active',
                    bio: userData.bio || ''
                };
                this.state.users.push(user);
                this.save();
                
                this.addNotification(
                    user.id,
                    'Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ!',
                    'Ð’Ð°Ñˆ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚ Ð±Ñ‹Ð» ÑÐ¾Ð·Ð´Ð°Ð½. Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² SkillMatrix PRO!',
                    'success'
                );
                
                return user;
            }
            
            updateUser(id, updates) {
                const user = this.getUserById(id);
                if (user) {
                    // If name changed, update avatar
                    if (updates.name && updates.name !== user.name) {
                        updates.avatar = updates.name.substring(0,2).toUpperCase();
                    }
                    
                    Object.assign(user, updates);
                    this.save();
                    
                    this.addNotification(
                        id,
                        'Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹',
                        'Ð’Ð°ÑˆÐ¸ Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð±Ñ‹Ð»Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹',
                        'info'
                    );
                    
                    return true;
                }
                return false;
            }
            
            deleteUser(id) {
                if (id === Session.user?.id) {
                    throw new Error('ÐÐµÐ»ÑŒÐ·Ñ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÐ²Ð¾Ð¹ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚');
                }
                
                // Delete user data
                this.state.users = this.state.users.filter(u => u.id !== id);
                this.state.ratings = this.state.ratings.filter(r => r.userId !== id);
                this.state.goals = this.state.goals.filter(g => g.userId !== id);
                this.state.feedback = this.state.feedback.filter(f => f.fromUserId !== id && f.toUserId !== id);
                
                // Update events to remove user from participants
                this.state.events = this.state.events.map(event => ({
                    ...event,
                    participants: event.participants.filter(pId => pId !== id)
                })).filter(event => event.participants.length > 0);
                
                this.save();
                return true;
            }
            
            // Statistics Methods
            getDepartmentStats(dept) {
                const deptUsers = this.state.users.filter(u => u.dept === dept && u.role === 'employee');
                const ratings = this.state.ratings.filter(r => 
                    deptUsers.some(u => u.id === r.userId) && r.status === 'approved'
                );
                
                const avgRating = ratings.length > 0 
                    ? ratings.reduce((sum, r) => sum + r.value, 0) / ratings.length 
                    : 0;
                
                const skillsCoverage = this.state.skills.filter(s => 
                    s.requiredFor.includes(dept)
                ).map(skill => {
                    const skillRatings = ratings.filter(r => r.skillId === skill.id);
                    const avgSkillRating = skillRatings.length > 0
                        ? skillRatings.reduce((sum, r) => sum + r.value, 0) / skillRatings.length
                        : 0;
                    return {
                        skill: skill.name,
                        average: avgSkillRating,
                        ratedCount: skillRatings.length,
                        totalUsers: deptUsers.length
                    };
                });
                
                return {
                    totalUsers: deptUsers.length,
                    totalRatings: ratings.length,
                    averageRating: avgRating,
                    skillsCoverage,
                    topPerformers: deptUsers
                        .map(u => ({
                            user: u,
                            avgRating: this.getUserRatings(u.id)
                                .filter(r => r.status === 'approved')
                                .reduce((sum, r, _, arr) => sum + r.value / arr.length, 0)
                        }))
                        .sort((a, b) => b.avgRating - a.avgRating)
                        .slice(0, 5)
                };
            }
            
            getCompanyStats() {
                const totalUsers = this.state.users.length;
                const totalRatings = this.state.ratings.length;
                const approvedRatings = this.state.ratings.filter(r => r.status === 'approved').length;
                const pendingRatings = this.state.ratings.filter(r => r.status === 'pending').length;
                
                const avgRating = approvedRatings > 0
                    ? this.state.ratings
                        .filter(r => r.status === 'approved')
                        .reduce((sum, r) => sum + r.value, 0) / approvedRatings
                    : 0;
                
                const deptStats = {};
                CONFIG.depts.forEach(dept => {
                    deptStats[dept] = this.getDepartmentStats(dept);
                });
                
                return {
                    totalUsers,
                    totalRatings,
                    approvedRatings,
                    pendingRatings,
                    averageRating: avgRating,
                    departmentStats: deptStats
                };
            }
            
            // Utility Methods
            getRandomColor() {
                const colors = ['#6366f1', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#06b6d4', '#ec4899'];
                return colors[Math.floor(Math.random() * colors.length)];
            }
            
            resetDatabase() {
                if (confirm('Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹? Ð’ÑÐµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð±ÑƒÐ´ÑƒÑ‚ ÑÐ±Ñ€Ð¾ÑˆÐµÐ½Ñ‹ Ðº Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ñ‹Ð¼ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÑÐ¼.')) {
                    localStorage.removeItem('skill_matrix_db_pro');
                    this.state = JSON.parse(JSON.stringify(SEED_DB));
                    this.save();
                    location.reload();
                }
            }
            
            exportData() {
                const data = {
                    exportDate: new Date().toISOString(),
                    version: '3.0',
                    data: this.state
                };
                return JSON.stringify(data, null, 2);
            }
            
            importData(jsonString) {
                try {
                    const data = JSON.parse(jsonString);
                    if (data.version && data.data) {
                        this.state = data.data;
                        this.save();
                        return true;
                    }
                } catch (e) {
                    console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…:', e);
                }
                return false;
            }
        }

        // Create global store instance
        const DB = new Store();

        // --- Enhanced Session Manager ---
        const Session = {
            user: JSON.parse(sessionStorage.getItem('currentUser')) || null,
            token: sessionStorage.getItem('token'),
            preferences: JSON.parse(localStorage.getItem('user_preferences')) || {
                theme: 'light',
                notifications: true,
                sidebarCollapsed: false
            },
            
            login(user) {
                this.user = user;
                this.token = 'token_' + Date.now() + '_' + Math.random().toString(36).substr(2);
                
                sessionStorage.setItem('currentUser', JSON.stringify(user));
                sessionStorage.setItem('token', this.token);
                
                // Add login notification
                DB.addNotification(
                    user.id,
                    'Ð’Ñ…Ð¾Ð´ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ',
                    'Ð’Ñ‹ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð²Ð¾ÑˆÐ»Ð¸ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ SkillMatrix PRO',
                    'success'
                );
                
                window.location.hash = '#dashboard';
                setTimeout(() => location.reload(), 100);
            },
            
            logout() {
                // Add logout notification
                if (this.user) {
                    DB.addNotification(
                        this.user.id,
                        'Ð’Ñ‹Ñ…Ð¾Ð´ Ð¸Ð· ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹',
                        'Ð’Ñ‹ Ð²Ñ‹ÑˆÐ»Ð¸ Ð¸Ð· ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ SkillMatrix PRO',
                        'info'
                    );
                }
                
                this.user = null;
                this.token = null;
                
                sessionStorage.removeItem('currentUser');
                sessionStorage.removeItem('token');
                
                window.location.hash = '#login';
                setTimeout(() => location.reload(), 100);
            },
            
            updatePreferences(newPrefs) {
                this.preferences = { ...this.preferences, ...newPrefs };
                localStorage.setItem('user_preferences', JSON.stringify(this.preferences));
                
                // Update theme
                if (newPrefs.theme) {
                    document.body.classList.toggle('dark-mode', newPrefs.theme === 'dark');
                }
                
                return this.preferences;
            },
            
            toggleTheme() {
                const newTheme = this.preferences.theme === 'light' ? 'dark' : 'light';
                this.updatePreferences({ theme: newTheme });
                return newTheme;
            },
            
            toggleSidebar() {
                const newState = !this.preferences.sidebarCollapsed;
                this.updatePreferences({ sidebarCollapsed: newState });
                return newState;
            },
            
            isAuthorized(requiredRole) {
                if (!this.user) return false;
                
                const roleHierarchy = {
                    'employee': 1,
                    'hr': 2,
                    'manager': 3,
                    'admin': 4,
                    'director': 5
                };
                
                const userLevel = roleHierarchy[this.user.role] || 0;
                const requiredLevel = roleHierarchy[requiredRole] || 0;
                
                return userLevel >= requiredLevel;
            }
        };

        // --- Router & Application Core ---
        const App = {
            routes: {},
            currentComponent: null,
            
            init() {
                window.addEventListener('hashchange', () => this.render());
                this.setupGlobalEventListeners();
                this.render();
                
                // Apply user preferences
                if (Session.preferences.theme === 'dark') {
                    document.body.classList.add('dark-mode');
                }
                
                // Show welcome message
                setTimeout(() => {
                    if (Session.user) {
                        UI.toast(`Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ, ${Session.user.name}!`, 'success');
                    }
                }, 1000);
            },
            
            setupGlobalEventListeners() {
                // Listen for state changes
                DB.on('statechange', () => {
                    if (this.currentComponent && this.currentComponent.onStateChange) {
                        this.currentComponent.onStateChange(DB.state);
                    }
                });
                
                // Listen for notifications
                DB.on('notification:new', (event) => {
                    const notification = event.detail;
                    if (notification.userId === Session.user?.id) {
                        UI.showNotificationToast(notification);
                    }
                });
            },
            
            addRoute(path, component) { 
                this.routes[path] = component; 
            },
            
            render() {
                const hash = window.location.hash.slice(1) || 'login';
                const root = document.getElementById('root');
                
                // Auth Guard
                if (hash !== 'login' && !Session.user) {
                    window.location.hash = '#login';
                    return;
                }
                
                // Check role-based access
                const route = this.routes[hash];
                if (route && route.requiredRole && !Session.isAuthorized(route.requiredRole)) {
                    UI.toast('Ð£ Ð²Ð°Ñ Ð½ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÑÑ‚Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ', 'error');
                    window.location.hash = '#dashboard';
                    return;
                }
                
                // Render Route
                const Comp = route || this.routes['dashboard'];
                if (Comp) {
                    root.innerHTML = '';
                    
                    try {
                        const instance = new Comp();
                        this.currentComponent = instance;
                        
                        const element = instance.render();
                        if (element) {
                            root.appendChild(element);
                            
                            // Apply animations
                            element.classList.add('animate__animated', 'animate__fadeIn');
                            
                            if (instance.postRender) {
                                setTimeout(() => instance.postRender(), 100);
                            }
                        }
                    } catch (error) {
                        console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ñ€ÐµÐ½Ð´ÐµÑ€Ð¸Ð½Ð³Ð° ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð°:', error);
                        root.innerHTML = `
                            <div class="login-container">
                                <div class="login-card">
                                    <h2 style="color: var(--danger);">ÐžÑˆÐ¸Ð±ÐºÐ°</h2>
                                    <p>ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹.</p>
                                    <button class="btn btn-primary" onclick="location.reload()">ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ</button>
                                </div>
                            </div>
                        `;
                    }
                }
            },
            
            navigateTo(path) {
                window.location.hash = '#' + path;
            }
        };

        // --- Enhanced UI Utilities ---
        const UI = {
            // Toast notifications
            toast(message, type = 'success', title = '', duration = 5000) {
                const container = document.querySelector('.toast-container') || (() => {
                    const d = document.createElement('div');
                    d.className = 'toast-container';
                    document.body.appendChild(d);
                    return d;
                })();
                
                const id = 'toast_' + Date.now();
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.id = id;
                
                const icon = type === 'success' ? 'fa-check-circle' :
                            type === 'error' ? 'fa-exclamation-circle' :
                            type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle';
                
                toast.innerHTML = `
                    <i class="fas ${icon} toast-icon"></i>
                    <div class="toast-content">
                        ${title ? `<div class="toast-title">${title}</div>` : ''}
                        <div class="toast-message">${message}</div>
                    </div>
                    <button class="toast-close" onclick="document.getElementById('${id}').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                container.appendChild(toast);
                
                // Auto-remove after duration
                setTimeout(() => {
                    if (document.getElementById(id)) {
                        toast.style.animation = 'slideInRight 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) reverse';
                        setTimeout(() => toast.remove(), 400);
                    }
                }, duration);
                
                return id;
            },
            
            // Modal dialogs
            modal(options) {
                const {
                    title,
                    content,
                    size = 'md', // sm, md, lg, xl
                    onConfirm,
                    onCancel,
                    confirmText = 'Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ',
                    cancelText = 'ÐžÑ‚Ð¼ÐµÐ½Ð°',
                    showConfirm = true,
                    showCancel = true,
                    closeOnOverlay = true
                } = options;
                
                const overlay = document.createElement('div');
                overlay.className = 'modal-overlay active';
                
                const modalSizeClass = `modal-${size}`;
                overlay.innerHTML = `
                    <div class="modal ${modalSizeClass}">
                        <div class="modal-header">
                            ${title}
                            <button class="modal-close">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">${content}</div>
                        <div class="modal-footer">
                            ${showCancel ? `<button class="btn btn-outline" id="modal-cancel">${cancelText}</button>` : ''}
                            ${showConfirm ? `<button class="btn btn-primary" id="modal-confirm">${confirmText}</button>` : ''}
                        </div>
                    </div>
                `;
                
                document.body.appendChild(overlay);
                
                const closeModal = (result) => {
                    overlay.classList.remove('active');
                    setTimeout(() => overlay.remove(), 300);
                    return result;
                };
                
                // Event listeners
                overlay.querySelector('.modal-close').onclick = () => closeModal(onCancel?.());
                overlay.querySelector('#modal-cancel')?.addEventListener('click', () => closeModal(onCancel?.()));
                overlay.querySelector('#modal-confirm')?.addEventListener('click', () => {
                    if (onConfirm?.()) {
                        closeModal(true);
                    }
                });
                
                if (closeOnOverlay) {
                    overlay.addEventListener('click', (e) => {
                        if (e.target === overlay) {
                            closeModal(onCancel?.());
                        }
                    });
                }
                
                // Escape key to close
                const escapeHandler = (e) => {
                    if (e.key === 'Escape') {
                        closeModal(onCancel?.());
                        document.removeEventListener('keydown', escapeHandler);
                    }
                };
                document.addEventListener('keydown', escapeHandler);
                
                return {
                    close: () => closeModal(),
                    updateContent: (newContent) => {
                        overlay.querySelector('.modal-body').innerHTML = newContent;
                    }
                };
            },
            
            // Confirmation dialog
            confirm(options) {
                const {
                    title = 'ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ',
                    message,
                    confirmText = 'Ð”Ð°',
                    cancelText = 'ÐÐµÑ‚',
                    type = 'warning'
                } = options;
                
                return new Promise((resolve) => {
                    const modal = this.modal({
                        title,
                        content: `
                            <div style="text-align: center; padding: 20px;">
                                <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: var(--${type}); margin-bottom: 20px;"></i>
                                <h3 style="margin-bottom: 16px;">${title}</h3>
                                <p>${message}</p>
                            </div>
                        `,
                        confirmText,
                        cancelText,
                        onConfirm: () => resolve(true),
                        onCancel: () => resolve(false)
                    });
                });
            },
            
            // Loading overlay
            showLoading(message = 'Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...') {
                const overlay = document.createElement('div');
                overlay.className = 'modal-overlay active';
                overlay.style.background = 'rgba(0,0,0,0.8)';
                overlay.innerHTML = `
                    <div style="text-align: center; color: white;">
                        <div class="spinner spinner-lg" style="margin: 0 auto 20px;"></div>
                        <div style="font-size: 1.1rem;">${message}</div>
                    </div>
                `;
                document.body.appendChild(overlay);
                return () => overlay.remove();
            },
            
            // Notification toast from DB notification
            showNotificationToast(notification) {
                const toastId = this.toast(
                    notification.message,
                    notification.type,
                    notification.title
                );
                
                // Add click handler to mark as read
                const toast = document.getElementById(toastId);
                if (toast) {
                    toast.style.cursor = 'pointer';
                    toast.onclick = () => {
                        DB.markNotificationAsRead(notification.id);
                        toast.remove();
                    };
                }
            },
            
            // Format date
            formatDate(dateString, format = 'short') {
                const date = new Date(dateString);
                if (format === 'short') {
                    return date.toLocaleDateString('ru-RU');
                } else if (format === 'long') {
                    return date.toLocaleDateString('ru-RU', {
                        day: 'numeric',
                        month: 'long',
                        year: 'numeric'
                    });
                } else if (format === 'datetime') {
                    return date.toLocaleString('ru-RU');
                }
                return dateString;
            },
            
            // Generate random color
            getRandomColor() {
                return '#' + Math.floor(Math.random()*16777215).toString(16);
            },
            
            // Debounce function
            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            },
            
            // Throttle function
            throttle(func, limit) {
                let inThrottle;
                return function(...args) {
                    if (!inThrottle) {
                        func.apply(this, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                };
            }
        };

        // --- Enhanced Dashboard Layout ---
        class DashboardLayout {
            constructor() {
                this.user = Session.user;
                this.state = DB.state;
                this.unsubscribe = null;
            }
            
            getNavItems() {
                const role = this.user.role;
                const unreadCount = DB.getUnreadNotificationCount(this.user.id);
                
                let items = [
                    { label: 'Ð“Ð»Ð°Ð²Ð½Ð°Ñ', icon: 'fa-home', hash: '#dashboard', badge: null }
                ];
                
                if (role === CONFIG.roles.EMPLOYEE || role === CONFIG.roles.HR) {
                    items.push(
                        { label: 'ÐœÐ¾Ð¸ Ð½Ð°Ð²Ñ‹ÐºÐ¸', icon: 'fa-layer-group', hash: '#my-skills', badge: null },
                        { label: 'ÐœÐ¾Ð¸ Ñ†ÐµÐ»Ð¸', icon: 'fa-bullseye', hash: '#goals', badge: null },
                        { label: 'ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ', icon: 'fa-user-circle', hash: '#profile', badge: null }
                    );
                }
                
                if (role === CONFIG.roles.MANAGER || role === CONFIG.roles.HR) {
                    items.push(
                        { label: 'ÐœÐ¾Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°', icon: 'fa-users', hash: '#team', badge: null },
                        { label: 'Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ', icon: 'fa-chart-bar', hash: '#compare', badge: null },
                        { label: 'ÐŸÐ¾Ð¸ÑÐº', icon: 'fa-search', hash: '#search', badge: null },
                        { label: 'ÐšÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ', icon: 'fa-calendar-alt', hash: '#calendar', badge: null }
                    );
                }
                
                if (role === CONFIG.roles.ADMIN || role === CONFIG.roles.HR) {
                    items.push(
                        { label: 'Ð¡Ð¿Ñ€Ð°Ð²Ð¾Ñ‡Ð½Ð¸Ðº', icon: 'fa-book', hash: '#admin-skills', badge: null },
                        { label: 'Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¸', icon: 'fa-id-card', hash: '#admin-users', badge: null },
                        { label: 'ÐžÑ‚Ñ‡ÐµÑ‚Ñ‹', icon: 'fa-file-csv', hash: '#reports', badge: null }
                    );
                }
                
                // Add notifications item for all roles
                items.push({ 
                    label: 'Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ', 
                    icon: 'fa-bell', 
                    hash: '#notifications', 
                    badge: unreadCount > 0 ? unreadCount : null 
                });
                
                // Add settings for all roles
                items.push({ label: 'ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸', icon: 'fa-cog', hash: '#settings', badge: null });
                
                return items;
            }
            
            renderSidebar() {
                const navItems = this.getNavItems();
                const isCollapsed = Session.preferences.sidebarCollapsed;
                
                const navs = navItems.map(item => `
                    <li class="nav-item">
                        <a href="${item.hash}" class="nav-link ${window.location.hash.slice(1) === item.hash.replace('#', '') ? 'active' : ''}"
                           data-tooltip="${isCollapsed ? item.label : ''}">
                            <i class="fas ${item.icon}"></i>
                            <span class="nav-text">${item.label}</span>
                            ${item.badge ? `<span class="nav-badge">${item.badge}</span>` : ''}
                        </a>
                    </li>
                `).join('');
                
                return `
                    <aside class="sidebar ${isCollapsed ? 'collapsed' : ''}">
                        <div class="sidebar-header">
                            <i class="fas fa-cubes"></i>
                            <span>SkillMatrix PRO</span>
                            <button class="sidebar-toggle" onclick="Session.toggleSidebar(); App.render();">
                                <i class="fas fa-chevron-${isCollapsed ? 'right' : 'left'}"></i>
                            </button>
                        </div>
                        <ul class="nav-list">${navs}</ul>
                        <div class="user-mini-profile">
                            <div class="avatar online">${this.user.avatar}</div>
                            <div class="user-info">
                                <div>${this.user.name}</div>
                                <div>${this.user.position}</div>
                            </div>
                            <button class="logout-btn" onclick="Session.logout()" data-tooltip="Ð’Ñ‹Ð¹Ñ‚Ð¸">
                                <i class="fas fa-sign-out-alt"></i>
                            </button>
                        </div>
                    </aside>
                `;
            }
            
            renderHeader(title) {
                const unreadCount = DB.getUnreadNotificationCount(this.user.id);
                
                return `
                    <header class="top-header">
                        <div class="d-flex align-items-center gap-3">
                            <button class="mobile-menu-toggle" onclick="document.querySelector('.sidebar').classList.toggle('active')">
                                <i class="fas fa-bars"></i>
                            </button>
                            <div class="page-title">
                                <i class="fas fa-${this.getPageIcon()}"></i>
                                ${title}
                            </div>
                        </div>
                        <div class="header-actions">
                            <div class="theme-toggle" onclick="Session.toggleTheme(); App.render();">
                                <i class="fas fa-sun"></i>
                                <i class="fas fa-moon"></i>
                            </div>
                            <button class="btn btn-ghost btn-icon" onclick="App.navigateTo('notifications')" data-tooltip="Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ">
                                <i class="fas fa-bell"></i>
                                ${unreadCount > 0 ? `<span class="nav-badge" style="position: absolute; top: 4px; right: 4px;">${unreadCount}</span>` : ''}
                            </button>
                            <button class="btn btn-ghost btn-icon" onclick="App.navigateTo('profile')" data-tooltip="ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ">
                                <i class="fas fa-user"></i>
                            </button>
                        </div>
                    </header>
                `;
            }
            
            getPageIcon() {
                const hash = window.location.hash.slice(1);
                const icons = {
                    'dashboard': 'home',
                    'my-skills': 'layer-group',
                    'goals': 'bullseye',
                    'profile': 'user-circle',
                    'team': 'users',
                    'compare': 'chart-bar',
                    'search': 'search',
                    'calendar': 'calendar-alt',
                    'admin-skills': 'book',
                    'admin-users': 'id-card',
                    'reports': 'file-csv',
                    'notifications': 'bell',
                    'settings': 'cog'
                };
                return icons[hash] || 'home';
            }
            
            wrapper(contentHtml, title) {
                const div = document.createElement('div');
                div.id = 'app';
                div.className = 'loaded';
                div.innerHTML = `
                    ${this.renderSidebar()}
                    <div class="main-wrapper">
                        ${this.renderHeader(title)}
                        <div class="page-content">
                            ${contentHtml}
                        </div>
                    </div>
                `;
                
                // Subscribe to store changes
                if (!this.unsubscribe) {
                    this.unsubscribe = DB.subscribe((state) => {
                        this.state = state;
                        if (this.onStateChange) {
                            this.onStateChange(state);
                        }
                    });
                }
                
                return div;
            }
            
            onStateChange(state) {
                // Can be overridden by child components
            }
            
            destroy() {
                if (this.unsubscribe) {
                    this.unsubscribe();
                }
            }
        }

        /**
         * ==================================================================================
         * PART 3: EXTENDED VIEWS & COMPONENTS
         * ==================================================================================
         */

        // 3.1 ENHANCED LOGIN VIEW
        class LoginView {
            render() {
                const div = document.createElement('div');
                div.className = 'login-container';
                div.innerHTML = `
                    <div class="login-card">
                        <div class="login-logo"><i class="fas fa-cubes"></i></div>
                        <h1 class="login-title">SkillMatrix PRO</h1>
                        <p class="login-subtitle">Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð¾Ñ†ÐµÐ½ÐºÐ¸ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾ÐºÐ¾Ð»ÐµÐ½Ð¸Ñ</p>
                        
                        <form id="loginForm" class="login-form">
                            <div class="form-group">
                                <label class="form-label">Ð›Ð¾Ð³Ð¸Ð½</label>
                                <input class="form-control" name="login" placeholder="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ð°Ñˆ Ð»Ð¾Ð³Ð¸Ð½" required autofocus>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÐŸÐ°Ñ€Ð¾Ð»ÑŒ</label>
                                <input class="form-control" type="password" name="password" placeholder="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ" required>
                            </div>
                            <div class="form-group">
                                <label class="form-check">
                                    <input type="checkbox" class="form-check-input" name="remember">
                                    <span class="form-check-label">Ð—Ð°Ð¿Ð¾Ð¼Ð½Ð¸Ñ‚ÑŒ Ð¼ÐµÐ½Ñ</span>
                                </label>
                            </div>
                            <button type="submit" class="btn btn-primary btn-lg" style="width:100%">
                                <i class="fas fa-sign-in-alt"></i> Ð’Ð¾Ð¹Ñ‚Ð¸ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ
                            </button>
                        </form>
                        
                        <div class="login-footer">
                            <p><strong>Ð”ÐµÐ¼Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ñ‹:</strong></p>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px;">
                                <div style="text-align: left;">
                                    <div><strong>user / 123</strong></div>
                                    <small>Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº (Frontend)</small>
                                </div>
                                <div style="text-align: left;">
                                    <div><strong>manager / 123</strong></div>
                                    <small>Ð ÑƒÐºÐ¾Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒ (manager)</small>
                                </div>
                                <div style="text-align: left;">
                                    <div><strong>admin / 123</strong></div>
                                    <small>ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ (HR)</small>
                                </div>
                                <div style="text-align: left;">
                                    <div><strong>dev2 / 123</strong></div>
                                    <small>Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº (Backend)</small>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                div.querySelector('form').onsubmit = (e) => {
                    e.preventDefault();
                    const fd = new FormData(e.target);
                    const login = fd.get('login');
                    const password = fd.get('password');
                    
                    // Show loading
                    const loading = UI.showLoading('ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…...');
                    
                    setTimeout(() => {
                        const user = DB.getUser(login, password);
                        loading();
                        
                        if (user) {
                            Session.login(user);
                        } else {
                            UI.toast('ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ð»Ð¾Ð³Ð¸Ð½ Ð¸Ð»Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ', 'error', 'ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ñ…Ð¾Ð´Ð°');
                            // Shake animation
                            const form = div.querySelector('#loginForm');
                            form.classList.add('animate__animated', 'animate__headShake');
                            setTimeout(() => form.classList.remove('animate__animated', 'animate__headShake'), 1000);
                        }
                    }, 800);
                };
                
                return div;
            }
        }

        // 3.2 ENHANCED EMPLOYEE SKILLS VIEW
        class EmployeeSkills extends DashboardLayout {
            render() {
                const categories = DB.getCategories();
                const skills = DB.getSkills();
                const userRatings = DB.getUserRatings(this.user.id);
                
                // Calculate statistics
                const totalSkills = skills.filter(s => s.requiredFor.includes(this.user.dept)).length;
                const ratedSkills = userRatings.filter(r => r.status === 'approved').length;
                const pendingSkills = userRatings.filter(r => r.status === 'pending').length;
                const avgRating = userRatings.length > 0 
                    ? userRatings.reduce((sum, r) => sum + r.value, 0) / userRatings.length 
                    : 0;
                
                let html = `
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon primary">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${avgRating.toFixed(1)}</div>
                                <div class="stat-label">Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon success">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${ratedSkills}</div>
                                <div class="stat-label">ÐžÑ†ÐµÐ½ÐµÐ½Ð¾ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</div>
                                <div class="stat-change positive">+${ratedSkills} Ð·Ð° Ð¼ÐµÑÑÑ†</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon warning">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${pendingSkills}</div>
                                <div class="stat-label">ÐÐ° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon info">
                                <i class="fas fa-bullseye"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${Math.round((ratedSkills / totalSkills) * 100)}%</div>
                                <div class="stat-label">ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ Ð¾Ñ†ÐµÐ½ÐºÐ¸</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(ratedSkills / totalSkills) * 100}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Required skills onboarding
                if (!this.user.skillsRequiredRated) {
                    const requiredSkills = skills.filter(s => s.requiredFor.includes(this.user.dept));
                    const ratedRequired = requiredSkills.filter(s => 
                        userRatings.some(r => r.skillId === s.id && r.status === 'approved')
                    ).length;
                    
                    html += `
                        <div class="card animate__animated animate__pulse">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-exclamation-circle text-warning"></i>
                                    ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¸ Ð´Ð»Ñ Ð¾Ñ‚Ð´ÐµÐ»Ð° ${this.user.dept}
                                </div>
                                <span class="badge badge-warning">${ratedRequired}/${requiredSkills.length}</span>
                            </div>
                            <div class="card-body">
                                <p>ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¾Ñ†ÐµÐ½Ð¸Ñ‚Ðµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¸ Ð´Ð»Ñ Ð²Ð°ÑˆÐµÐ¹ Ð´Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚Ð¸. Ð­Ñ‚Ð¾ Ð¿Ð¾Ð¼Ð¾Ð¶ÐµÑ‚ Ð½Ð°Ð¼ Ð»ÑƒÑ‡ÑˆÐµ Ð¿Ð¾Ð½ÑÑ‚ÑŒ Ð²Ð°Ñˆ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð¸ Ð·Ð¾Ð½Ñ‹ Ñ€Ð¾ÑÑ‚Ð°.</p>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(ratedRequired / requiredSkills.length) * 100}%"></div>
                                </div>
                                <div class="progress-text">
                                    <span>ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ</span>
                                    <span>${ratedRequired} Ð¸Ð· ${requiredSkills.length}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                // Skills by category
                html += `<div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-layer-group"></i>
                            ÐœÐ°Ñ‚Ñ€Ð¸Ñ†Ð° ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹
                        </div>
                        <button class="btn btn-primary btn-sm" onclick="exportMySkills()">
                            <i class="fas fa-download"></i> Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚
                        </button>
                    </div>
                `;
                
                categories.forEach(category => {
                    const categorySkills = skills.filter(s => s.catId === category.id);
                    if (categorySkills.length === 0) return;
                    
                    const categoryRatings = categorySkills.map(skill => {
                        const rating = userRatings.find(r => r.skillId === skill.id);
                        return {
                            skill,
                            rating,
                            isRequired: skill.requiredFor.includes(this.user.dept)
                        };
                    });
                    
                    const avgCategoryRating = categoryRatings
                        .filter(cr => cr.rating?.status === 'approved')
                        .reduce((sum, cr) => sum + (cr.rating?.value || 0), 0) / 
                        (categoryRatings.filter(cr => cr.rating?.status === 'approved').length || 1);
                    
                    html += `
                        <div class="category-block">
                            <div class="category-header" onclick="toggleCategory('${category.id}')">
                                <div class="d-flex align-items-center gap-3">
                                    <i class="fas ${category.icon}" style="color: ${category.color}"></i>
                                    <div>
                                        <div>${category.name}</div>
                                        <small style="color: var(--text-light);">${category.description}</small>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center gap-3">
                                    <div style="text-align: right;">
                                        <div style="font-size: 1.1rem; font-weight: 700;">${avgCategoryRating.toFixed(1)}</div>
                                        <small style="color: var(--text-light);">ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</small>
                                    </div>
                                    <i class="fas fa-chevron-down"></i>
                                </div>
                            </div>
                            <div class="skill-list" id="category-${category.id}">
                    `;
                    
                    categoryRatings.forEach(({ skill, rating, isRequired }) => {
                        const value = rating?.value || 0;
                        const status = rating?.status;
                        const comment = rating?.comment || '';
                        
                        html += `
                            <div class="skill-row">
                                <div class="skill-info">
                                    <div class="d-flex align-items-center gap-2 mb-2">
                                        <div class="skill-name">${skill.name}</div>
                                        ${isRequired ? '<span class="badge badge-warning badge-sm">ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹</span>' : ''}
                                        ${skill.level ? `<span class="badge badge-info badge-sm">Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ: ${skill.level}</span>` : ''}
                                        ${status === 'pending' ? '<span class="badge badge-pending badge-sm"><i class="fas fa-clock"></i> ÐÐ° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ</span>' : ''}
                                        ${status === 'approved' ? '<span class="badge badge-success badge-sm"><i class="fas fa-check"></i> ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½</span>' : ''}
                                    </div>
                                    ${skill.description ? `<div class="skill-desc">${skill.description}</div>` : ''}
                                    ${comment ? `<div class="skill-desc"><strong>ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹:</strong> ${comment}</div>` : ''}
                                </div>
                                <div class="rating-input">
                                    ${[1,2,3,4,5].map(i => `
                                        <div class="star-btn ${i <= value ? 'active' : ''}" 
                                             onclick="rateSkill('${skill.id}', ${i})"
                                             data-tooltip="${CONFIG.skillLevels[i-1]}">
                                            ${i}
                                        </div>
                                    `).join('')}
                                    <div class="rating-label">${value > 0 ? CONFIG.skillLevels[value-1] : 'ÐÐµ Ð¾Ñ†ÐµÐ½ÐµÐ½Ð¾'}</div>
                                </div>
                            </div>
                        `;
                    });
                    
                    html += `</div></div>`;
                });
                
                html += `</div>`;
                
                // Add global functions
                window.toggleCategory = (catId) => {
                    const element = document.getElementById(`category-${catId}`);
                    const header = element.previousElementSibling;
                    element.classList.toggle('open');
                    header.classList.toggle('collapsed');
                };
                
                window.rateSkill = (skillId, value) => {
                    const skill = DB.getSkillById(skillId);
                    const currentRating = DB.getRating(this.user.id, skillId);
                    
                    if (currentRating?.status === 'approved' && !confirm('Ð£ Ð²Ð°Ñ ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð½Ð°Ñ Ð¾Ñ†ÐµÐ½ÐºÐ°. Ð¥Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ ÐµÐµ?')) {
                        return;
                    }
                    
                    const modal = UI.modal({
                        title: 'ÐžÑ†ÐµÐ½ÐºÐ° Ð½Ð°Ð²Ñ‹ÐºÐ°',
                        content: `
                            <div class="form-group">
                                <label class="form-label">ÐÐ°Ð²Ñ‹Ðº: <strong>${skill.name}</strong></label>
                                <div class="rating-input" style="justify-content: center; margin: 20px 0;">
                                    ${[1,2,3,4,5].map(i => `
                                        <div class="star-btn ${i <= value ? 'active' : ''}" 
                                             onclick="document.querySelectorAll('.star-btn').forEach(btn => btn.classList.remove('active')); 
                                                      for(let j=1; j<=${i}; j++) document.querySelectorAll('.star-btn')[j-1].classList.add('active');
                                                      document.getElementById('ratingValue').value = ${i};"
                                             style="width: 50px; height: 50px; font-size: 1.2rem;">
                                            ${i}
                                        </div>
                                    `).join('')}
                                </div>
                                <input type="hidden" id="ratingValue" value="${value}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)</label>
                                <textarea class="form-control" id="ratingComment" rows="3" placeholder="Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ Ðº Ð²Ð°ÑˆÐµÐ¹ Ð¾Ñ†ÐµÐ½ÐºÐµ...">${currentRating?.comment || ''}</textarea>
                            </div>
                        `,
                        onConfirm: () => {
                            const newValue = parseInt(document.getElementById('ratingValue').value);
                            const comment = document.getElementById('ratingComment').value;
                            
                            DB.setRating(this.user.id, skillId, newValue, 'pending', comment);
                            
                            // Check if all required skills are rated
                            if (!this.user.skillsRequiredRated) {
                                const requiredSkills = DB.getSkills().filter(s => s.requiredFor.includes(this.user.dept));
                                const ratedRequired = requiredSkills.filter(s => 
                                    DB.getRating(this.user.id, s.id)?.status === 'approved'
                                ).length;
                                
                                if (ratedRequired === requiredSkills.length) {
                                    DB.updateUser(this.user.id, { skillsRequiredRated: true });
                                    UI.toast('Ð’ÑÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¸ Ð¾Ñ†ÐµÐ½ÐµÐ½Ñ‹!', 'success', 'ÐŸÐ¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÐµÐ¼!');
                                }
                            }
                            
                            UI.toast('ÐžÑ†ÐµÐ½ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð° Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð° Ð½Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ', 'success');
                            return true;
                        }
                    });
                };
                
                window.exportMySkills = () => {
                    const userSkills = skills.map(skill => {
                        const rating = userRatings.find(r => r.skillId === skill.id);
                        return {
                            ÐÐ°Ð²Ñ‹Ðº: skill.name,
                            ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ: categories.find(c => c.id === skill.catId)?.name || '',
                            ÐžÑ†ÐµÐ½ÐºÐ°: rating?.value || 'ÐÐµ Ð¾Ñ†ÐµÐ½ÐµÐ½Ð¾',
                            Ð¡Ñ‚Ð°Ñ‚ÑƒÑ: rating?.status ? CONFIG.statuses[rating.status].text : 'ÐÐµ Ð¾Ñ†ÐµÐ½ÐµÐ½Ð¾',
                            ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹: rating?.comment || '',
                            ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹: skill.requiredFor.includes(this.user.dept) ? 'Ð”Ð°' : 'ÐÐµÑ‚'
                        };
                    });
                    
                    let csv = 'ÐÐ°Ð²Ñ‹Ðº,ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ,ÐžÑ†ÐµÐ½ÐºÐ°,Ð¡Ñ‚Ð°Ñ‚ÑƒÑ,ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹,ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹\n';
                    userSkills.forEach(row => {
                        csv += `"${row.ÐÐ°Ð²Ñ‹Ðº}","${row.ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ}",${row.ÐžÑ†ÐµÐ½ÐºÐ°},"${row.Ð¡Ñ‚Ð°Ñ‚ÑƒÑ}","${row.ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹}",${row.ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹}\n`;
                    });
                    
                    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `ÐœÐ¾Ð¸_Ð½Ð°Ð²Ñ‹ÐºÐ¸_${this.user.name}_${new Date().toISOString().split('T')[0]}.csv`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    UI.toast('Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð² CSV', 'success');
                };
                
                // Open all categories initially
                setTimeout(() => {
                    categories.forEach(cat => {
                        const element = document.getElementById(`category-${cat.id}`);
                        if (element) {
                            element.classList.add('open');
                        }
                    });
                }, 500);
                
                return this.wrapper(html, 'ÐœÐ¾Ð¸ Ð½Ð°Ð²Ñ‹ÐºÐ¸');
            }
        }

        // 3.3 ENHANCED USER PROFILE WITH CHARTS
        class UserProfile extends DashboardLayout {
            render() {
                const userRatings = DB.getUserRatings(this.user.id);
                const categories = DB.getCategories();
                const skills = DB.getSkills();
                const goals = DB.getUserGoals(this.user.id);
                const feedback = DB.getFeedbackForUser(this.user.id);
                
                // Calculate stats
                const approvedRatings = userRatings.filter(r => r.status === 'approved');
                const avgRating = approvedRatings.length > 0 
                    ? approvedRatings.reduce((sum, r) => sum + r.value, 0) / approvedRatings.length 
                    : 0;
                
                const categoryAverages = categories.map(cat => {
                    const catSkills = skills.filter(s => s.catId === cat.id);
                    const catRatings = approvedRatings.filter(r => 
                        catSkills.some(s => s.id === r.skillId)
                    );
                    return catRatings.length > 0 
                        ? catRatings.reduce((sum, r) => sum + r.value, 0) / catRatings.length 
                        : 0;
                });
                
                const html = `
                    <div class="dashboard-grid">
                        <div class="dashboard-card-wide">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-chart-radar"></i>
                                        ÐšÐ°Ñ€Ñ‚Ð° ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹
                                    </div>
                                    <div class="btn-group">
                                        <button class="btn btn-outline btn-sm" onclick="changeChartType('radar')">Ð Ð°Ð´Ð°Ñ€</button>
                                        <button class="btn btn-outline btn-sm" onclick="changeChartType('bar')">Ð“Ð¸ÑÑ‚Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð°</button>
                                        <button class="btn btn-outline btn-sm" onclick="changeChartType('polar')">ÐŸÐ¾Ð»ÑÑ€Ð½Ð°Ñ</button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <canvas id="skillsChart" height="300"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-user-circle"></i>
                                        ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ
                                    </div>
                                    <button class="btn btn-outline btn-sm" onclick="editProfile()">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div style="text-align: center; margin-bottom: 24px;">
                                        <div class="avatar" style="width: 80px; height: 80px; font-size: 1.5rem; margin: 0 auto 16px;">
                                            ${this.user.avatar}
                                        </div>
                                        <h3>${this.user.name}</h3>
                                        <p class="text-muted">${this.user.position} â€¢ ${this.user.dept}</p>
                                    </div>
                                    
                                    <div style="background: var(--bg-hover); padding: 16px; border-radius: var(--radius-md); margin-bottom: 16px;">
                                        <div class="d-flex justify-content-between mb-2">
                                            <span>Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</span>
                                            <strong>${avgRating.toFixed(1)}/5</strong>
                                        </div>
                                        <div class="d-flex justify-content-between mb-2">
                                            <span>ÐžÑ†ÐµÐ½ÐµÐ½Ð¾ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</span>
                                            <strong>${approvedRatings.length}</strong>
                                        </div>
                                        <div class="d-flex justify-content-between mb-2">
                                            <span>Ð¡Ñ‚Ð°Ñ‚ÑƒÑ</span>
                                            <span class="badge badge-success">ÐÐºÑ‚Ð¸Ð²ÐµÐ½</span>
                                        </div>
                                        <div class="d-flex justify-content-between">
                                            <span>Ð’ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸ Ñ</span>
                                            <strong>${UI.formatDate(this.user.hireDate)}</strong>
                                        </div>
                                    </div>
                                    
                                    ${this.user.bio ? `
                                        <div>
                                            <h4 style="margin-bottom: 8px; font-size: 0.9rem; color: var(--text-light);">ÐžÐ±Ð¾ Ð¼Ð½Ðµ</h4>
                                            <p>${this.user.bio}</p>
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card-full">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-history"></i>
                                        Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="timeline" id="historyList">
                                        ${this.renderHistory(userRatings, skills)}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card-wide">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-bullseye"></i>
                                        ÐœÐ¾Ð¸ Ñ†ÐµÐ»Ð¸
                                    </div>
                                    <button class="btn btn-primary btn-sm" onclick="addGoal()">
                                        <i class="fas fa-plus"></i> ÐÐ¾Ð²Ð°Ñ Ñ†ÐµÐ»ÑŒ
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px;">
                                        ${this.renderGoals(goals)}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-comments"></i>
                                        ÐžÐ±Ñ€Ð°Ñ‚Ð½Ð°Ñ ÑÐ²ÑÐ·ÑŒ
                                    </div>
                                </div>
                                <div class="card-body">
                                    ${feedback.length > 0 ? this.renderFeedback(feedback, skills) : `
                                        <div style="text-align: center; padding: 40px; color: var(--text-light);">
                                            <i class="fas fa-comment-slash" style="font-size: 3rem; margin-bottom: 16px;"></i>
                                            <p>ÐŸÐ¾ÐºÐ° Ð½ÐµÑ‚ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²</p>
                                        </div>
                                    `}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                return this.wrapper(html, 'ÐœÐ¾Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ');
            }
            
            renderHistory(ratings, skills) {
                let historyItems = [];
                
                ratings.forEach(rating => {
                    const skill = skills.find(s => s.id === rating.skillId);
                    if (!skill) return;
                    
                    historyItems.push({
                        date: rating.date,
                        content: `ÐžÑ†ÐµÐ½ÐºÐ° Ð½Ð°Ð²Ñ‹ÐºÐ° <strong>${skill.name}</strong> ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð° Ð² <strong>${rating.value}/5</strong>`
                    });
                    
                    if (rating.history) {
                        rating.history.forEach(hist => {
                            historyItems.push({
                                date: hist.date,
                                content: `ÐÐ°Ð²Ñ‹Ðº <strong>${skill.name}</strong> Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½ Ñ ${hist.value} Ð½Ð° ${rating.value}/5`
                            });
                        });
                    }
                });
                
                // Sort by date descending
                historyItems.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                // Get last 10 items
                const recentItems = historyItems.slice(0, 10);
                
                if (recentItems.length === 0) {
                    return '<div style="text-align: center; padding: 40px; color: var(--text-light);">Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¿ÑƒÑÑ‚Ð°</div>';
                }
                
                return recentItems.map(item => `
                    <div class="timeline-item">
                        <div class="timeline-date">${UI.formatDate(item.date)}</div>
                        <div class="timeline-content">${item.content}</div>
                    </div>
                `).join('');
            }
            
            renderGoals(goals) {
                if (goals.length === 0) {
                    return `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--text-light);">
                            <i class="fas fa-bullseye" style="font-size: 3rem; margin-bottom: 16px;"></i>
                            <p>Ð£ Ð²Ð°Ñ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ Ñ†ÐµÐ»ÐµÐ¹</p>
                            <button class="btn btn-primary mt-3" onclick="addGoal()">
                                <i class="fas fa-plus"></i> Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ñ†ÐµÐ»ÑŒ
                            </button>
                        </div>
                    `;
                }
                
                return goals.map(goal => {
                    const priorityColors = {
                        high: 'danger',
                        medium: 'warning',
                        low: 'info'
                    };
                    
                    const statusColors = {
                        not_started: 'secondary',
                        in_progress: 'warning',
                        completed: 'success'
                    };
                    
                    const statusIcons = {
                        not_started: 'fa-clock',
                        in_progress: 'fa-spinner fa-pulse',
                        completed: 'fa-check-circle'
                    };
                    
                    return `
                        <div class="card" style="margin-bottom: 0;">
                            <div class="card-header" style="padding: 12px;">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <span class="badge badge-${priorityColors[goal.priority] || 'secondary'}">${goal.priority}</span>
                                        <span class="badge badge-${statusColors[goal.status] || 'secondary'}">
                                            <i class="fas ${statusIcons[goal.status] || 'fa-clock'}"></i> ${goal.status}
                                        </span>
                                    </div>
                                    <div class="btn-group">
                                        <button class="btn btn-sm btn-outline" onclick="editGoal('${goal.id}')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline" onclick="deleteGoal('${goal.id}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body" style="padding: 16px;">
                                <h4 style="margin-bottom: 8px; font-size: 1.1rem;">${goal.title}</h4>
                                ${goal.description ? `<p style="color: var(--text-sec); margin-bottom: 12px; font-size: 0.9rem;">${goal.description}</p>` : ''}
                                
                                <div class="progress-bar" style="margin: 12px 0;">
                                    <div class="progress-fill" style="width: ${goal.progress}%"></div>
                                </div>
                                <div class="d-flex justify-content-between" style="font-size: 0.85rem; color: var(--text-sec);">
                                    <span>ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ: ${goal.progress}%</span>
                                    <span>Ð”Ð¾: ${UI.formatDate(goal.deadline)}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            renderFeedback(feedback, skills) {
                return feedback.map(fb => {
                    const fromUser = DB.getUserById(fb.fromUserId);
                    const skill = skills.find(s => s.id === fb.skillId);
                    
                    return `
                        <div style="background: var(--bg-hover); padding: 16px; border-radius: var(--radius-md); margin-bottom: 12px; border-left: 4px solid var(--primary);">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <div>
                                    <strong>${fromUser?.name || 'ÐšÐ¾Ð»Ð»ÐµÐ³Ð°'}</strong>
                                    <div style="font-size: 0.85rem; color: var(--text-light);">
                                        ${skill ? `ÐÐ°Ð²Ñ‹Ðº: ${skill.name}` : ''} â€¢ ${UI.formatDate(fb.date)}
                                    </div>
                                </div>
                                <div class="rating-input">
                                    ${[1,2,3,4,5].map(i => `
                                        <div class="star-btn ${i <= fb.rating ? 'active' : ''}" style="width: 24px; height: 24px; font-size: 0.8rem;">
                                            ${i}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <p style="margin: 0; font-size: 0.95rem;">${fb.comment}</p>
                        </div>
                    `;
                }).join('');
            }
            
            postRender() {
                const categories = DB.getCategories();
                const userRatings = DB.getUserRatings(this.user.id);
                const skills = DB.getSkills();
                
                // Calculate category averages
                const categoryAverages = categories.map(cat => {
                    const catSkills = skills.filter(s => s.catId === cat.id);
                    const catRatings = userRatings
                        .filter(r => r.status === 'approved')
                        .filter(r => catSkills.some(s => s.id === r.skillId));
                    
                    return catRatings.length > 0 
                        ? catRatings.reduce((sum, r) => sum + r.value, 0) / catRatings.length 
                        : 0;
                });
                
                const categoryLabels = categories.map(c => c.name);
                
                // Create chart
                const ctx = document.getElementById('skillsChart').getContext('2d');
                let chart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: categoryLabels,
                        datasets: [{
                            label: 'ÐœÐ¾Ð¸ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¸',
                            data: categoryAverages,
                            fill: true,
                            backgroundColor: 'rgba(99, 102, 241, 0.2)',
                            borderColor: 'rgb(99, 102, 241)',
                            pointBackgroundColor: 'rgb(99, 102, 241)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(99, 102, 241)',
                            tension: 0.4
                        }, {
                            label: 'Ð¦ÐµÐ»ÐµÐ²Ð¾Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ',
                            data: Array(categoryLabels.length).fill(4),
                            fill: false,
                            borderColor: 'rgb(16, 185, 129)',
                            pointBackgroundColor: 'rgb(16, 185, 129)',
                            pointBorderColor: '#fff',
                            borderDash: [5, 5],
                            tension: 0.4
                        }]
                    },
                    options: {
                        scales: {
                            r: {
                                min: 0,
                                max: 5,
                                ticks: {
                                    stepSize: 1
                                },
                                pointLabels: {
                                    font: {
                                        size: 11,
                                        family: "'Inter', sans-serif"
                                    }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                labels: {
                                    font: {
                                        size: 12,
                                        family: "'Inter', sans-serif"
                                    }
                                }
                            }
                        }
                    }
                });
                
                // Chart type switching
                window.changeChartType = (type) => {
                    chart.destroy();
                    
                    const config = {
                        radar: {
                            type: 'radar',
                            options: chart.options
                        },
                        bar: {
                            type: 'bar',
                            options: {
                                scales: {
                                    y: {
                                        min: 0,
                                        max: 5
                                    }
                                }
                            }
                        },
                        polar: {
                            type: 'polarArea',
                            options: {}
                        }
                    }[type];
                    
                    chart = new Chart(ctx, {
                        ...config,
                        data: {
                            labels: categoryLabels,
                            datasets: [{
                                label: 'ÐœÐ¾Ð¸ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¸',
                                data: categoryAverages,
                                backgroundColor: [
                                    'rgba(99, 102, 241, 0.7)',
                                    'rgba(16, 185, 129, 0.7)',
                                    'rgba(139, 92, 246, 0.7)',
                                    'rgba(245, 158, 11, 0.7)',
                                    'rgba(239, 68, 68, 0.7)',
                                    'rgba(6, 182, 212, 0.7)'
                                ]
                            }]
                        }
                    });
                };
                
                // Profile editing
                window.editProfile = () => {
                    UI.modal({
                        title: 'Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ',
                        size: 'lg',
                        content: `
                            <div class="form-group">
                                <label class="form-label">Ð¤Ð˜Ðž</label>
                                <input class="form-control" id="editName" value="${this.user.name}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input class="form-control" type="email" id="editEmail" value="${this.user.email}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½</label>
                                <input class="form-control" id="editPhone" value="${this.user.phone}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÐžÐ±Ð¾ Ð¼Ð½Ðµ</label>
                                <textarea class="form-control" id="editBio" rows="4">${this.user.bio || ''}</textarea>
                            </div>
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label">ÐžÑ‚Ð´ÐµÐ»</label>
                                    <select class="form-control" id="editDept">
                                        ${CONFIG.depts.map(dept => 
                                            `<option value="${dept}" ${dept === this.user.dept ? 'selected' : ''}>${dept}</option>`
                                        ).join('')}
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label">Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ</label>
                                    <input class="form-control" id="editPosition" value="${this.user.position}">
                                </div>
                            </div>
                        `,
                        onConfirm: () => {
                            const updates = {
                                name: document.getElementById('editName').value,
                                email: document.getElementById('editEmail').value,
                                phone: document.getElementById('editPhone').value,
                                bio: document.getElementById('editBio').value,
                                dept: document.getElementById('editDept').value,
                                position: document.getElementById('editPosition').value
                            };
                            
                            if (!updates.name.trim()) {
                                UI.toast('Ð˜Ð¼Ñ Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¿ÑƒÑÑ‚Ñ‹Ð¼', 'error');
                                return false;
                            }
                            
                            DB.updateUser(this.user.id, updates);
                            UI.toast('ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½', 'success');
                            setTimeout(() => location.reload(), 500);
                            return true;
                        }
                    });
                };
                
                // Goal management
                window.addGoal = () => {
                    UI.modal({
                        title: 'ÐÐ¾Ð²Ð°Ñ Ñ†ÐµÐ»ÑŒ',
                        content: `
                            <div class="form-group">
                                <label class="form-label required">ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸</label>
                                <input class="form-control" id="goalTitle" placeholder="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Ð˜Ð·ÑƒÑ‡Ð¸Ñ‚ÑŒ TypeScript">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ</label>
                                <textarea class="form-control" id="goalDescription" rows="3" placeholder="Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸..."></textarea>
                            </div>
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚</label>
                                    <select class="form-control" id="goalPriority">
                                        <option value="high">Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹</option>
                                        <option value="medium" selected>Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹</option>
                                        <option value="low">ÐÐ¸Ð·ÐºÐ¸Ð¹</option>
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð”ÐµÐ´Ð»Ð°Ð¹Ð½</label>
                                    <input class="form-control" type="date" id="goalDeadline" value="${new Date(Date.now() + 30*24*60*60*1000).toISOString().split('T')[0]}">
                                </div>
                            </div>
                        `,
                        onConfirm: () => {
                            const title = document.getElementById('goalTitle').value.trim();
                            const description = document.getElementById('goalDescription').value.trim();
                            const priority = document.getElementById('goalPriority').value;
                            const deadline = document.getElementById('goalDeadline').value;
                            
                            if (!title) {
                                UI.toast('ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾', 'error');
                                return false;
                            }
                            
                            if (!deadline) {
                                UI.toast('Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ð´ÐµÐ´Ð»Ð°Ð¹Ð½', 'error');
                                return false;
                            }
                            
                            DB.addGoal(this.user.id, {
                                title,
                                description,
                                priority,
                                deadline,
                                status: 'not_started',
                                progress: 0
                            });
                            
                            UI.toast('Ð¦ÐµÐ»ÑŒ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð°', 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                window.editGoal = (goalId) => {
                    const goal = DB.state.goals.find(g => g.id === goalId);
                    if (!goal) return;
                    
                    UI.modal({
                        title: 'Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸',
                        content: `
                            <div class="form-group">
                                <label class="form-label">ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸</label>
                                <input class="form-control" id="editGoalTitle" value="${goal.title}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ</label>
                                <textarea class="form-control" id="editGoalDescription" rows="3">${goal.description || ''}</textarea>
                            </div>
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label">ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚</label>
                                    <select class="form-control" id="editGoalPriority">
                                        <option value="high" ${goal.priority === 'high' ? 'selected' : ''}>Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹</option>
                                        <option value="medium" ${goal.priority === 'medium' ? 'selected' : ''}>Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹</option>
                                        <option value="low" ${goal.priority === 'low' ? 'selected' : ''}>ÐÐ¸Ð·ÐºÐ¸Ð¹</option>
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label">Ð¡Ñ‚Ð°Ñ‚ÑƒÑ</label>
                                    <select class="form-control" id="editGoalStatus">
                                        <option value="not_started" ${goal.status === 'not_started' ? 'selected' : ''}>ÐÐµ Ð½Ð°Ñ‡Ð°Ñ‚Ð°</option>
                                        <option value="in_progress" ${goal.status === 'in_progress' ? 'selected' : ''}>Ð’ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ</option>
                                        <option value="completed" ${goal.status === 'completed' ? 'selected' : ''}>Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label">ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ (%)</label>
                                    <input class="form-control" type="number" min="0" max="100" id="editGoalProgress" value="${goal.progress}">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label">Ð”ÐµÐ´Ð»Ð°Ð¹Ð½</label>
                                    <input class="form-control" type="date" id="editGoalDeadline" value="${goal.deadline}">
                                </div>
                            </div>
                        `,
                        onConfirm: () => {
                            const updates = {
                                title: document.getElementById('editGoalTitle').value.trim(),
                                description: document.getElementById('editGoalDescription').value.trim(),
                                priority: document.getElementById('editGoalPriority').value,
                                status: document.getElementById('editGoalStatus').value,
                                progress: parseInt(document.getElementById('editGoalProgress').value) || 0,
                                deadline: document.getElementById('editGoalDeadline').value
                            };
                            
                            if (!updates.title) {
                                UI.toast('ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾', 'error');
                                return false;
                            }
                            
                            DB.updateGoal(goalId, updates);
                            UI.toast('Ð¦ÐµÐ»ÑŒ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð°', 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                window.deleteGoal = (goalId) => {
                    UI.confirm({
                        title: 'Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ»Ð¸',
                        message: 'Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÑ‚Ñƒ Ñ†ÐµÐ»ÑŒ?',
                        type: 'danger'
                    }).then(confirmed => {
                        if (confirmed) {
                            DB.deleteGoal(goalId);
                            UI.toast('Ð¦ÐµÐ»ÑŒ ÑƒÐ´Ð°Ð»ÐµÐ½Ð°', 'success');
                            App.render();
                        }
                    });
                };
            }
        }

        // 3.4 ENHANCED MANAGER TEAM VIEW
        class ManagerTeam extends DashboardLayout {
            render() {
                const team = DB.getUsersByDept(this.user.dept);
                const skills = DB.getSkills();
                
                // Calculate team statistics
                const totalMembers = team.length;
                const pendingReviews = DB.state.ratings.filter(r => 
                    team.some(u => u.id === r.userId) && r.status === 'pending'
                ).length;
                
                const avgTeamRating = team.length > 0 ? team.reduce((sum, user) => {
                    const ratings = DB.getUserRatings(user.id).filter(r => r.status === 'approved');
                    return sum + (ratings.length > 0 ? 
                        ratings.reduce((sumR, r) => sumR + r.value, 0) / ratings.length : 0);
                }, 0) / team.length : 0;
                
                let html = `
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon primary">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${totalMembers}</div>
                                <div class="stat-label">Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² Ð² Ð¾Ñ‚Ð´ÐµÐ»Ðµ</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon warning">
                                <i class="fas fa-clipboard-check"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${pendingReviews}</div>
                                <div class="stat-label">ÐžÑ†ÐµÐ½Ð¾Ðº Ð½Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ</div>
                                ${pendingReviews > 0 ? `<div class="stat-change warning">Ð¢Ñ€ÐµÐ±ÑƒÑŽÑ‚ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ñ</div>` : ''}
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon success">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${avgTeamRating.toFixed(1)}</div>
                                <div class="stat-label">Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð» Ð¾Ñ‚Ð´ÐµÐ»Ð°</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon info">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${this.getSkillGapPercentage()}%</div>
                                <div class="stat-label">ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${this.getSkillGapPercentage()}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-users"></i>
                                Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¸ Ð¾Ñ‚Ð´ÐµÐ»Ð° ${this.user.dept}
                            </div>
                            <button class="btn btn-primary btn-sm" onclick="addTeamMember()">
                                <i class="fas fa-user-plus"></i> Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°
                            </button>
                        </div>
                        <div class="card-body">
                `;
                
                if (team.length === 0) {
                    html += `
                        <div style="text-align: center; padding: 40px; color: var(--text-light);">
                            <i class="fas fa-users-slash" style="font-size: 3rem; margin-bottom: 16px;"></i>
                            <p>Ð’ Ð²Ð°ÑˆÐµÐ¼ Ð¾Ñ‚Ð´ÐµÐ»Ðµ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²</p>
                            <button class="btn btn-primary mt-3" onclick="addTeamMember()">
                                <i class="fas fa-user-plus"></i> Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°
                            </button>
                        </div>
                    `;
                } else {
                    html += `
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                            ${team.map(emp => {
                                const ratings = DB.getUserRatings(emp.id);
                                const approvedRatings = ratings.filter(r => r.status === 'approved');
                                const pendingRatings = ratings.filter(r => r.status === 'pending');
                                
                                const avgRating = approvedRatings.length > 0 
                                    ? approvedRatings.reduce((sum, r) => sum + r.value, 0) / approvedRatings.length 
                                    : 0;
                                
                                const skillGap = this.calculateSkillGap(emp);
                                
                                return `
                                    <div class="card" style="margin: 0; cursor: pointer;" onclick="openEmployeeModal(${emp.id})">
                                        <div class="card-body">
                                            <div class="d-flex align-items-start gap-3 mb-3">
                                                <div class="avatar online" style="width: 50px; height: 50px; font-size: 1.1rem;">
                                                    ${emp.avatar}
                                                </div>
                                                <div style="flex: 1;">
                                                    <h4 style="margin: 0 0 4px 0; font-size: 1.1rem;">${emp.name}</h4>
                                                    <p style="margin: 0; color: var(--text-sec); font-size: 0.85rem;">${emp.position}</p>
                                                    <div class="d-flex align-items-center gap-2 mt-2">
                                                        <div class="rating-input" style="gap: 2px;">
                                                            ${[1,2,3,4,5].map(i => `
                                                                <div class="star-btn ${i <= Math.round(avgRating) ? 'active' : ''}" 
                                                                     style="width: 20px; height: 20px; font-size: 0.7rem;">
                                                                    ${i}
                                                                </div>
                                                            `).join('')}
                                                        </div>
                                                        <span style="font-size: 0.85rem; color: var(--text-light);">${avgRating.toFixed(1)}</span>
                                                    </div>
                                                </div>
                                                ${pendingRatings.length > 0 ? `
                                                    <span class="badge badge-warning" style="position: absolute; top: 12px; right: 12px;">
                                                        ${pendingRatings.length}
                                                    </span>
                                                ` : ''}
                                            </div>
                                            
                                            <div style="background: var(--bg-hover); padding: 12px; border-radius: var(--radius-md); margin-bottom: 12px;">
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span style="font-size: 0.85rem;">ÐžÑ†ÐµÐ½ÐµÐ½Ð¾ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</span>
                                                    <strong>${approvedRatings.length}</strong>
                                                </div>
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span style="font-size: 0.85rem;">ÐÐ° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ</span>
                                                    <strong>${pendingRatings.length}</strong>
                                                </div>
                                                <div class="d-flex justify-content-between">
                                                    <span style="font-size: 0.85rem;">ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</span>
                                                    <strong>${skillGap.coverage}%</strong>
                                                </div>
                                            </div>
                                            
                                            <button class="btn btn-outline btn-sm" style="width: 100%;" onclick="event.stopPropagation(); giveFeedback(${emp.id})">
                                                <i class="fas fa-comment"></i> Ð”Ð°Ñ‚ÑŒ Ð¾Ð±Ñ€Ð°Ñ‚Ð½ÑƒÑŽ ÑÐ²ÑÐ·ÑŒ
                                            </button>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                }
                
                html += `</div></div>`;
                
                // Add team management functions
                window.addTeamMember = () => {
                    UI.modal({
                        title: 'Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ° Ð² Ð¾Ñ‚Ð´ÐµÐ»',
                        size: 'lg',
                        content: `
                            <div class="form-group">
                                <label class="form-label required">Ð¤Ð˜Ðž</label>
                                <input class="form-control" id="newMemberName" placeholder="Ð˜Ð²Ð°Ð½Ð¾Ð² Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²Ð¸Ñ‡">
                            </div>
                            <div class="form-group">
                                <label class="form-label required">Ð›Ð¾Ð³Ð¸Ð½</label>
                                <input class="form-control" id="newMemberLogin" placeholder="ivanov">
                            </div>
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ</label>
                                    <select class="form-control" id="newMemberPosition">
                                        ${CONFIG.positions.map(pos => `<option value="${pos}">${pos}</option>`).join('')}
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Email</label>
                                    <input class="form-control" type="email" id="newMemberEmail" placeholder="ivanov@company.com">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ðž ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐµ</label>
                                <textarea class="form-control" id="newMemberBio" rows="3" placeholder="ÐžÐ¿Ñ‹Ñ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹, Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ðµ, Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÑ‹..."></textarea>
                            </div>
                        `,
                        onConfirm: () => {
                            const name = document.getElementById('newMemberName').value.trim();
                            const login = document.getElementById('newMemberLogin').value.trim();
                            const position = document.getElementById('newMemberPosition').value;
                            const email = document.getElementById('newMemberEmail').value.trim();
                            const bio = document.getElementById('newMemberBio').value.trim();
                            
                            if (!name || !login || !position || !email) {
                                UI.toast('Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð²ÑÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ', 'error');
                                return false;
                            }
                            
                            // Check if login already exists
                            if (DB.state.users.some(u => u.login === login)) {
                                UI.toast('ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ Ñ‚Ð°ÐºÐ¸Ð¼ Ð»Ð¾Ð³Ð¸Ð½Ð¾Ð¼ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚', 'error');
                                return false;
                            }
                            
                            const newUser = DB.createUser({
                                name,
                                login,
                                dept: this.user.dept,
                                position,
                                email,
                                bio,
                                role: 'employee'
                            });
                            
                            UI.toast(`Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº ${name} Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð² Ð¾Ñ‚Ð´ÐµÐ»`, 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                window.openEmployeeModal = (userId) => {
                    const user = DB.getUserById(userId);
                    if (!user) return;
                    
                    const ratings = DB.getUserRatings(userId);
                    const skills = DB.getSkills();
                    const pendingRatings = ratings.filter(r => r.status === 'pending');
                    const approvedRatings = ratings.filter(r => r.status === 'approved');
                    
                    const content = `
                        <div style="margin-bottom: 24px;">
                            <div class="d-flex align-items-center gap-3 mb-4">
                                <div class="avatar" style="width: 60px; height: 60px; font-size: 1.3rem;">
                                    ${user.avatar}
                                </div>
                                <div>
                                    <h3 style="margin: 0 0 4px 0;">${user.name}</h3>
                                    <p style="margin: 0; color: var(--text-sec);">${user.position} â€¢ ${user.dept}</p>
                                </div>
                            </div>
                            
                            <div class="tabs" id="employeeTabs">
                                <div class="tab active" onclick="switchEmployeeTab('skills', ${userId})">ÐÐ°Ð²Ñ‹ÐºÐ¸</div>
                                <div class="tab" onclick="switchEmployeeTab('goals', ${userId})">Ð¦ÐµÐ»Ð¸</div>
                                <div class="tab" onclick="switchEmployeeTab('history', ${userId})">Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ</div>
                            </div>
                            <div id="employeeTabContent"></div>
                        </div>
                    `;
                    
                    const modal = UI.modal({
                        title: `ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°`,
                        size: 'lg',
                        content,
                        onConfirm: null,
                        showConfirm: false,
                        showCancel: false
                    });
                    
                    // Load initial tab
                    setTimeout(() => switchEmployeeTab('skills', userId), 100);
                };
                
                window.switchEmployeeTab = (tab, userId) => {
                    const tabs = document.querySelectorAll('#employeeTabs .tab');
                    tabs.forEach(t => t.classList.remove('active'));
                    event.target.classList.add('active');
                    
                    const content = document.getElementById('employeeTabContent');
                    
                    if (tab === 'skills') {
                        renderEmployeeSkills(userId, content);
                    } else if (tab === 'goals') {
                        renderEmployeeGoals(userId, content);
                    } else if (tab === 'history') {
                        renderEmployeeHistory(userId, content);
                    }
                };
                
                const renderEmployeeSkills = (userId, container) => {
                    const user = DB.getUserById(userId);
                    const ratings = DB.getUserRatings(userId);
                    const skills = DB.getSkills();
                    const categories = DB.getCategories();
                    
                    let html = '';
                    
                    if (ratings.length === 0) {
                        html = `<p style="text-align: center; color: var(--text-light); padding: 40px;">ÐÐµÑ‚ Ð¾Ñ†ÐµÐ½Ð¾Ðº Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</p>`;
                    } else {
                        categories.forEach(category => {
                            const catSkills = skills.filter(s => s.catId === category.id);
                            const catRatings = ratings.filter(r => 
                                catSkills.some(s => s.id === r.skillId)
                            );
                            
                            if (catRatings.length === 0) return;
                            
                            html += `
                                <div style="margin-bottom: 20px;">
                                    <h4 style="margin-bottom: 12px; font-size: 1rem;">
                                        <i class="fas ${category.icon}" style="color: ${category.color}"></i>
                                        ${category.name}
                                    </h4>
                                    <div style="background: var(--bg-hover); border-radius: var(--radius-md); overflow: hidden;">
                            `;
                            
                            catRatings.forEach(rating => {
                                const skill = skills.find(s => s.id === rating.skillId);
                                if (!skill) return;
                                
                                html += `
                                    <div style="padding: 12px 16px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <div style="font-weight: 600; margin-bottom: 4px;">${skill.name}</div>
                                            ${rating.comment ? `<div style="font-size: 0.85rem; color: var(--text-sec);">${rating.comment}</div>` : ''}
                                        </div>
                                        <div>
                                            <div class="d-flex align-items-center gap-3">
                                                <div class="rating-input">
                                                    ${[1,2,3,4,5].map(i => `
                                                        <div class="star-btn ${i <= rating.value ? 'active' : ''} readonly"
                                                             style="width: 28px; height: 28px; font-size: 0.85rem;">
                                                            ${i}
                                                        </div>
                                                    `).join('')}
                                                </div>
                                                <span class="badge badge-${CONFIG.statuses[rating.status].color}">
                                                    ${CONFIG.statuses[rating.status].text}
                                                </span>
                                                ${rating.status === 'pending' ? `
                                                    <div class="btn-group">
                                                        <button class="btn btn-sm btn-success" onclick="approveRating(${userId}, '${skill.id}')">
                                                            <i class="fas fa-check"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-danger" onclick="rejectRating(${userId}, '${skill.id}')">
                                                            <i class="fas fa-times"></i>
                                                        </button>
                                                    </div>
                                                ` : ''}
                                            </div>
                                        </div>
                                    </div>
                                `;
                            });
                            
                            html += `</div></div>`;
                        });
                    }
                    
                    container.innerHTML = html;
                };
                
                const renderEmployeeGoals = (userId, container) => {
                    const goals = DB.getUserGoals(userId);
                    
                    if (goals.length === 0) {
                        container.innerHTML = `<p style="text-align: center; color: var(--text-light); padding: 40px;">ÐÐµÑ‚ Ñ†ÐµÐ»ÐµÐ¹</p>`;
                        return;
                    }
                    
                    let html = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">';
                    
                    goals.forEach(goal => {
                        const priorityColors = {
                            high: 'danger',
                            medium: 'warning',
                            low: 'info'
                        };
                        
                        const statusColors = {
                            not_started: 'secondary',
                            in_progress: 'warning',
                            completed: 'success'
                        };
                        
                        html += `
                            <div style="background: var(--bg-hover); padding: 16px; border-radius: var(--radius-md);">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <div>
                                        <strong>${goal.title}</strong>
                                        <div style="font-size: 0.85rem; color: var(--text-light);">
                                            Ð”Ð¾: ${UI.formatDate(goal.deadline)}
                                        </div>
                                    </div>
                                    <div>
                                        <span class="badge badge-${priorityColors[goal.priority] || 'secondary'}">${goal.priority}</span>
                                        <span class="badge badge-${statusColors[goal.status] || 'secondary'}">${goal.status}</span>
                                    </div>
                                </div>
                                ${goal.description ? `<p style="font-size: 0.9rem; margin-bottom: 12px;">${goal.description}</p>` : ''}
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${goal.progress}%"></div>
                                </div>
                                <div style="font-size: 0.85rem; color: var(--text-sec); text-align: right; margin-top: 4px;">
                                    ${goal.progress}%
                                </div>
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                    container.innerHTML = html;
                };
                
                const renderEmployeeHistory = (userId, container) => {
                    const ratings = DB.getUserRatings(userId);
                    const skills = DB.getSkills();
                    
                    let history = [];
                    
                    ratings.forEach(rating => {
                        const skill = skills.find(s => s.id === rating.skillId);
                        if (!skill) return;
                        
                        history.push({
                            date: rating.date,
                            content: `ÐžÑ†ÐµÐ½ÐºÐ° Ð½Ð°Ð²Ñ‹ÐºÐ° <strong>${skill.name}</strong> ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð° Ð² <strong>${rating.value}/5</strong> (${CONFIG.statuses[rating.status].text})`
                        });
                        
                        if (rating.history) {
                            rating.history.forEach(hist => {
                                history.push({
                                    date: hist.date,
                                    content: `ÐÐ°Ð²Ñ‹Ðº <strong>${skill.name}</strong> Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½ Ñ ${hist.value} Ð½Ð° ${rating.value}/5`
                                });
                            });
                        }
                    });
                    
                    history.sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    if (history.length === 0) {
                        container.innerHTML = `<p style="text-align: center; color: var(--text-light); padding: 40px;">Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¿ÑƒÑÑ‚Ð°</p>`;
                        return;
                    }
                    
                    let html = '<div class="timeline">';
                    history.slice(0, 10).forEach(item => {
                        html += `
                            <div class="timeline-item">
                                <div class="timeline-date">${UI.formatDate(item.date)}</div>
                                <div class="timeline-content">${item.content}</div>
                            </div>
                        `;
                    });
                    html += '</div>';
                    
                    container.innerHTML = html;
                };
                
                window.approveRating = (userId, skillId) => {
                    if (DB.approveRating(userId, skillId)) {
                        UI.toast('ÐžÑ†ÐµÐ½ÐºÐ° Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð°', 'success');
                        // Refresh the modal content
                        const user = DB.getUserById(userId);
                        if (user) openEmployeeModal(userId);
                    }
                };
                
                window.rejectRating = (userId, skillId) => {
                    UI.modal({
                        title: 'ÐžÑ‚ÐºÐ»Ð¾Ð½Ð¸Ñ‚ÑŒ Ð¾Ñ†ÐµÐ½ÐºÑƒ',
                        content: `
                            <div class="form-group">
                                <label class="form-label">ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð° Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸Ñ</label>
                                <textarea class="form-control" id="rejectReason" rows="3" placeholder="Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ñƒ Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸Ñ Ð¾Ñ†ÐµÐ½ÐºÐ¸..."></textarea>
                            </div>
                        `,
                        onConfirm: () => {
                            const reason = document.getElementById('rejectReason').value.trim();
                            if (DB.rejectRating(userId, skillId, reason)) {
                                UI.toast('ÐžÑ†ÐµÐ½ÐºÐ° Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð°', 'success');
                                const user = DB.getUserById(userId);
                                if (user) openEmployeeModal(userId);
                                return true;
                            }
                            return false;
                        }
                    });
                };
                
                window.giveFeedback = (toUserId) => {
                    const skills = DB.getSkills();
                    
                    UI.modal({
                        title: 'Ð”Ð°Ñ‚ÑŒ Ð¾Ð±Ñ€Ð°Ñ‚Ð½ÑƒÑŽ ÑÐ²ÑÐ·ÑŒ',
                        size: 'lg',
                        content: `
                            <div class="form-group">
                                <label class="form-label required">ÐÐ°Ð²Ñ‹Ðº</label>
                                <select class="form-control" id="feedbackSkill">
                                    <option value="">Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð½Ð°Ð²Ñ‹Ðº</option>
                                    ${skills.map(s => `<option value="${s.id}">${s.name}</option>`).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label required">ÐžÑ†ÐµÐ½ÐºÐ°</label>
                                <div class="rating-input" style="justify-content: center; margin: 10px 0;">
                                    ${[1,2,3,4,5].map(i => `
                                        <div class="star-btn" id="star-${i}"
                                             onclick="document.querySelectorAll('[id^=star-]').forEach(btn => btn.classList.remove('active')); 
                                                      for(let j=1; j<=${i}; j++) document.getElementById('star-'+j).classList.add('active');
                                                      document.getElementById('feedbackRating').value = ${i};"
                                             style="width: 40px; height: 40px;">
                                            ${i}
                                        </div>
                                    `).join('')}
                                </div>
                                <input type="hidden" id="feedbackRating" value="3">
                            </div>
                            <div class="form-group">
                                <label class="form-label required">ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹</label>
                                <textarea class="form-control" id="feedbackComment" rows="4" placeholder="ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ð¾ Ð¾Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ð¾Ð±Ñ€Ð°Ñ‚Ð½ÑƒÑŽ ÑÐ²ÑÐ·ÑŒ..."></textarea>
                            </div>
                        `,
                        onConfirm: () => {
                            const skillId = document.getElementById('feedbackSkill').value;
                            const rating = parseInt(document.getElementById('feedbackRating').value);
                            const comment = document.getElementById('feedbackComment').value.trim();
                            
                            if (!skillId) {
                                UI.toast('Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð½Ð°Ð²Ñ‹Ðº', 'error');
                                return false;
                            }
                            
                            if (!comment) {
                                UI.toast('Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹', 'error');
                                return false;
                            }
                            
                            DB.addFeedback({
                                fromUserId: this.user.id,
                                toUserId,
                                skillId,
                                rating,
                                comment
                            });
                            
                            UI.toast('ÐžÐ±Ñ€Ð°Ñ‚Ð½Ð°Ñ ÑÐ²ÑÐ·ÑŒ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð°', 'success');
                            return true;
                        }
                    });
                };
                
                return this.wrapper(html, 'ÐœÐ¾Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°');
            }
            
            getSkillGapPercentage() {
                const team = DB.getUsersByDept(this.user.dept);
                const requiredSkills = DB.getSkills().filter(s => s.requiredFor.includes(this.user.dept));
                
                if (requiredSkills.length === 0 || team.length === 0) return 0;
                
                let coveredSkills = 0;
                requiredSkills.forEach(skill => {
                    const usersWithSkill = team.filter(user => {
                        const rating = DB.getRating(user.id, skill.id);
                        return rating && rating.status === 'approved' && rating.value >= 3;
                    });
                    if (usersWithSkill.length > 0) coveredSkills++;
                });
                
                return Math.round((coveredSkills / requiredSkills.length) * 100);
            }
            
            calculateSkillGap(user) {
                const requiredSkills = DB.getSkills().filter(s => s.requiredFor.includes(this.user.dept));
                const userRatings = DB.getUserRatings(user.id);
                
                let covered = 0;
                requiredSkills.forEach(skill => {
                    const rating = userRatings.find(r => r.skillId === skill.id);
                    if (rating && rating.status === 'approved' && rating.value >= 3) {
                        covered++;
                    }
                });
                
                return {
                    total: requiredSkills.length,
                    covered,
                    coverage: requiredSkills.length > 0 ? Math.round((covered / requiredSkills.length) * 100) : 0
                };
            }
        }

        // 3.5 ENHANCED COMPARISON VIEW
        class ManagerCompare extends DashboardLayout {
            render() {
                const team = DB.getUsersByDept(this.user.dept);
                const skills = DB.getSkills();
                
                let html = `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-chart-bar"></i>
                                Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
                            </div>
                            <button class="btn btn-primary btn-sm" onclick="exportComparison()">
                                <i class="fas fa-download"></i> Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² Ð´Ð»Ñ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ:</label>
                                <div style="display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 20px;">
                                    ${team.map(u => `
                                        <label class="form-check" style="background: var(--bg-hover); padding: 12px; border-radius: var(--radius-md);">
                                            <input type="checkbox" class="form-check-input compare-chk" value="${u.id}" onchange="renderCompareChart()">
                                            <span class="form-check-label">
                                                <div class="d-flex align-items-center gap-2">
                                                    <div class="avatar" style="width: 24px; height: 24px; font-size: 0.7rem;">${u.avatar}</div>
                                                    ${u.name}
                                                </div>
                                            </span>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹:</label>
                                <div style="display: flex; gap: 16px; flex-wrap: wrap;">
                                    <label class="form-check">
                                        <input type="checkbox" class="form-check-input" id="diffOnly" onchange="renderCompareChart()">
                                        <span class="form-check-label">Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð¸Ñ</span>
                                    </label>
                                    <label class="form-check">
                                        <input type="checkbox" class="form-check-input" id="showAverages" onchange="renderCompareChart()" checked>
                                        <span class="form-check-label">ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÑÑ€ÐµÐ´Ð½Ð¸Ðµ</span>
                                    </label>
                                    <div style="flex: 1; max-width: 200px;">
                                        <select class="form-control" id="chartType" onchange="renderCompareChart()">
                                            <option value="radar">Ð Ð°Ð´Ð°Ñ€Ð½Ð°Ñ Ð´Ð¸Ð°Ð³Ñ€Ð°Ð¼Ð¼Ð°</option>
                                            <option value="bar" selected>Ð“Ð¸ÑÑ‚Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð°</option>
                                            <option value="line">Ð›Ð¸Ð½ÐµÐ¹Ð½Ñ‹Ð¹ Ð³Ñ€Ð°Ñ„Ð¸Ðº</option>
                                            <option value="heatmap">Ð¢ÐµÐ¿Ð»Ð¾Ð²Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 32px;">
                                <div id="compareChartContainer" style="height: 500px;"></div>
                                <div id="compareTableContainer" style="margin-top: 32px;"></div>
                            </div>
                        </div>
                    </div>
                `;
                
                window.renderCompareChart = () => {
                    const selectedIds = Array.from(document.querySelectorAll('.compare-chk:checked')).map(cb => parseInt(cb.value));
                    const diffOnly = document.getElementById('diffOnly').checked;
                    const showAverages = document.getElementById('showAverages').checked;
                    const chartType = document.getElementById('chartType').value;
                    
                    if (selectedIds.length === 0) {
                        document.getElementById('compareChartContainer').innerHTML = `
                            <div style="text-align: center; padding: 40px; color: var(--text-light);">
                                <i class="fas fa-users-slash" style="font-size: 3rem; margin-bottom: 16px;"></i>
                                <p>Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² Ð´Ð»Ñ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ</p>
                            </div>
                        `;
                        document.getElementById('compareTableContainer').innerHTML = '';
                        return;
                    }
                    
                    const selectedUsers = team.filter(u => selectedIds.includes(u.id));
                    const skillsToShow = diffOnly 
                        ? skills.filter(skill => {
                            const ratings = selectedUsers.map(u => DB.getRating(u.id, skill.id)?.value || 0);
                            return new Set(ratings).size > 1;
                        })
                        : skills;
                    
                    // Render chart based on type
                    if (chartType === 'heatmap') {
                        renderHeatmap(selectedUsers, skillsToShow);
                    } else {
                        renderComparisonChart(selectedUsers, skillsToShow, chartType, showAverages);
                    }
                    
                    // Render table
                    renderComparisonTable(selectedUsers, skillsToShow);
                };
                
                const renderComparisonChart = (users, skillsToShow, type, showAverages) => {
                    const container = document.getElementById('compareChartContainer');
                    
                    // Prepare data
                    const datasets = users.map(user => ({
                        label: user.name,
                        data: skillsToShow.map(skill => DB.getRating(user.id, skill.id)?.value || 0),
                        borderColor: UI.getRandomColor(),
                        backgroundColor: type === 'bar' ? UI.getRandomColor().replace(')', ', 0.7)') : 'transparent',
                        tension: 0.4
                    }));
                    
                    if (showAverages && users.length > 1) {
                        const avgData = skillsToShow.map(skill => {
                            const sum = users.reduce((total, user) => total + (DB.getRating(user.id, skill.id)?.value || 0), 0);
                            return sum / users.length;
                        });
                        
                        datasets.push({
                            label: 'Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ Ð¿Ð¾ ÐºÐ¾Ð¼Ð°Ð½Ð´Ðµ',
                            data: avgData,
                            borderColor: '#000',
                            backgroundColor: 'transparent',
                            borderDash: [5, 5],
                            tension: 0.4
                        });
                    }
                    
                    const canvas = document.createElement('canvas');
                    container.innerHTML = '';
                    container.appendChild(canvas);
                    
                    new Chart(canvas.getContext('2d'), {
                        type: type,
                        data: {
                            labels: skillsToShow.map(s => s.name),
                            datasets: datasets
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: type === 'bar' ? {
                                y: {
                                    beginAtZero: true,
                                    max: 5
                                }
                            } : {},
                            plugins: {
                                legend: {
                                    position: 'top',
                                }
                            }
                        }
                    });
                };
                
                const renderHeatmap = (users, skillsToShow) => {
                    const container = document.getElementById('compareChartContainer');
                    
                    let html = `
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; min-width: 600px;">
                                <thead>
                                    <tr>
                                        <th style="padding: 12px; background: var(--bg-hover);">ÐÐ°Ð²Ñ‹Ðº</th>
                                        ${users.map(u => `<th style="padding: 12px; background: var(--bg-hover);">${u.name}</th>`).join('')}
                                        <th style="padding: 12px; background: var(--bg-hover);">Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    skillsToShow.forEach(skill => {
                        const ratings = users.map(u => DB.getRating(u.id, skill.id)?.value || 0);
                        const avg = ratings.reduce((a, b) => a + b, 0) / ratings.length;
                        
                        html += `<tr>
                            <td style="padding: 12px; border-bottom: 1px solid var(--border); font-weight: 600;">${skill.name}</td>
                            ${ratings.map(rating => {
                                let color;
                                if (rating >= 4) color = 'var(--success-light)';
                                else if (rating >= 3) color = 'var(--warning-light)';
                                else if (rating > 0) color = 'var(--danger-light)';
                                else color = 'var(--bg-hover)';
                                
                                return `<td style="padding: 12px; border-bottom: 1px solid var(--border); text-align: center; background: ${color}; font-weight: 600;">${rating || '-'}</td>`;
                            }).join('')}
                            <td style="padding: 12px; border-bottom: 1px solid var(--border); text-align: center; font-weight: 600;">${avg.toFixed(1)}</td>
                        </tr>`;
                    });
                    
                    html += `</tbody></table></div>`;
                    container.innerHTML = html;
                };
                
                const renderComparisonTable = (users, skillsToShow) => {
                    const container = document.getElementById('compareTableContainer');
                    
                    let html = `
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>ÐÐ°Ð²Ñ‹Ðº</th>
                                        ${users.map(u => `<th>${u.name}</th>`).join('')}
                                        <th>Ð Ð°Ð·Ð±Ñ€Ð¾Ñ</th>
                                        <th>Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    skillsToShow.forEach(skill => {
                        const ratings = users.map(u => DB.getRating(u.id, skill.id)?.value || 0);
                        const avg = ratings.reduce((a, b) => a + b, 0) / ratings.length;
                        const spread = Math.max(...ratings) - Math.min(...ratings);
                        
                        html += `<tr>
                            <td><strong>${skill.name}</strong></td>
                            ${ratings.map(rating => `
                                <td>
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="rating-input">
                                            ${[1,2,3,4,5].map(i => `
                                                <div class="star-btn ${i <= rating ? 'active' : ''} readonly"
                                                     style="width: 20px; height: 20px; font-size: 0.7rem;">
                                                    ${i}
                                                </div>
                                            `).join('')}
                                        </div>
                                        <span>${rating || '-'}</span>
                                    </div>
                                </td>
                            `).join('')}
                            <td>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(spread / 5) * 100}%"></div>
                                </div>
                                <small>${spread.toFixed(1)}</small>
                            </td>
                            <td><strong>${avg.toFixed(1)}</strong></td>
                        </tr>`;
                    });
                    
                    html += `</tbody></table></div>`;
                    container.innerHTML = html;
                };
                
                window.exportComparison = () => {
                    const selectedIds = Array.from(document.querySelectorAll('.compare-chk:checked')).map(cb => parseInt(cb.value));
                    if (selectedIds.length === 0) {
                        UI.toast('Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² Ð´Ð»Ñ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð°', 'warning');
                        return;
                    }
                    
                    const selectedUsers = team.filter(u => selectedIds.includes(u.id));
                    let csv = 'ÐÐ°Ð²Ñ‹Ðº,ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ,' + selectedUsers.map(u => u.name).join(',') + ',Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ\n';
                    
                    skills.forEach(skill => {
                        const ratings = selectedUsers.map(u => DB.getRating(u.id, skill.id)?.value || 0);
                        const avg = ratings.reduce((a, b) => a + b, 0) / ratings.length;
                        const category = DB.getCategories().find(c => c.id === skill.catId)?.name || '';
                        
                        csv += `"${skill.name}","${category}",${ratings.join(',')},${avg.toFixed(2)}\n`;
                    });
                    
                    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ_Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²_${new Date().toISOString().split('T')[0]}.csv`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    UI.toast('Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð² CSV', 'success');
                };
                
                // Initial render
                setTimeout(() => renderCompareChart(), 100);
                
                return this.wrapper(html, 'Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²');
            }
        }

        // 3.6 ENHANCED ADMIN SKILLS MANAGEMENT
        class AdminSkills extends DashboardLayout {
            render() {
                const categories = DB.getCategories();
                const skills = DB.getSkills();
                
                let html = `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-book"></i>
                                Ð¡Ð¿Ñ€Ð°Ð²Ð¾Ñ‡Ð½Ð¸Ðº ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary" onclick="addCategoryModal()">
                                    <i class="fas fa-plus"></i> ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ
                                </button>
                                <button class="btn btn-success" onclick="addSkillModal()">
                                    <i class="fas fa-plus"></i> ÐÐ°Ð²Ñ‹Ðº
                                </button>
                                <button class="btn btn-outline" onclick="importSkills()">
                                    <i class="fas fa-upload"></i> Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚
                                </button>
                                <button class="btn btn-outline" onclick="exportSkills()">
                                    <i class="fas fa-download"></i> Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                `;
                
                if (categories.length === 0) {
                    html += `
                        <div style="text-align: center; padding: 40px; color: var(--text-light);">
                            <i class="fas fa-book-open" style="font-size: 3rem; margin-bottom: 16px;"></i>
                            <p>ÐÐµÑ‚ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</p>
                            <button class="btn btn-primary mt-3" onclick="addCategoryModal()">
                                <i class="fas fa-plus"></i> Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿ÐµÑ€Ð²ÑƒÑŽ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ
                            </button>
                        </div>
                    `;
                } else {
                    html += `
                        <div class="tabs" id="skillTabs">
                            <div class="tab active" onclick="switchSkillTab('categories')">ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸</div>
                            <div class="tab" onclick="switchSkillTab('skills')">Ð’ÑÐµ Ð½Ð°Ð²Ñ‹ÐºÐ¸</div>
                            <div class="tab" onclick="switchSkillTab('matrix')">ÐœÐ°Ñ‚Ñ€Ð¸Ñ†Ð° Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</div>
                        </div>
                        <div id="skillTabContent"></div>
                    `;
                }
                
                html += `</div></div>`;
                
                // Global functions for skill management
                window.switchSkillTab = (tab) => {
                    const tabs = document.querySelectorAll('#skillTabs .tab');
                    tabs.forEach(t => t.classList.remove('active'));
                    event.target.classList.add('active');
                    
                    const container = document.getElementById('skillTabContent');
                    
                    if (tab === 'categories') {
                        this.renderCategoriesTab(container);
                    } else if (tab === 'skills') {
                        this.renderSkillsTab(container);
                    } else if (tab === 'matrix') {
                        this.renderMatrixTab(container);
                    }
                };
                
                this.renderCategoriesTab = (container) => {
                    const categories = DB.getCategories();
                    const skills = DB.getSkills();
                    
                    let html = '';
                    
                    categories.forEach(category => {
                        const categorySkills = skills.filter(s => s.catId === category.id);
                        const deptUsage = {};
                        
                        categorySkills.forEach(skill => {
                            skill.requiredFor.forEach(dept => {
                                deptUsage[dept] = (deptUsage[dept] || 0) + 1;
                            });
                        });
                        
                        const deptUsageStr = Object.entries(deptUsage)
                            .map(([dept, count]) => `${dept}: ${count}`)
                            .join(', ');
                        
                        html += `
                            <div class="card" style="margin-bottom: 16px;">
                                <div class="card-header" style="padding: 16px;">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="d-flex align-items-center gap-3">
                                            <div style="width: 40px; height: 40px; border-radius: var(--radius-md); background: ${category.color}; display: flex; align-items: center; justify-content: center;">
                                                <i class="fas ${category.icon}" style="color: white;"></i>
                                            </div>
                                            <div>
                                                <h4 style="margin: 0 0 4px 0;">${category.name}</h4>
                                                <p style="margin: 0; color: var(--text-sec); font-size: 0.9rem;">${category.description}</p>
                                            </div>
                                        </div>
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline" onclick="editCategoryModal('${category.id}')">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-danger" onclick="deleteCategory('${category.id}')">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body" style="padding: 16px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 16px;">
                                        <div>
                                            <span class="badge badge-primary">${categorySkills.length} Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</span>
                                            <span class="badge badge-info" style="margin-left: 8px;">Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð²: ${deptUsageStr || 'Ð½ÐµÑ‚'}</span>
                                        </div>
                                        <button class="btn btn-sm btn-primary" onclick="addSkillToCategory('${category.id}')">
                                            <i class="fas fa-plus"></i> Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½Ð°Ð²Ñ‹Ðº
                                        </button>
                                    </div>
                                    
                                    ${categorySkills.length > 0 ? `
                                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 12px;">
                                            ${categorySkills.map(skill => `
                                                <div style="background: var(--bg-hover); padding: 12px; border-radius: var(--radius-md);">
                                                    <div class="d-flex justify-content-between align-items-start mb-2">
                                                        <div>
                                                            <strong>${skill.name}</strong>
                                                            <div style="font-size: 0.85rem; color: var(--text-light);">Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ: ${skill.level}/5</div>
                                                        </div>
                                                        <div class="btn-group">
                                                            <button class="btn btn-sm btn-outline" onclick="editSkillModal('${skill.id}')">
                                                                <i class="fas fa-edit"></i>
                                                            </button>
                                                            <button class="btn btn-sm btn-outline" onclick="deleteSkill('${skill.id}')">
                                                                <i class="fas fa-trash"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                    ${skill.description ? `<p style="font-size: 0.9rem; margin-bottom: 8px;">${skill.description}</p>` : ''}
                                                    <div style="font-size: 0.85rem;">
                                                        <strong>Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ:</strong> ${skill.requiredFor.length > 0 ? skill.requiredFor.join(', ') : 'Ð½ÐµÑ‚'}
                                                    </div>
                                                    <div class="progress-bar" style="margin-top: 8px;">
                                                        <div class="progress-fill" style="width: ${(skill.level / 5) * 100}%"></div>
                                                    </div>
                                                </div>
                                            `).join('')}
                                        </div>
                                    ` : `
                                        <div style="text-align: center; padding: 20px; color: var(--text-light);">
                                            <p>Ð’ ÑÑ‚Ð¾Ð¹ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ ÐµÑ‰Ðµ Ð½ÐµÑ‚ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</p>
                                            <button class="btn btn-sm btn-primary" onclick="addSkillToCategory('${category.id}')">
                                                <i class="fas fa-plus"></i> Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð½Ð°Ð²Ñ‹Ðº
                                            </button>
                                        </div>
                                    `}
                                </div>
                            </div>
                        `;
                    });
                    
                    container.innerHTML = html;
                };
                
                this.renderSkillsTab = (container) => {
                    const skills = DB.getSkills();
                    const categories = DB.getCategories();
                    
                    let html = `
                        <div class="table-container">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>ÐÐ°Ð²Ñ‹Ðº</th>
                                        <th>ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ</th>
                                        <th>ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ</th>
                                        <th>Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ</th>
                                        <th>Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ</th>
                                        <th>Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    skills.forEach(skill => {
                        const category = categories.find(c => c.id === skill.catId);
                        
                        html += `
                            <tr>
                                <td><strong>${skill.name}</strong></td>
                                <td>
                                    <div class="d-flex align-items-center gap-2">
                                        <i class="fas ${category?.icon || 'fa-question'}" style="color: ${category?.color || '#64748b'}"></i>
                                        ${category?.name || 'Ð‘ÐµÐ· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸'}
                                    </div>
                                </td>
                                <td>${skill.description || '-'}</td>
                                <td>
                                    <div class="rating-input">
                                        ${[1,2,3,4,5].map(i => `
                                            <div class="star-btn ${i <= skill.level ? 'active' : ''} readonly"
                                                 style="width: 24px; height: 24px; font-size: 0.8rem;">
                                                ${i}
                                            </div>
                                        `).join('')}
                                    </div>
                                </td>
                                <td>
                                    ${skill.requiredFor.length > 0 
                                        ? skill.requiredFor.map(dept => `<span class="badge badge-info badge-sm">${dept}</span>`).join(' ') 
                                        : '-'}
                                </td>
                                <td>
                                    <div class="btn-group">
                                        <button class="btn btn-sm btn-outline" onclick="editSkillModal('${skill.id}')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline" onclick="deleteSkill('${skill.id}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                    });
                    
                    html += `</tbody></table></div>`;
                    container.innerHTML = html;
                };
                
                this.renderMatrixTab = (container) => {
                    const skills = DB.getSkills();
                    const categories = DB.getCategories();
                    const depts = CONFIG.depts;
                    
                    let html = `
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; min-width: 800px;">
                                <thead>
                                    <tr>
                                        <th style="padding: 12px; background: var(--bg-hover); position: sticky; left: 0;">ÐÐ°Ð²Ñ‹Ðº / ÐžÑ‚Ð´ÐµÐ»</th>
                                        ${depts.map(dept => `
                                            <th style="padding: 12px; background: var(--bg-hover); text-align: center;">${dept}</th>
                                        `).join('')}
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    skills.forEach(skill => {
                        const category = categories.find(c => c.id === skill.catId);
                        
                        html += `
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid var(--border); background: var(--bg-card); position: sticky; left: 0;">
                                    <div>
                                        <strong>${skill.name}</strong>
                                        <div style="font-size: 0.85rem; color: var(--text-light);">${category?.name || 'Ð‘ÐµÐ· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸'}</div>
                                    </div>
                                </td>
                                ${depts.map(dept => {
                                    const isRequired = skill.requiredFor.includes(dept);
                                    return `
                                        <td style="padding: 12px; border-bottom: 1px solid var(--border); text-align: center; background: ${isRequired ? 'var(--warning-light)' : 'var(--bg-hover)'};">
                                            ${isRequired ? 
                                                '<i class="fas fa-check text-warning" data-tooltip="ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹"></i>' : 
                                                '<i class="fas fa-minus text-light"></i>'}
                                        </td>
                                    `;
                                }).join('')}
                            </tr>
                        `;
                    });
                    
                    // Add summary row
                    html += `
                        <tr>
                            <td style="padding: 12px; background: var(--bg-hover); position: sticky; left: 0; font-weight: 600;">Ð˜Ñ‚Ð¾Ð³Ð¾ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ…</td>
                            ${depts.map(dept => {
                                const requiredCount = skills.filter(s => s.requiredFor.includes(dept)).length;
                                return `<td style="padding: 12px; text-align: center; background: var(--bg-hover); font-weight: 600;">${requiredCount}</td>`;
                            }).join('')}
                        </tr>
                    `;
                    
                    html += `</tbody></table></div>`;
                    container.innerHTML = html;
                };
                
                window.addCategoryModal = () => {
                    UI.modal({
                        title: 'ÐÐ¾Ð²Ð°Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²',
                        size: 'md',
                        content: `
                            <div class="form-group">
                                <label class="form-label required">ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸</label>
                                <input class="form-control" id="categoryName" placeholder="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Frontend Ñ‚ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¸">
                            </div>
                            <div class="form-group">
                                <label class="form-label required">Ð˜ÐºÐ¾Ð½ÐºÐ° (FontAwesome)</label>
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 8px;">
                                    ${['fa-code', 'fa-server', 'fa-paint-brush', 'fa-database', 'fa-cloud', 'fa-brain', 'fa-mobile-alt', 'fa-shield-alt'].map(icon => `
                                        <label class="form-check" style="text-align: center; padding: 8px; border: 2px solid var(--border); border-radius: var(--radius-md); cursor: pointer;">
                                            <input type="radio" name="categoryIcon" value="${icon}" class="form-check-input" style="display: none;">
                                            <div style="font-size: 1.5rem; margin-bottom: 4px;"><i class="fas ${icon}"></i></div>
                                            <div style="font-size: 0.8rem;">${icon.replace('fa-', '')}</div>
                                        </label>
                                    `).join('')}
                                </div>
                                <input class="form-control" id="categoryIconCustom" placeholder="Ð˜Ð»Ð¸ Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÑÐ²Ð¾Ð¹ ÐºÐ»Ð°ÑÑ Ð¸ÐºÐ¾Ð½ÐºÐ¸">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ð¦Ð²ÐµÑ‚ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸</label>
                                <input class="form-control" type="color" id="categoryColor" value="#6366f1">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ</label>
                                <textarea class="form-control" id="categoryDescription" rows="3" placeholder="ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸..."></textarea>
                            </div>
                        `,
                        onConfirm: () => {
                            const name = document.getElementById('categoryName').value.trim();
                            const icon = document.querySelector('input[name="categoryIcon"]:checked')?.value || 
                                        document.getElementById('categoryIconCustom').value.trim();
                            const color = document.getElementById('categoryColor').value;
                            const description = document.getElementById('categoryDescription').value.trim();
                            
                            if (!name) {
                                UI.toast('Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸', 'error');
                                return false;
                            }
                            
                            if (!icon) {
                                UI.toast('Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¸Ð»Ð¸ Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¸ÐºÐ¾Ð½ÐºÑƒ', 'error');
                                return false;
                            }
                            
                            DB.addCategory(name, icon, color, description);
                            UI.toast('ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð°', 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                window.editCategoryModal = (categoryId) => {
                    const category = DB.getCategoryById(categoryId);
                    if (!category) return;
                    
                    UI.modal({
                        title: 'Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸',
                        size: 'md',
                        content: `
                            <div class="form-group">
                                <label class="form-label required">ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸</label>
                                <input class="form-control" id="editCategoryName" value="${category.name}">
                            </div>
                            <div class="form-group">
                                <label class="form-label required">Ð˜ÐºÐ¾Ð½ÐºÐ°</label>
                                <input class="form-control" id="editCategoryIcon" value="${category.icon}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ð¦Ð²ÐµÑ‚ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸</label>
                                <input class="form-control" type="color" id="editCategoryColor" value="${category.color || '#6366f1'}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ</label>
                                <textarea class="form-control" id="editCategoryDescription" rows="3">${category.description || ''}</textarea>
                            </div>
                        `,
                        onConfirm: () => {
                            const name = document.getElementById('editCategoryName').value.trim();
                            const icon = document.getElementById('editCategoryIcon').value.trim();
                            const color = document.getElementById('editCategoryColor').value;
                            const description = document.getElementById('editCategoryDescription').value.trim();
                            
                            if (!name || !icon) {
                                UI.toast('Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ', 'error');
                                return false;
                            }
                            
                            DB.updateCategory(categoryId, { name, icon, color, description });
                            UI.toast('ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð°', 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                window.deleteCategory = (categoryId) => {
                    const category = DB.getCategoryById(categoryId);
                    if (!category) return;
                    
                    // Check if category has skills
                    const skillsInCategory = DB.getSkills().filter(s => s.catId === categoryId);
                    
                    if (skillsInCategory.length > 0) {
                        UI.confirm({
                            title: 'Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸',
                            message: `ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ "${category.name}" ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ ${skillsInCategory.length} Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð². Ð’ÑÐµ Ð½Ð°Ð²Ñ‹ÐºÐ¸ Ð±ÑƒÐ´ÑƒÑ‚ Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ñ‹ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ "Ð‘ÐµÐ· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸". ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ?`,
                            type: 'warning'
                        }).then(confirmed => {
                            if (confirmed) {
                                // Move skills to uncategorized
                                skillsInCategory.forEach(skill => {
                                    DB.updateSkill(skill.id, { catId: '' });
                                });
                                
                                DB.deleteCategory(categoryId);
                                UI.toast('ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ ÑƒÐ´Ð°Ð»ÐµÐ½Ð°', 'success');
                                App.render();
                            }
                        });
                    } else {
                        UI.confirm({
                            title: 'Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸',
                            message: `Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ "${category.name}"?`,
                            type: 'danger'
                        }).then(confirmed => {
                            if (confirmed) {
                                DB.deleteCategory(categoryId);
                                UI.toast('ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ ÑƒÐ´Ð°Ð»ÐµÐ½Ð°', 'success');
                                App.render();
                            }
                        });
                    }
                };
                
                window.addSkillModal = (categoryId = '') => {
                    const categories = DB.getCategories();
                    
                    UI.modal({
                        title: 'ÐÐ¾Ð²Ñ‹Ð¹ Ð½Ð°Ð²Ñ‹Ðº',
                        size: 'lg',
                        content: `
                            <div class="form-group">
                                <label class="form-label required">ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ°</label>
                                <input class="form-control" id="skillName" placeholder="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: React.js">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ</label>
                                <textarea class="form-control" id="skillDescription" rows="3" placeholder="ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ð¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ°..."></textarea>
                            </div>
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ</label>
                                    <select class="form-control" id="skillCategory">
                                        <option value="">Ð‘ÐµÐ· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸</option>
                                        ${categories.map(c => `<option value="${c.id}" ${c.id === categoryId ? 'selected' : ''}>${c.name}</option>`).join('')}
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸</label>
                                    <select class="form-control" id="skillLevel">
                                        ${[1,2,3,4,5].map(i => `<option value="${i}" ${i === 3 ? 'selected' : ''}>${CONFIG.skillLevels[i-1]} (${i}/5)</option>`).join('')}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð¾Ñ‚Ð´ÐµÐ»Ð¾Ð²</label>
                                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 8px;">
                                    ${CONFIG.depts.map(dept => `
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" value="${dept}">
                                            <span class="form-check-label">${dept}</span>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>
                        `,
                        onConfirm: () => {
                            const name = document.getElementById('skillName').value.trim();
                            const description = document.getElementById('skillDescription').value.trim();
                            const catId = document.getElementById('skillCategory').value;
                            const level = parseInt(document.getElementById('skillLevel').value);
                            
                            const requiredFor = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
                            
                            if (!name) {
                                UI.toast('Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ°', 'error');
                                return false;
                            }
                            
                            DB.addSkill(name, catId, description, requiredFor, level);
                            UI.toast('ÐÐ°Ð²Ñ‹Ðº ÑÐ¾Ð·Ð´Ð°Ð½', 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                window.addSkillToCategory = (categoryId) => {
                    window.addSkillModal(categoryId);
                };
                
                window.editSkillModal = (skillId) => {
                    const skill = DB.getSkillById(skillId);
                    if (!skill) return;
                    
                    const categories = DB.getCategories();
                    
                    UI.modal({
                        title: 'Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ°',
                        size: 'lg',
                        content: `
                            <div class="form-group">
                                <label class="form-label required">ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ°</label>
                                <input class="form-control" id="editSkillName" value="${skill.name}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ</label>
                                <textarea class="form-control" id="editSkillDescription" rows="3">${skill.description || ''}</textarea>
                            </div>
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ</label>
                                    <select class="form-control" id="editSkillCategory">
                                        <option value="">Ð‘ÐµÐ· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸</option>
                                        ${categories.map(c => `<option value="${c.id}" ${c.id === skill.catId ? 'selected' : ''}>${c.name}</option>`).join('')}
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸</label>
                                    <select class="form-control" id="editSkillLevel">
                                        ${[1,2,3,4,5].map(i => `<option value="${i}" ${i === skill.level ? 'selected' : ''}>${CONFIG.skillLevels[i-1]} (${i}/5)</option>`).join('')}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð¾Ñ‚Ð´ÐµÐ»Ð¾Ð²</label>
                                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 8px;">
                                    ${CONFIG.depts.map(dept => `
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" value="${dept}" ${skill.requiredFor.includes(dept) ? 'checked' : ''}>
                                            <span class="form-check-label">${dept}</span>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>
                        `,
                        onConfirm: () => {
                            const name = document.getElementById('editSkillName').value.trim();
                            const description = document.getElementById('editSkillDescription').value.trim();
                            const catId = document.getElementById('editSkillCategory').value;
                            const level = parseInt(document.getElementById('editSkillLevel').value);
                            
                            const requiredFor = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
                            
                            if (!name) {
                                UI.toast('Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ°', 'error');
                                return false;
                            }
                            
                            DB.updateSkill(skillId, { name, description, catId, level, requiredFor });
                            UI.toast('ÐÐ°Ð²Ñ‹Ðº Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½', 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                window.deleteSkill = (skillId) => {
                    const skill = DB.getSkillById(skillId);
                    if (!skill) return;
                    
                    UI.confirm({
                        title: 'Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ°',
                        message: `Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð½Ð°Ð²Ñ‹Ðº "${skill.name}"? Ð’ÑÐµ Ð¾Ñ†ÐµÐ½ÐºÐ¸ ÑÑ‚Ð¾Ð³Ð¾ Ð½Ð°Ð²Ñ‹ÐºÐ° Ñ‚Ð°ÐºÐ¶Ðµ Ð±ÑƒÐ´ÑƒÑ‚ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹.`,
                        type: 'danger'
                    }).then(confirmed => {
                        if (confirmed) {
                            DB.deleteSkill(skillId);
                            UI.toast('ÐÐ°Ð²Ñ‹Ðº ÑƒÐ´Ð°Ð»ÐµÐ½', 'success');
                            App.render();
                        }
                    });
                };
                
                window.importSkills = () => {
                    UI.modal({
                        title: 'Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²',
                        size: 'md',
                        content: `
                            <div class="form-group">
                                <label class="form-label">Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ JSON Ñ„Ð°Ð¹Ð»</label>
                                <div class="file-upload" onclick="document.getElementById('jsonFile').click()">
                                    <i class="fas fa-file-upload"></i>
                                    <p>ÐŸÐµÑ€ÐµÑ‚Ð°Ñ‰Ð¸Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð¸Ð»Ð¸ Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð°</p>
                                    <small>ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ JSON Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚</small>
                                    <input type="file" id="jsonFile" accept=".json" style="display: none;">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ð˜Ð»Ð¸ Ð²ÑÑ‚Ð°Ð²ÑŒÑ‚Ðµ JSON Ð´Ð°Ð½Ð½Ñ‹Ðµ</label>
                                <textarea class="form-control" id="jsonData" rows="8" placeholder='{"categories": [...], "skills": [...]}'></textarea>
                            </div>
                        `,
                        onConfirm: () => {
                            const jsonData = document.getElementById('jsonData').value.trim();
                            let data;
                            
                            try {
                                if (jsonData) {
                                    data = JSON.parse(jsonData);
                                } else {
                                    const fileInput = document.getElementById('jsonFile');
                                    if (!fileInput.files.length) {
                                        UI.toast('Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð¸Ð»Ð¸ Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ', 'error');
                                        return false;
                                    }
                                    
                                    const file = fileInput.files[0];
                                    const reader = new FileReader();
                                    
                                    reader.onload = function(e) {
                                        try {
                                            const importedData = JSON.parse(e.target.result);
                                            if (DB.importData(JSON.stringify(importedData))) {
                                                UI.toast('Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹', 'success');
                                                setTimeout(() => location.reload(), 1000);
                                            } else {
                                                UI.toast('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…', 'error');
                                            }
                                        } catch (err) {
                                            UI.toast('ÐžÑˆÐ¸Ð±ÐºÐ° Ñ‡Ñ‚ÐµÐ½Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð°', 'error');
                                        }
                                    };
                                    
                                    reader.readAsText(file);
                                    return true;
                                }
                            } catch (err) {
                                UI.toast('ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ JSON', 'error');
                                return false;
                            }
                            
                            if (DB.importData(JSON.stringify(data))) {
                                UI.toast('Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹', 'success');
                                setTimeout(() => location.reload(), 1000);
                                return true;
                            } else {
                                UI.toast('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…', 'error');
                                return false;
                            }
                        }
                    });
                };
                
                window.exportSkills = () => {
                    const data = DB.exportData();
                    const blob = new Blob([data], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `skills_export_${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    UI.toast('Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð² JSON', 'success');
                };
                
                // Initial render
                setTimeout(() => {
                    const container = document.getElementById('skillTabContent');
                    if (container) {
                        this.renderCategoriesTab(container);
                    }
                }, 100);
                
                return this.wrapper(html, 'Ð¡Ð¿Ñ€Ð°Ð²Ð¾Ñ‡Ð½Ð¸Ðº ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹');
            }
        }

        // 3.7 ENHANCED ADMIN USERS MANAGEMENT WITH EDITING
        class AdminUsers extends DashboardLayout {
            render() {
                const users = DB.getAllUsers();
                
                // Statistics
                const totalUsers = users.length;
                const activeUsers = users.filter(u => u.status === 'active').length;
                const employees = users.filter(u => u.role === 'employee').length;
                const managers = users.filter(u => u.role === 'manager').length;
                
                let html = `
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon primary">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${totalUsers}</div>
                                <div class="stat-label">Ð’ÑÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon success">
                                <i class="fas fa-user-check"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${activeUsers}</div>
                                <div class="stat-label">ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ…</div>
                                <div class="stat-change positive">${((activeUsers / totalUsers) * 100).toFixed(0)}%</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon warning">
                                <i class="fas fa-user-tie"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${employees}</div>
                                <div class="stat-label">Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon info">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${managers}</div>
                                <div class="stat-label">ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð²</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-id-card"></i>
                                Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»Ð¾Ð¼
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary" onclick="addUserModal()">
                                    <i class="fas fa-user-plus"></i> Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ
                                </button>
                                <button class="btn btn-outline" onclick="exportUsers()">
                                    <i class="fas fa-download"></i> Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚
                                </button>
                                ${this.user.role === 'admin' ? `
                                    <button class="btn btn-danger" onclick="resetDatabase()">
                                        <i class="fas fa-trash-restore"></i> Ð¡Ð±Ñ€Ð¾Ñ Ð‘Ð”
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº</th>
                                            <th>ÐžÑ‚Ð´ÐµÐ»</th>
                                            <th>Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ</th>
                                            <th>Ð Ð¾Ð»ÑŒ</th>
                                            <th>Ð¡Ñ‚Ð°Ñ‚ÑƒÑ</th>
                                            <th>Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${users.map(user => {
                                            const ratings = DB.getUserRatings(user.id);
                                            const approvedRatings = ratings.filter(r => r.status === 'approved');
                                            const avgRating = approvedRatings.length > 0 
                                                ? approvedRatings.reduce((sum, r) => sum + r.value, 0) / approvedRatings.length 
                                                : 0;
                                            
                                            return `
                                                <tr onclick="viewUserDetails(${user.id})" style="cursor: pointer;">
                                                    <td>${user.id}</td>
                                                    <td>
                                                        <div class="d-flex align-items-center gap-3">
                                                            <div class="avatar ${user.status === 'active' ? 'online' : ''}" 
                                                                 style="width: 36px; height: 36px; font-size: 0.9rem;">
                                                                ${user.avatar}
                                                            </div>
                                                            <div>
                                                                <div style="font-weight: 600;">${user.name}</div>
                                                                <div style="font-size: 0.85rem; color: var(--text-light);">${user.email}</div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <span class="badge badge-info">${user.dept}</span>
                                                    </td>
                                                    <td>${user.position}</td>
                                                    <td>
                                                        <span class="badge badge-${user.role === 'admin' ? 'danger' : user.role === 'manager' ? 'warning' : 'success'}">
                                                            ${user.role}
                                                        </span>
                                                    </td>
                                                    <td>
                                                        <span class="badge badge-${user.status === 'active' ? 'success' : 'secondary'}">
                                                            ${user.status === 'active' ? 'ÐÐºÑ‚Ð¸Ð²ÐµÐ½' : 'ÐÐµÐ°ÐºÑ‚Ð¸Ð²ÐµÐ½'}
                                                        </span>
                                                    </td>
                                                    <td>
                                                        <div class="table-actions">
                                                            <button class="btn btn-sm btn-outline" onclick="event.stopPropagation(); editUserModal(${user.id})">
                                                                <i class="fas fa-edit"></i>
                                                            </button>
                                                            <button class="btn btn-sm btn-danger" onclick="event.stopPropagation(); deleteUser(${user.id})" 
                                                                    ${user.id === this.user.id ? 'disabled style="opacity: 0.5;"' : ''}>
                                                                <i class="fas fa-trash"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            `;
                                        }).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
                
                // User management functions
                window.addUserModal = () => {
                    UI.modal({
                        title: 'Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ',
                        size: 'lg',
                        content: `
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð¤Ð˜Ðž</label>
                                    <input class="form-control" id="newUserName" placeholder="Ð˜Ð²Ð°Ð½Ð¾Ð² Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²Ð¸Ñ‡">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð›Ð¾Ð³Ð¸Ð½</label>
                                    <input class="form-control" id="newUserLogin" placeholder="ivanov">
                                </div>
                            </div>
                            
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Email</label>
                                    <input class="form-control" type="email" id="newUserEmail" placeholder="ivanov@company.com">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">ÐŸÐ°Ñ€Ð¾Ð»ÑŒ</label>
                                    <input class="form-control" type="password" id="newUserPassword" value="123">
                                    <small class="form-text">ÐŸÐ¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ: 123</small>
                                </div>
                            </div>
                            
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">ÐžÑ‚Ð´ÐµÐ»</label>
                                    <select class="form-control" id="newUserDept">
                                        ${CONFIG.depts.map(dept => `<option value="${dept}">${dept}</option>`).join('')}
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ</label>
                                    <select class="form-control" id="newUserPosition">
                                        ${CONFIG.positions.map(pos => `<option value="${pos}">${pos}</option>`).join('')}
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð Ð¾Ð»ÑŒ</label>
                                    <select class="form-control" id="newUserRole">
                                        <option value="employee">Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº</option>
                                        <option value="manager">ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€</option>
                                        <option value="hr">HR</option>
                                        <option value="admin">ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€</option>
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð¡Ñ‚Ð°Ñ‚ÑƒÑ</label>
                                    <select class="form-control" id="newUserStatus">
                                        <option value="active">ÐÐºÑ‚Ð¸Ð²ÐµÐ½</option>
                                        <option value="inactive">ÐÐµÐ°ÐºÑ‚Ð¸Ð²ÐµÐ½</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Ðž ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐµ</label>
                                <textarea class="form-control" id="newUserBio" rows="3" placeholder="ÐžÐ¿Ñ‹Ñ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹, Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ðµ, Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÑ‹..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Ð”Ð°Ñ‚Ð° Ð¿Ñ€Ð¸ÐµÐ¼Ð°</label>
                                <input class="form-control" type="date" id="newUserHireDate" value="${new Date().toISOString().split('T')[0]}">
                            </div>
                        `,
                        onConfirm: () => {
                            const name = document.getElementById('newUserName').value.trim();
                            const login = document.getElementById('newUserLogin').value.trim();
                            const email = document.getElementById('newUserEmail').value.trim();
                            const password = document.getElementById('newUserPassword').value;
                            const dept = document.getElementById('newUserDept').value;
                            const position = document.getElementById('newUserPosition').value;
                            const role = document.getElementById('newUserRole').value;
                            const status = document.getElementById('newUserStatus').value;
                            const bio = document.getElementById('newUserBio').value.trim();
                            const hireDate = document.getElementById('newUserHireDate').value;
                            
                            if (!name || !login || !email || !password || !dept || !position) {
                                UI.toast('Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð²ÑÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ', 'error');
                                return false;
                            }
                            
                            // Check if login already exists
                            if (DB.state.users.some(u => u.login === login)) {
                                UI.toast('ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ Ñ‚Ð°ÐºÐ¸Ð¼ Ð»Ð¾Ð³Ð¸Ð½Ð¾Ð¼ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚', 'error');
                                return false;
                            }
                            
                            const newUser = DB.createUser({
                                name,
                                login,
                                email,
                                password,
                                dept,
                                position,
                                role,
                                status,
                                bio,
                                hireDate
                            });
                            
                            UI.toast(`ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ${name} ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑÐ¾Ð·Ð´Ð°Ð½`, 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                window.editUserModal = (userId) => {
                    const user = DB.getUserById(userId);
                    if (!user) return;
                    
                    UI.modal({
                        title: 'Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ',
                        size: 'lg',
                        content: `
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð¤Ð˜Ðž</label>
                                    <input class="form-control" id="editUserName" value="${user.name}">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð›Ð¾Ð³Ð¸Ð½</label>
                                    <input class="form-control" id="editUserLogin" value="${user.login}">
                                </div>
                            </div>
                            
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Email</label>
                                    <input class="form-control" type="email" id="editUserEmail" value="${user.email}">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label">ÐÐ¾Ð²Ñ‹Ð¹ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ</label>
                                    <input class="form-control" type="password" id="editUserPassword" placeholder="ÐžÑÑ‚Ð°Ð²ÑŒÑ‚Ðµ Ð¿ÑƒÑÑ‚Ñ‹Ð¼, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ Ð¼ÐµÐ½ÑÑ‚ÑŒ">
                                </div>
                            </div>
                            
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">ÐžÑ‚Ð´ÐµÐ»</label>
                                    <select class="form-control" id="editUserDept">
                                        ${CONFIG.depts.map(dept => `<option value="${dept}" ${dept === user.dept ? 'selected' : ''}>${dept}</option>`).join('')}
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ</label>
                                    <input class="form-control" id="editUserPosition" value="${user.position}">
                                </div>
                            </div>
                            
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð Ð¾Ð»ÑŒ</label>
                                    <select class="form-control" id="editUserRole">
                                        <option value="employee" ${user.role === 'employee' ? 'selected' : ''}>Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº</option>
                                        <option value="manager" ${user.role === 'manager' ? 'selected' : ''}>ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€</option>
                                        <option value="hr" ${user.role === 'hr' ? 'selected' : ''}>HR</option>
                                        <option value="admin" ${user.role === 'admin' ? 'selected' : ''}>ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€</option>
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð¡Ñ‚Ð°Ñ‚ÑƒÑ</label>
                                    <select class="form-control" id="editUserStatus">
                                        <option value="active" ${user.status === 'active' ? 'selected' : ''}>ÐÐºÑ‚Ð¸Ð²ÐµÐ½</option>
                                        <option value="inactive" ${user.status === 'inactive' ? 'selected' : ''}>ÐÐµÐ°ÐºÑ‚Ð¸Ð²ÐµÐ½</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Ðž ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐµ</label>
                                <textarea class="form-control" id="editUserBio" rows="3">${user.bio || ''}</textarea>
                            </div>
                            
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label">Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½</label>
                                    <input class="form-control" id="editUserPhone" value="${user.phone || ''}">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label">Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð°</label>
                                    <input class="form-control" type="number" id="editUserSalary" value="${user.salary || 0}">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Ð”Ð°Ñ‚Ð° Ð¿Ñ€Ð¸ÐµÐ¼Ð°</label>
                                <input class="form-control" type="date" id="editUserHireDate" value="${user.hireDate || ''}">
                            </div>
                        `,
                        onConfirm: () => {
                            const name = document.getElementById('editUserName').value.trim();
                            const login = document.getElementById('editUserLogin').value.trim();
                            const email = document.getElementById('editUserEmail').value.trim();
                            const password = document.getElementById('editUserPassword').value;
                            const dept = document.getElementById('editUserDept').value;
                            const position = document.getElementById('editUserPosition').value.trim();
                            const role = document.getElementById('editUserRole').value;
                            const status = document.getElementById('editUserStatus').value;
                            const bio = document.getElementById('editUserBio').value.trim();
                            const phone = document.getElementById('editUserPhone').value.trim();
                            const salary = parseInt(document.getElementById('editUserSalary').value) || 0;
                            const hireDate = document.getElementById('editUserHireDate').value;
                            
                            if (!name || !login || !email || !dept || !position) {
                                UI.toast('Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð²ÑÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ', 'error');
                                return false;
                            }
                            
                            // Check if login changed and already exists
                            if (login !== user.login && DB.state.users.some(u => u.login === login && u.id !== userId)) {
                                UI.toast('ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ Ñ‚Ð°ÐºÐ¸Ð¼ Ð»Ð¾Ð³Ð¸Ð½Ð¾Ð¼ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚', 'error');
                                return false;
                            }
                            
                            const updates = {
                                name,
                                login,
                                email,
                                dept,
                                position,
                                role,
                                status,
                                bio,
                                phone,
                                salary,
                                hireDate
                            };
                            
                            // Only update password if provided
                            if (password) {
                                updates.password = password;
                            }
                            
                            DB.updateUser(userId, updates);
                            UI.toast('Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹', 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                window.viewUserDetails = (userId) => {
                    const user = DB.getUserById(userId);
                    if (!user) return;
                    
                    const ratings = DB.getUserRatings(userId);
                    const approvedRatings = ratings.filter(r => r.status === 'approved');
                    const avgRating = approvedRatings.length > 0 
                        ? approvedRatings.reduce((sum, r) => sum + r.value, 0) / approvedRatings.length 
                        : 0;
                    
                    const goals = DB.getUserGoals(userId);
                    const activeGoals = goals.filter(g => g.status !== 'completed').length;
                    
                    const content = `
                        <div class="row" style="display: flex; gap: 32px;">
                            <div style="flex: 1;">
                                <div style="text-align: center; margin-bottom: 24px;">
                                    <div class="avatar" style="width: 80px; height: 80px; font-size: 1.5rem; margin: 0 auto 16px;">
                                        ${user.avatar}
                                    </div>
                                    <h3>${user.name}</h3>
                                    <p class="text-muted">${user.position} â€¢ ${user.dept}</p>
                                </div>
                                
                                <div style="background: var(--bg-hover); padding: 20px; border-radius: var(--radius-md); margin-bottom: 20px;">
                                    <h4 style="margin-bottom: 16px; font-size: 1.1rem;">Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ</h4>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>Email</span>
                                        <strong>${user.email}</strong>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½</span>
                                        <strong>${user.phone || 'ÐÐµ ÑƒÐºÐ°Ð·Ð°Ð½'}</strong>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>Ð Ð¾Ð»ÑŒ</span>
                                        <span class="badge badge-${user.role === 'admin' ? 'danger' : user.role === 'manager' ? 'warning' : 'success'}">
                                            ${user.role}
                                        </span>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>Ð¡Ñ‚Ð°Ñ‚ÑƒÑ</span>
                                        <span class="badge badge-${user.status === 'active' ? 'success' : 'secondary'}">
                                            ${user.status === 'active' ? 'ÐÐºÑ‚Ð¸Ð²ÐµÐ½' : 'ÐÐµÐ°ÐºÑ‚Ð¸Ð²ÐµÐ½'}
                                        </span>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>Ð’ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸ Ñ</span>
                                        <strong>${UI.formatDate(user.hireDate)}</strong>
                                    </div>
                                    ${user.salary ? `
                                        <div class="d-flex justify-content-between">
                                            <span>Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð°</span>
                                            <strong>${user.salary.toLocaleString()} â‚½</strong>
                                        </div>
                                    ` : ''}
                                </div>
                                
                                ${user.bio ? `
                                    <div>
                                        <h4 style="margin-bottom: 8px; font-size: 1.1rem;">Ðž ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐµ</h4>
                                        <p>${user.bio}</p>
                                    </div>
                                ` : ''}
                            </div>
                            
                            <div style="flex: 1;">
                                <div style="background: var(--bg-hover); padding: 20px; border-radius: var(--radius-md); margin-bottom: 20px;">
                                    <h4 style="margin-bottom: 16px; font-size: 1.1rem;">Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°</h4>
                                    <div class="d-flex justify-content-between mb-3">
                                        <div style="text-align: center;">
                                            <div style="font-size: 2rem; font-weight: 800; color: var(--primary);">${avgRating.toFixed(1)}</div>
                                            <div style="font-size: 0.9rem; color: var(--text-sec);">Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 2rem; font-weight: 800; color: var(--success);">${approvedRatings.length}</div>
                                            <div style="font-size: 0.9rem; color: var(--text-sec);">ÐžÑ†ÐµÐ½ÐµÐ½Ð¾ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="font-size: 2rem; font-weight: 800; color: var(--warning);">${activeGoals}</div>
                                            <div style="font-size: 0.9rem; color: var(--text-sec);">ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ†ÐµÐ»ÐµÐ¹</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <h4 style="margin-bottom: 16px; font-size: 1.1rem;">ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ Ð¾Ñ†ÐµÐ½ÐºÐ¸</h4>
                                    ${ratings.length > 0 ? 
                                        ratings.slice(0, 5).map(rating => {
                                            const skill = DB.getSkillById(rating.skillId);
                                            if (!skill) return '';
                                            
                                            return `
                                                <div style="background: var(--bg-card); padding: 12px; border-radius: var(--radius-md); margin-bottom: 8px; border: 1px solid var(--border);">
                                                    <div class="d-flex justify-content-between align-items-center">
                                                        <div>
                                                            <strong>${skill.name}</strong>
                                                            <div style="font-size: 0.85rem; color: var(--text-light);">
                                                                ${UI.formatDate(rating.date)} â€¢ 
                                                                <span class="badge badge-${CONFIG.statuses[rating.status].color} badge-sm">
                                                                    ${CONFIG.statuses[rating.status].text}
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="rating-input">
                                                            ${[1,2,3,4,5].map(i => `
                                                                <div class="star-btn ${i <= rating.value ? 'active' : ''} readonly"
                                                                     style="width: 24px; height: 24px; font-size: 0.8rem;">
                                                                    ${i}
                                                                </div>
                                                            `).join('')}
                                                        </div>
                                                    </div>
                                                </div>
                                            `;
                                        }).join('') : 
                                        '<p style="text-align: center; color: var(--text-light); padding: 20px;">ÐÐµÑ‚ Ð¾Ñ†ÐµÐ½Ð¾Ðº</p>'
                                    }
                                </div>
                            </div>
                        </div>
                    `;
                    
                    UI.modal({
                        title: `Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ: ${user.name}`,
                        size: 'xl',
                        content,
                        showConfirm: false,
                        cancelText: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ'
                    });
                };
                
                window.deleteUser = (userId) => {
                    const user = DB.getUserById(userId);
                    if (!user) return;
                    
                    if (userId === this.user.id) {
                        UI.toast('ÐÐµÐ»ÑŒÐ·Ñ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÐ²Ð¾Ð¹ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚', 'error');
                        return;
                    }
                    
                    UI.confirm({
                        title: 'Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ',
                        message: `Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ ${user.name}? Ð’ÑÐµ ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ (Ð¾Ñ†ÐµÐ½ÐºÐ¸, Ñ†ÐµÐ»Ð¸, Ð¾Ñ‚Ð·Ñ‹Ð²Ñ‹) Ñ‚Ð°ÐºÐ¶Ðµ Ð±ÑƒÐ´ÑƒÑ‚ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹.`,
                        type: 'danger'
                    }).then(confirmed => {
                        if (confirmed) {
                            try {
                                DB.deleteUser(userId);
                                UI.toast('ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑƒÐ´Ð°Ð»ÐµÐ½', 'success');
                                App.render();
                            } catch (error) {
                                UI.toast(error.message, 'error');
                            }
                        }
                    });
                };
                
                window.exportUsers = () => {
                    const users = DB.getAllUsers();
                    let csv = 'ID,Ð¤Ð˜Ðž,Email,ÐžÑ‚Ð´ÐµÐ»,Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ,Ð Ð¾Ð»ÑŒ,Ð¡Ñ‚Ð°Ñ‚ÑƒÑ,Ð”Ð°Ñ‚Ð° Ð¿Ñ€Ð¸ÐµÐ¼Ð°,Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½\n';
                    
                    users.forEach(user => {
                        csv += `${user.id},"${user.name}","${user.email}","${user.dept}","${user.position}","${user.role}","${user.status}","${user.hireDate}","${user.phone || ''}"\n`;
                    });
                    
                    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `users_export_${new Date().toISOString().split('T')[0]}.csv`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    UI.toast('Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹', 'success');
                };
                
                window.resetDatabase = () => {
                    UI.confirm({
                        title: 'Ð¡Ð±Ñ€Ð¾Ñ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…',
                        message: 'Ð’ÐÐ˜ÐœÐÐÐ˜Ð•: Ð’ÑÐµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð±ÑƒÐ´ÑƒÑ‚ ÑÐ±Ñ€Ð¾ÑˆÐµÐ½Ñ‹ Ðº Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ñ‹Ð¼ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÑÐ¼. Ð­Ñ‚Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð½ÐµÐ»ÑŒÐ·Ñ Ð¾Ñ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ. ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ?',
                        type: 'danger',
                        confirmText: 'Ð¡Ð±Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ',
                        cancelText: 'ÐžÑ‚Ð¼ÐµÐ½Ð°'
                    }).then(confirmed => {
                        if (confirmed) {
                            DB.resetDatabase();
                        }
                    });
                };
                
                return this.wrapper(html, 'Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»Ð¾Ð¼');
            }
        }

        // 3.8 ENHANCED REPORTS VIEW
        class AdminReports extends DashboardLayout {
            render() {
                const companyStats = DB.getCompanyStats();
                
                let html = `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-chart-pie"></i>
                                ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð¸ Ð¾Ñ‚Ñ‡ÐµÑ‚Ñ‹
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary" onclick="generateOverallReport()">
                                    <i class="fas fa-file-alt"></i> ÐžÐ±Ñ‰Ð¸Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚
                                </button>
                                <button class="btn btn-success" onclick="exportAllData()">
                                    <i class="fas fa-download"></i> Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð²ÑÐµÑ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon primary">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <div class="stat-info">
                                        <div class="stat-value">${companyStats.totalUsers}</div>
                                        <div class="stat-label">Ð’ÑÐµÐ³Ð¾ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²</div>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon success">
                                        <i class="fas fa-star"></i>
                                    </div>
                                    <div class="stat-info">
                                        <div class="stat-value">${companyStats.averageRating.toFixed(1)}</div>
                                        <div class="stat-label">Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð» Ð¿Ð¾ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸</div>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon warning">
                                        <i class="fas fa-clipboard-check"></i>
                                    </div>
                                    <div class="stat-info">
                                        <div class="stat-value">${companyStats.pendingRatings}</div>
                                        <div class="stat-label">ÐžÑ†ÐµÐ½Ð¾Ðº Ð½Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ</div>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon danger">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div class="stat-info">
                                        <div class="stat-value">${companyStats.approvedRatings}</div>
                                        <div class="stat-label">ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð½Ñ‹Ñ… Ð¾Ñ†ÐµÐ½Ð¾Ðº</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 24px; margin-top: 32px;">
                                <div>
                                    <h3 style="margin-bottom: 16px;">Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ Ð¾Ñ‚Ð´ÐµÐ»Ð°Ð¼</h3>
                                    <canvas id="deptChart" height="200"></canvas>
                                </div>
                                <div>
                                    <h3 style="margin-bottom: 16px;">Ð¡Ñ‚Ð°Ñ‚ÑƒÑÑ‹ Ð¾Ñ†ÐµÐ½Ð¾Ðº</h3>
                                    <canvas id="statusChart" height="200"></canvas>
                                </div>
                            </div>
                            
                            <div style="margin-top: 32px;">
                                <h3 style="margin-bottom: 16px;">ÐžÑ‚Ñ‡ÐµÑ‚Ñ‹</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                                    <div class="card" style="cursor: pointer;" onclick="generateSkillGapReport()">
                                        <div class="card-body" style="text-align: center;">
                                            <i class="fas fa-chart-bar" style="font-size: 2.5rem; color: var(--primary); margin-bottom: 16px;"></i>
                                            <h4 style="margin-bottom: 8px;">ÐÐ½Ð°Ð»Ð¸Ð· Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð¾Ð² Ð² Ð½Ð°Ð²Ñ‹ÐºÐ°Ñ…</h4>
                                            <p style="color: var(--text-sec); font-size: 0.9rem;">Ð’Ñ‹ÑÐ²Ð¸Ñ‚Ðµ Ð½ÐµÐ´Ð¾ÑÑ‚Ð°ÑŽÑ‰Ð¸Ðµ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¸ Ð² Ð¾Ñ‚Ð´ÐµÐ»Ð°Ñ…</p>
                                        </div>
                                    </div>
                                    
                                    <div class="card" style="cursor: pointer;" onclick="generateTopPerformersReport()">
                                        <div class="card-body" style="text-align: center;">
                                            <i class="fas fa-trophy" style="font-size: 2.5rem; color: var(--warning); margin-bottom: 16px;"></i>
                                            <h4 style="margin-bottom: 8px;">Ð¢Ð¾Ð¿-Ð¸ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»Ð¸</h4>
                                            <p style="color: var(--text-sec); font-size: 0.9rem;">Ð›ÑƒÑ‡ÑˆÐ¸Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¸ Ð¿Ð¾ Ð¾Ñ†ÐµÐ½ÐºÐ°Ð¼ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹</p>
                                        </div>
                                    </div>
                                    
                                    <div class="card" style="cursor: pointer;" onclick="generateTrainingNeedsReport()">
                                        <div class="card-body" style="text-align: center;">
                                            <i class="fas fa-graduation-cap" style="font-size: 2.5rem; color: var(--success); margin-bottom: 16px;"></i>
                                            <h4 style="margin-bottom: 8px;">ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð½Ð¾ÑÑ‚Ð¸ Ð² Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ð¸</h4>
                                            <p style="color: var(--text-sec); font-size: 0.9rem;">Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð°Ð¼ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 32px;">
                                <h3 style="margin-bottom: 16px;">Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚</h3>
                                <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                    <button class="btn btn-outline" onclick="exportSkillsCSV()">
                                        <i class="fas fa-database"></i> ÐÐ°Ð²Ñ‹ÐºÐ¸ (CSV)
                                    </button>
                                    <button class="btn btn-outline" onclick="exportUsersCSV()">
                                        <i class="fas fa-users"></i> ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ (CSV)
                                    </button>
                                    <button class="btn btn-outline" onclick="exportRatingsCSV()">
                                        <i class="fas fa-star"></i> ÐžÑ†ÐµÐ½ÐºÐ¸ (CSV)
                                    </button>
                                    <button class="btn btn-outline" onclick="exportGoalsCSV()">
                                        <i class="fas fa-bullseye"></i> Ð¦ÐµÐ»Ð¸ (CSV)
                                    </button>
                                    <button class="btn btn-outline" onclick="exportFullJSON()">
                                        <i class="fas fa-file-code"></i> Ð’ÑÐµ Ð´Ð°Ð½Ð½Ñ‹Ðµ (JSON)
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Chart rendering
                window.generateOverallReport = () => {
                    const content = `
                        <div style="max-width: 800px; margin: 0 auto;">
                            <div style="text-align: center; margin-bottom: 32px;">
                                <h2>ÐžÑ‚Ñ‡ÐµÑ‚ Ð¿Ð¾ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸ÑÐ¼</h2>
                                <p>Ð”Ð°Ñ‚Ð° Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸: ${new Date().toLocaleDateString('ru-RU')}</p>
                            </div>
                            
                            <div style="background: var(--bg-hover); padding: 24px; border-radius: var(--radius-lg); margin-bottom: 24px;">
                                <h3 style="margin-bottom: 16px;">ÐžÐ±Ñ‰Ð°Ñ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°</h3>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;">
                                    <div>
                                        <strong>Ð’ÑÐµÐ³Ð¾ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²:</strong> ${companyStats.totalUsers}
                                    </div>
                                    <div>
                                        <strong>Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»:</strong> ${companyStats.averageRating.toFixed(2)}
                                    </div>
                                    <div>
                                        <strong>ÐžÑ†ÐµÐ½ÐµÐ½Ð¾ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²:</strong> ${companyStats.totalRatings}
                                    </div>
                                    <div>
                                        <strong>ÐÐ° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ:</strong> ${companyStats.pendingRatings}
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <h3 style="margin-bottom: 16px;">Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¿Ð¾ Ð¾Ñ‚Ð´ÐµÐ»Ð°Ð¼</h3>
                                <div style="overflow-x: auto;">
                                    <table style="width: 100%; border-collapse: collapse;">
                                        <thead>
                                            <tr>
                                                <th style="padding: 12px; background: var(--bg-hover);">ÐžÑ‚Ð´ÐµÐ»</th>
                                                <th style="padding: 12px; background: var(--bg-hover);">Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²</th>
                                                <th style="padding: 12px; background: var(--bg-hover);">Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</th>
                                                <th style="padding: 12px; background: var(--bg-hover);">ÐžÑ†ÐµÐ½Ð¾Ðº</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${Object.entries(companyStats.departmentStats).map(([dept, stats]) => `
                                                <tr>
                                                    <td style="padding: 12px; border-bottom: 1px solid var(--border);">${dept}</td>
                                                    <td style="padding: 12px; border-bottom: 1px solid var(--border); text-align: center;">${stats.totalUsers}</td>
                                                    <td style="padding: 12px; border-bottom: 1px solid var(--border); text-align: center;">${stats.averageRating.toFixed(2)}</td>
                                                    <td style="padding: 12px; border-bottom: 1px solid var(--border); text-align: center;">${stats.totalRatings}</td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div style="margin-top: 32px; text-align: center; color: var(--text-light);">
                                <p>ÐžÑ‚Ñ‡ÐµÑ‚ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð² SkillMatrix PRO</p>
                            </div>
                        </div>
                    `;
                    
                    const modal = UI.modal({
                        title: 'ÐžÐ±Ñ‰Ð¸Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚',
                        size: 'xl',
                        content,
                        showConfirm: false,
                        cancelText: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ',
                        onCancel: () => {
                            // Print option
                            if (confirm('Ð Ð°ÑÐ¿ÐµÑ‡Ð°Ñ‚Ð°Ñ‚ÑŒ Ð¾Ñ‚Ñ‡ÐµÑ‚?')) {
                                const printWindow = window.open('', '_blank');
                                printWindow.document.write(`
                                    <html>
                                        <head>
                                            <title>ÐžÑ‚Ñ‡ÐµÑ‚ SkillMatrix PRO</title>
                                            <style>
                                                body { font-family: Arial, sans-serif; padding: 20px; }
                                                h2 { color: #333; }
                                                table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                                                th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
                                                th { background-color: #f5f5f5; }
                                            </style>
                                        </head>
                                        <body>
                                            ${content}
                                        </body>
                                    </html>
                                `);
                                printWindow.document.close();
                                printWindow.print();
                            }
                        }
                    });
                };
                
                window.exportAllData = () => {
                    const data = DB.exportData();
                    const blob = new Blob([data], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `skillmatrix_full_export_${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    UI.toast('Ð’ÑÐµ Ð´Ð°Ð½Ð½Ñ‹Ðµ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð² JSON', 'success');
                };
                
                window.exportSkillsCSV = () => {
                    const skills = DB.getSkills();
                    const categories = DB.getCategories();
                    
                    let csv = 'ID,ÐÐ°Ð²Ñ‹Ðº,ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ,ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ,Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ,Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ\n';
                    skills.forEach(skill => {
                        const category = categories.find(c => c.id === skill.catId);
                        csv += `${skill.id},"${skill.name}","${category?.name || ''}","${skill.description || ''}",${skill.level},"${skill.requiredFor.join(', ')}"\n`;
                    });
                    
                    downloadCSV(csv, 'skills');
                };
                
                window.exportUsersCSV = () => {
                    const users = DB.getAllUsers();
                    let csv = 'ID,Ð¤Ð˜Ðž,Email,ÐžÑ‚Ð´ÐµÐ»,Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ,Ð Ð¾Ð»ÑŒ,Ð¡Ñ‚Ð°Ñ‚ÑƒÑ,Ð”Ð°Ñ‚Ð° Ð¿Ñ€Ð¸ÐµÐ¼Ð°,Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½,Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð°\n';
                    users.forEach(user => {
                        csv += `${user.id},"${user.name}","${user.email}","${user.dept}","${user.position}","${user.role}","${user.status}","${user.hireDate}","${user.phone || ''}",${user.salary || 0}\n`;
                    });
                    
                    downloadCSV(csv, 'users');
                };
                
                window.exportRatingsCSV = () => {
                    const ratings = DB.state.ratings;
                    const users = DB.getAllUsers();
                    const skills = DB.getSkills();
                    
                    let csv = 'ID Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ,ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ,ID Ð½Ð°Ð²Ñ‹ÐºÐ°,ÐÐ°Ð²Ñ‹Ðº,ÐžÑ†ÐµÐ½ÐºÐ°,Ð¡Ñ‚Ð°Ñ‚ÑƒÑ,Ð”Ð°Ñ‚Ð°,ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹\n';
                    ratings.forEach(rating => {
                        const user = users.find(u => u.id === rating.userId);
                        const skill = skills.find(s => s.id === rating.skillId);
                        csv += `${rating.userId},"${user?.name || ''}",${rating.skillId},"${skill?.name || ''}",${rating.value},${rating.status},${rating.date},"${rating.comment || ''}"\n`;
                    });
                    
                    downloadCSV(csv, 'ratings');
                };
                
                window.exportGoalsCSV = () => {
                    const goals = DB.state.goals;
                    const users = DB.getAllUsers();
                    
                    let csv = 'ID,ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ,Ð¦ÐµÐ»ÑŒ,ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ,Ð¡Ñ‚Ð°Ñ‚ÑƒÑ,ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ%,ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚,Ð”ÐµÐ´Ð»Ð°Ð¹Ð½\n';
                    goals.forEach(goal => {
                        const user = users.find(u => u.id === goal.userId);
                        csv += `${goal.id},"${user?.name || ''}","${goal.title}","${goal.description || ''}",${goal.status},${goal.progress},${goal.priority},${goal.deadline}\n`;
                    });
                    
                    downloadCSV(csv, 'goals');
                };
                
                window.exportFullJSON = () => {
                    exportAllData();
                };
                
                window.generateSkillGapReport = () => {
                    const skills = DB.getSkills();
                    const depts = CONFIG.depts;
                    
                    let content = '<h3>ÐÐ½Ð°Ð»Ð¸Ð· Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð¾Ð² Ð² Ð½Ð°Ð²Ñ‹ÐºÐ°Ñ… Ð¿Ð¾ Ð¾Ñ‚Ð´ÐµÐ»Ð°Ð¼</h3>';
                    
                    depts.forEach(dept => {
                        const requiredSkills = skills.filter(s => s.requiredFor.includes(dept));
                        const deptUsers = DB.state.users.filter(u => u.dept === dept && u.role === 'employee');
                        
                        if (requiredSkills.length === 0 || deptUsers.length === 0) return;
                        
                        content += `
                            <div style="margin-bottom: 24px;">
                                <h4>${dept} (${deptUsers.length} ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²)</h4>
                                <table style="width: 100%; border-collapse: collapse; margin-bottom: 12px;">
                                    <thead>
                                        <tr>
                                            <th style="padding: 8px; background: var(--bg-hover);">ÐÐ°Ð²Ñ‹Ðº</th>
                                            <th style="padding: 8px; background: var(--bg-hover);">Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ</th>
                                            <th style="padding: 8px; background: var(--bg-hover);">Ð˜Ð¼ÐµÐµÑ‚ÑÑ</th>
                                            <th style="padding: 8px; background: var(--bg-hover);">ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ</th>
                                            <th style="padding: 8px; background: var(--bg-hover);">Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;
                        
                        requiredSkills.forEach(skill => {
                            const skillRatings = deptUsers.map(user => DB.getRating(user.id, skill.id)).filter(Boolean);
                            const avgRating = skillRatings.length > 0 
                                ? skillRatings.reduce((sum, r) => sum + r.value, 0) / skillRatings.length 
                                : 0;
                            
                            const coverage = (skillRatings.length / deptUsers.length) * 100;
                            
                            content += `
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid var(--border);">${skill.name}</td>
                                    <td style="padding: 8px; border-bottom: 1px solid var(--border); text-align: center;">Ð”Ð°</td>
                                    <td style="padding: 8px; border-bottom: 1px solid var(--border); text-align: center;">${skillRatings.length} Ñ‡ÐµÐ».</td>
                                    <td style="padding: 8px; border-bottom: 1px solid var(--border); text-align: center;">${coverage.toFixed(0)}%</td>
                                    <td style="padding: 8px; border-bottom: 1px solid var(--border); text-align: center;">${avgRating.toFixed(1)}</td>
                                </tr>
                            `;
                        });
                        
                        content += `</tbody></table></div>`;
                    });
                    
                    UI.modal({
                        title: 'ÐÐ½Ð°Ð»Ð¸Ð· Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð¾Ð² Ð² Ð½Ð°Ð²Ñ‹ÐºÐ°Ñ…',
                        size: 'xl',
                        content,
                        showConfirm: false,
                        cancelText: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ'
                    });
                };
                
                window.generateTopPerformersReport = () => {
                    const users = DB.state.users.filter(u => u.role === 'employee');
                    const performers = users.map(user => {
                        const ratings = DB.getUserRatings(user.id).filter(r => r.status === 'approved');
                        const avgRating = ratings.length > 0 
                            ? ratings.reduce((sum, r) => sum + r.value, 0) / ratings.length 
                            : 0;
                        
                        return { user, avgRating, ratedSkills: ratings.length };
                    }).filter(p => p.ratedSkills >= 3) // At least 3 rated skills
                      .sort((a, b) => b.avgRating - a.avgRating)
                      .slice(0, 10);
                    
                    let content = `
                        <h3>Ð¢Ð¾Ð¿-10 Ð¸ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÐµÐ¹ Ð¿Ð¾ Ð¾Ñ†ÐµÐ½ÐºÐ°Ð¼ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                            <thead>
                                <tr>
                                    <th style="padding: 12px; background: var(--bg-hover);">#</th>
                                    <th style="padding: 12px; background: var(--bg-hover);">Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº</th>
                                    <th style="padding: 12px; background: var(--bg-hover);">ÐžÑ‚Ð´ÐµÐ»</th>
                                    <th style="padding: 12px; background: var(--bg-hover);">Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ</th>
                                    <th style="padding: 12px; background: var(--bg-hover);">Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</th>
                                    <th style="padding: 12px; background: var(--bg-hover);">ÐžÑ†ÐµÐ½ÐµÐ½Ð¾ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    performers.forEach((p, index) => {
                        content += `
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid var(--border); text-align: center; font-weight: 600;">${index + 1}</td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--border);">
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="avatar" style="width: 30px; height: 30px; font-size: 0.8rem;">${p.user.avatar}</div>
                                        ${p.user.name}
                                    </div>
                                </td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--border);">${p.user.dept}</td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--border);">${p.user.position}</td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--border); text-align: center; font-weight: 600;">${p.avgRating.toFixed(2)}</td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--border); text-align: center;">${p.ratedSkills}</td>
                            </tr>
                        `;
                    });
                    
                    content += `</tbody></table>`;
                    
                    UI.modal({
                        title: 'Ð¢Ð¾Ð¿-Ð¸ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»Ð¸',
                        size: 'xl',
                        content,
                        showConfirm: false,
                        cancelText: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ'
                    });
                };
                
                window.generateTrainingNeedsReport = () => {
                    const skills = DB.getSkills();
                    const depts = CONFIG.depts;
                    
                    let content = '<h3>Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð°Ð¼ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ</h3>';
                    
                    depts.forEach(dept => {
                        const requiredSkills = skills.filter(s => s.requiredFor.includes(dept));
                        const deptUsers = DB.state.users.filter(u => u.dept === dept && u.role === 'employee');
                        
                        if (requiredSkills.length === 0 || deptUsers.length === 0) return;
                        
                        const skillGaps = requiredSkills.map(skill => {
                            const skillRatings = deptUsers.map(user => DB.getRating(user.id, skill.id)).filter(Boolean);
                            const avgRating = skillRatings.length > 0 
                                ? skillRatings.reduce((sum, r) => sum + r.value, 0) / skillRatings.length 
                                : 0;
                            
                            const coverage = (skillRatings.length / deptUsers.length) * 100;
                            
                            return { skill, avgRating, coverage, needsTraining: avgRating < 3 || coverage < 50 };
                        }).filter(sg => sg.needsTraining);
                        
                        if (skillGaps.length === 0) return;
                        
                        content += `
                            <div style="margin-bottom: 24px;">
                                <h4>${dept} - ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ð½Ñ‹Ðµ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ</h4>
                                <table style="width: 100%; border-collapse: collapse; margin-bottom: 12px;">
                                    <thead>
                                        <tr>
                                            <th style="padding: 8px; background: var(--bg-hover);">ÐÐ°Ð²Ñ‹Ðº</th>
                                            <th style="padding: 8px; background: var(--bg-hover);">Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</th>
                                            <th style="padding: 8px; background: var(--bg-hover);">ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ</th>
                                            <th style="padding: 8px; background: var(--bg-hover);">Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;
                        
                        skillGaps.forEach(sg => {
                            const recommendation = sg.avgRating < 3 ? 'Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ ÐºÑƒÑ€Ñ' : 'ÐŸÑ€Ð¾Ð´Ð²Ð¸Ð½ÑƒÑ‚Ñ‹Ð¹ ÐºÑƒÑ€Ñ';
                            content += `
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid var(--border);">${sg.skill.name}</td>
                                    <td style="padding: 8px; border-bottom: 1px solid var(--border); text-align: center;">${sg.avgRating.toFixed(1)}</td>
                                    <td style="padding: 8px; border-bottom: 1px solid var(--border); text-align: center;">${sg.coverage.toFixed(0)}%</td>
                                    <td style="padding: 8px; border-bottom: 1px solid var(--border);">
                                        <span class="badge badge-warning">${recommendation}</span>
                                    </td>
                                </tr>
                            `;
                        });
                        
                        content += `</tbody></table></div>`;
                    });
                    
                    UI.modal({
                        title: 'ÐŸÐ¾Ñ‚Ñ€ÐµÐ±Ð½Ð¾ÑÑ‚Ð¸ Ð² Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ð¸',
                        size: 'xl',
                        content,
                        showConfirm: false,
                        cancelText: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ'
                    });
                };
                
                function downloadCSV(csv, filename) {
                    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${filename}_${new Date().toISOString().split('T')[0]}.csv`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    UI.toast(`Ð¤Ð°Ð¹Ð» ${filename}.csv ÑÐºÐ°Ñ‡Ð°Ð½`, 'success');
                }
                
                return this.wrapper(html, 'ÐžÑ‚Ñ‡ÐµÑ‚Ñ‹ Ð¸ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ°');
            }
            
            postRender() {
                // Render department distribution chart
                const deptCtx = document.getElementById('deptChart')?.getContext('2d');
                if (deptCtx) {
                    const users = DB.getAllUsers();
                    const deptCounts = {};
                    
                    CONFIG.depts.forEach(dept => {
                        deptCounts[dept] = users.filter(u => u.dept === dept).length;
                    });
                    
                    new Chart(deptCtx, {
                        type: 'bar',
                        data: {
                            labels: CONFIG.depts,
                            datasets: [{
                                label: 'ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²',
                                data: CONFIG.depts.map(dept => deptCounts[dept]),
                                backgroundColor: [
                                    'rgba(99, 102, 241, 0.7)',
                                    'rgba(16, 185, 129, 0.7)',
                                    'rgba(245, 158, 11, 0.7)',
                                    'rgba(239, 68, 68, 0.7)',
                                    'rgba(139, 92, 246, 0.7)',
                                    'rgba(6, 182, 212, 0.7)',
                                    'rgba(236, 72, 153, 0.7)'
                                ],
                                borderColor: [
                                    'rgb(99, 102, 241)',
                                    'rgb(16, 185, 129)',
                                    'rgb(245, 158, 11)',
                                    'rgb(239, 68, 68)',
                                    'rgb(139, 92, 246)',
                                    'rgb(6, 182, 212)',
                                    'rgb(236, 72, 153)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                }
                
                // Render ratings status chart
                const statusCtx = document.getElementById('statusChart')?.getContext('2d');
                if (statusCtx) {
                    const ratings = DB.state.ratings;
                    const statusCounts = {
                        approved: ratings.filter(r => r.status === 'approved').length,
                        pending: ratings.filter(r => r.status === 'pending').length,
                        rejected: ratings.filter(r => r.status === 'rejected').length
                    };
                    
                    new Chart(statusCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¾', 'ÐÐ° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ', 'ÐžÑ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¾'],
                            datasets: [{
                                data: [statusCounts.approved, statusCounts.pending, statusCounts.rejected],
                                backgroundColor: [
                                    'rgba(16, 185, 129, 0.7)',
                                    'rgba(245, 158, 11, 0.7)',
                                    'rgba(239, 68, 68, 0.7)'
                                ],
                                borderColor: [
                                    'rgb(16, 185, 129)',
                                    'rgb(245, 158, 11)',
                                    'rgb(239, 68, 68)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }
            }
        }

        // 3.9 NOTIFICATIONS VIEW
        class NotificationsView extends DashboardLayout {
            render() {
                const notifications = DB.getUserNotifications(this.user.id);
                const unreadCount = DB.getUnreadNotificationCount(this.user.id);
                
                let html = `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-bell"></i>
                                Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ
                                ${unreadCount > 0 ? `<span class="badge badge-danger" style="margin-left: 12px;">${unreadCount} Ð½ÐµÐ¿Ñ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð½Ð½Ñ‹Ñ…</span>` : ''}
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-outline" onclick="markAllAsRead()" ${unreadCount === 0 ? 'disabled' : ''}>
                                    <i class="fas fa-check-double"></i> ÐŸÑ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ Ð²ÑÐµ
                                </button>
                                <button class="btn btn-outline" onclick="clearAllNotifications()" ${notifications.length === 0 ? 'disabled' : ''}>
                                    <i class="fas fa-trash"></i> ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ Ð²ÑÐµ
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                `;
                
                if (notifications.length === 0) {
                    html += `
                        <div style="text-align: center; padding: 60px; color: var(--text-light);">
                            <i class="fas fa-bell-slash" style="font-size: 3rem; margin-bottom: 16px;"></i>
                            <h3 style="margin-bottom: 8px;">ÐÐµÑ‚ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹</h3>
                            <p>Ð—Ð´ÐµÑÑŒ Ð±ÑƒÐ´ÑƒÑ‚ Ð¿Ð¾ÑÐ²Ð»ÑÑ‚ÑŒÑÑ Ð²Ð°Ð¶Ð½Ñ‹Ðµ Ð¾Ð¿Ð¾Ð²ÐµÑ‰ÐµÐ½Ð¸Ñ</p>
                        </div>
                    `;
                } else {
                    html += `
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            ${notifications.map(notification => {
                                const icon = notification.type === 'success' ? 'fa-check-circle' :
                                            notification.type === 'error' ? 'fa-exclamation-circle' :
                                            notification.type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle';
                                
                                const iconColor = notification.type === 'success' ? 'var(--success)' :
                                                notification.type === 'error' ? 'var(--danger)' :
                                                notification.type === 'warning' ? 'var(--warning)' : 'var(--info)';
                                
                                return `
                                    <div class="card ${notification.read ? '' : 'animate__animated animate__pulse'}" 
                                         style="margin: 0; border-left: 4px solid ${iconColor}; ${!notification.read ? 'background: var(--primary-light); opacity: 0.9;' : ''}">
                                        <div class="card-body" style="padding: 16px;">
                                            <div class="d-flex justify-content-between align-items-start">
                                                <div class="d-flex gap-3" style="flex: 1;">
                                                    <div style="color: ${iconColor}; font-size: 1.2rem;">
                                                        <i class="fas ${icon}"></i>
                                                    </div>
                                                    <div style="flex: 1;">
                                                        <h4 style="margin: 0 0 4px 0; font-size: 1rem;">${notification.title}</h4>
                                                        <p style="margin: 0; color: var(--text-sec); font-size: 0.9rem;">${notification.message}</p>
                                                        <div style="font-size: 0.8rem; color: var(--text-light); margin-top: 8px;">
                                                            ${UI.formatDate(notification.date, 'datetime')}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="btn-group">
                                                    ${!notification.read ? `
                                                        <button class="btn btn-sm btn-outline" onclick="markAsRead('${notification.id}')" title="ÐžÑ‚Ð¼ÐµÑ‚Ð¸Ñ‚ÑŒ ÐºÐ°Ðº Ð¿Ñ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð½Ð½Ð¾Ðµ">
                                                            <i class="fas fa-check"></i>
                                                        </button>
                                                    ` : ''}
                                                    <button class="btn btn-sm btn-outline" onclick="deleteNotification('${notification.id}')" title="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                }
                
                html += `</div></div>`;
                
                window.markAsRead = (notificationId) => {
                    DB.markNotificationAsRead(notificationId);
                    UI.toast('Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð½Ð¾', 'success');
                    App.render();
                };
                
                window.markAllAsRead = () => {
                    DB.markAllNotificationsAsRead(this.user.id);
                    UI.toast('Ð’ÑÐµ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð½Ñ‹', 'success');
                    App.render();
                };
                
                window.deleteNotification = (notificationId) => {
                    DB.deleteNotification(notificationId);
                    UI.toast('Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¾', 'success');
                    App.render();
                };
                
                window.clearAllNotifications = () => {
                    UI.confirm({
                        title: 'ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹',
                        message: 'Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²ÑÐµ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ?',
                        type: 'warning'
                    }).then(confirmed => {
                        if (confirmed) {
                            DB.state.notifications = DB.state.notifications.filter(n => n.userId !== this.user.id);
                            DB.save();
                            UI.toast('Ð’ÑÐµ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹', 'success');
                            App.render();
                        }
                    });
                };
                
                return this.wrapper(html, 'Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ');
            }
        }

        // 3.10 SETTINGS VIEW
        class SettingsView extends DashboardLayout {
            render() {
                const prefs = Session.preferences;
                
                let html = `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-cog"></i>
                                ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="max-width: 600px; margin: 0 auto;">
                                <h3 style="margin-bottom: 24px;">ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹</h3>
                                
                                <div class="form-group">
                                    <label class="form-label">Ð¢ÐµÐ¼Ð° Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ñ</label>
                                    <div style="display: flex; gap: 12px;">
                                        <label class="form-check" style="flex: 1;">
                                            <input type="radio" name="theme" value="light" class="form-check-input" ${prefs.theme === 'light' ? 'checked' : ''} onchange="updateTheme('light')">
                                            <div style="padding: 16px; border: 2px solid ${prefs.theme === 'light' ? 'var(--primary)' : 'var(--border)'}; border-radius: var(--radius-md); text-align: center; cursor: pointer;">
                                                <i class="fas fa-sun" style="font-size: 1.5rem; margin-bottom: 8px; color: #f59e0b;"></i>
                                                <div>Ð¡Ð²ÐµÑ‚Ð»Ð°Ñ</div>
                                            </div>
                                        </label>
                                        <label class="form-check" style="flex: 1;">
                                            <input type="radio" name="theme" value="dark" class="form-check-input" ${prefs.theme === 'dark' ? 'checked' : ''} onchange="updateTheme('dark')">
                                            <div style="padding: 16px; border: 2px solid ${prefs.theme === 'dark' ? 'var(--primary)' : 'var(--border)'}; border-radius: var(--radius-md); text-align: center; cursor: pointer;">
                                                <i class="fas fa-moon" style="font-size: 1.5rem; margin-bottom: 8px; color: #64748b;"></i>
                                                <div>Ð¢ÐµÐ¼Ð½Ð°Ñ</div>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹</label>
                                    <div style="background: var(--bg-hover); padding: 16px; border-radius: var(--radius-md);">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" id="notifyRatings" checked>
                                            <span class="form-check-label">Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÑÑ‚ÑŒ Ð¾ Ð½Ð¾Ð²Ñ‹Ñ… Ð¾Ñ†ÐµÐ½ÐºÐ°Ñ…</span>
                                        </label>
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" id="notifyGoals" checked>
                                            <span class="form-check-label">Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÑÑ‚ÑŒ Ð¾Ð± Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¸ Ñ†ÐµÐ»ÐµÐ¹</span>
                                        </label>
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" id="notifyFeedback" checked>
                                            <span class="form-check-label">Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÑÑ‚ÑŒ Ð¾ Ð½Ð¾Ð²Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾Ð¹ ÑÐ²ÑÐ·Ð¸</span>
                                        </label>
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" id="notifyEvents" checked>
                                            <span class="form-check-label">Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÑÑ‚ÑŒ Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸ÑÑ…</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð±Ð¾ÐºÐ¾Ð²Ð¾Ð¹ Ð¿Ð°Ð½ÐµÐ»Ð¸</label>
                                    <div style="background: var(--bg-hover); padding: 16px; border-radius: var(--radius-md);">
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" id="sidebarCollapsed" ${prefs.sidebarCollapsed ? 'checked' : ''} onchange="updateSidebarPref()">
                                            <span class="form-check-label">Ð¡Ð²ÐµÑ€Ð½ÑƒÑ‚Ð°Ñ Ð±Ð¾ÐºÐ¾Ð²Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ</span>
                                        </label>
                                        <small class="form-text">ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ ÑÐ²Ð¾Ñ€Ð°Ñ‡Ð¸Ð²Ð°Ñ‚ÑŒ Ð±Ð¾ÐºÐ¾Ð²ÑƒÑŽ Ð¿Ð°Ð½ÐµÐ»ÑŒ</small>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…</label>
                                    <div style="background: var(--bg-hover); padding: 16px; border-radius: var(--radius-md);">
                                        <p style="margin-bottom: 12px;">Ð’Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²ÑÐµ Ð²Ð°ÑˆÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ JSON Ð´Ð»Ñ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ.</p>
                                        <button class="btn btn-outline" onclick="exportMyData()">
                                            <i class="fas fa-download"></i> Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð¼Ð¾Ð¸Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Ðž ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ</label>
                                    <div style="background: var(--bg-hover); padding: 16px; border-radius: var(--radius-md);">
                                        <h4 style="margin-bottom: 8px;">SkillMatrix PRO v3.0</h4>
                                        <p style="margin-bottom: 8px;">Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð¾Ñ†ÐµÐ½ÐºÐ¸ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾ÐºÐ¾Ð»ÐµÐ½Ð¸Ñ</p>
                                        <div style="font-size: 0.9rem; color: var(--text-light);">
                                            <div>Ð’ÐµÑ€ÑÐ¸Ñ: 3.0.0</div>
                                            <div>Ð”Ð°Ñ‚Ð° ÑÐ±Ð¾Ñ€ÐºÐ¸: ${new Date().toLocaleDateString('ru-RU')}</div>
                                            <div>Â© 2024 SkillMatrix Enterprise</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid var(--border);">
                                    <button class="btn btn-danger" onclick="showDebugInfo()">
                                        <i class="fas fa-bug"></i> ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                window.updateTheme = (theme) => {
                    Session.updatePreferences({ theme });
                    UI.toast(`Ð¢ÐµÐ¼Ð° Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð° Ð½Ð° ${theme === 'light' ? 'ÑÐ²ÐµÑ‚Ð»ÑƒÑŽ' : 'Ñ‚ÐµÐ¼Ð½ÑƒÑŽ'}`, 'success');
                };
                
                window.updateSidebarPref = () => {
                    const collapsed = document.getElementById('sidebarCollapsed').checked;
                    Session.updatePreferences({ sidebarCollapsed: collapsed });
                    UI.toast('ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ñ‹', 'success');
                    setTimeout(() => App.render(), 300);
                };
                
                window.exportMyData = () => {
                    const userData = {
                        user: this.user,
                        ratings: DB.getUserRatings(this.user.id),
                        goals: DB.getUserGoals(this.user.id),
                        notifications: DB.getUserNotifications(this.user.id),
                        feedback: DB.getFeedbackForUser(this.user.id),
                        exportDate: new Date().toISOString()
                    };
                    
                    const dataStr = JSON.stringify(userData, null, 2);
                    const blob = new Blob([dataStr], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `mydata_${this.user.login}_${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    UI.toast('Ð’Ð°ÑˆÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹', 'success');
                };
                
                window.showDebugInfo = () => {
                    const debugInfo = {
                        user: this.user,
                        preferences: Session.preferences,
                        localStorageSize: JSON.stringify(localStorage).length,
                        sessionStorageSize: JSON.stringify(sessionStorage).length,
                        totalUsers: DB.getAllUsers().length,
                        totalSkills: DB.getSkills().length,
                        totalRatings: DB.state.ratings.length,
                        browser: navigator.userAgent,
                        screen: `${window.screen.width}x${window.screen.height}`,
                        timestamp: new Date().toISOString()
                    };
                    
                    UI.modal({
                        title: 'ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ',
                        size: 'lg',
                        content: `
                            <div style="font-family: monospace; font-size: 0.9rem;">
                                <pre style="background: var(--bg-hover); padding: 16px; border-radius: var(--radius-md); overflow: auto; max-height: 400px;">
${JSON.stringify(debugInfo, null, 2)}
                                </pre>
                            </div>
                        `,
                        showConfirm: false,
                        cancelText: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ'
                    });
                };
                
                return this.wrapper(html, 'ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸');
            }
        }

        // 3.11 MAIN DASHBOARD WITH WIDGETS
        class MainDashboard extends DashboardLayout {
            render() {
                const user = this.user;
                const ratings = DB.getUserRatings(user.id);
                const approvedRatings = ratings.filter(r => r.status === 'approved');
                const pendingRatings = ratings.filter(r => r.status === 'pending');
                const avgRating = approvedRatings.length > 0 
                    ? approvedRatings.reduce((sum, r) => sum + r.value, 0) / approvedRatings.length 
                    : 0;
                
                const goals = DB.getUserGoals(user.id);
                const activeGoals = goals.filter(g => g.status !== 'completed').length;
                const completedGoals = goals.filter(g => g.status === 'completed').length;
                
                const notifications = DB.getUserNotifications(user.id);
                const unreadNotifications = notifications.filter(n => !n.read).length;
                
                const today = new Date().toISOString().split('T')[0];
                const todayEvents = DB.getUserEvents(user.id).filter(e => 
                    e.start.startsWith(today)
                );
                
                let html = `
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon primary">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${avgRating.toFixed(1)}</div>
                                <div class="stat-label">Ð’Ð°Ñˆ ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</div>
                                <div class="stat-change positive">+0.2 Ð·Ð° Ð¼ÐµÑÑÑ†</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon success">
                                <i class="fas fa-bullseye"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${activeGoals}</div>
                                <div class="stat-label">ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ†ÐµÐ»ÐµÐ¹</div>
                                ${completedGoals > 0 ? `<div class="stat-change positive">${completedGoals} Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾</div>` : ''}
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon warning">
                                <i class="fas fa-bell"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${unreadNotifications}</div>
                                <div class="stat-label">ÐÐ¾Ð²Ñ‹Ñ… ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹</div>
                                ${unreadNotifications > 0 ? `<div class="stat-change warning">Ð¢Ñ€ÐµÐ±ÑƒÑŽÑ‚ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ñ</div>` : ''}
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon info">
                                <i class="fas fa-calendar"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-value">${todayEvents.length}</div>
                                <div class="stat-label">Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ð¹ ÑÐµÐ³Ð¾Ð´Ð½Ñ</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="dashboard-card-wide">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-chart-line"></i>
                                        ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ Ñ€Ð°Ð·Ð²Ð¸Ñ‚Ð¸Ñ
                                    </div>
                                    <button class="btn btn-outline btn-sm" onclick="App.navigateTo('my-skills')">
                                        <i class="fas fa-arrow-right"></i> Ð’ÑÐµ Ð½Ð°Ð²Ñ‹ÐºÐ¸
                                    </button>
                                </div>
                                <div class="card-body">
                                    <canvas id="progressChart" height="200"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-bullseye"></i>
                                        Ð‘Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ðµ Ñ†ÐµÐ»Ð¸
                                    </div>
                                    <button class="btn btn-primary btn-sm" onclick="addQuickGoal()">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                                <div class="card-body">
                                    ${goals.length > 0 ? this.renderQuickGoals(goals) : `
                                        <div style="text-align: center; padding: 20px; color: var(--text-light);">
                                            <p>ÐÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ†ÐµÐ»ÐµÐ¹</p>
                                            <button class="btn btn-sm btn-primary" onclick="addQuickGoal()">
                                                <i class="fas fa-plus"></i> Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ†ÐµÐ»ÑŒ
                                            </button>
                                        </div>
                                    `}
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card-wide">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-calendar-alt"></i>
                                        ÐŸÑ€ÐµÐ´ÑÑ‚Ð¾ÑÑ‰Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ
                                    </div>
                                    <button class="btn btn-outline btn-sm" onclick="App.navigateTo('calendar')">
                                        <i class="fas fa-calendar"></i> ÐšÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ
                                    </button>
                                </div>
                                <div class="card-body">
                                    ${todayEvents.length > 0 ? this.renderTodayEvents(todayEvents) : `
                                        <div style="text-align: center; padding: 20px; color: var(--text-light);">
                                            <i class="fas fa-calendar-times" style="font-size: 2rem; margin-bottom: 12px;"></i>
                                            <p>ÐÐ° ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð½ÐµÑ‚</p>
                                        </div>
                                    `}
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card">
                                <div class="card-header">
                                    <div class="card-title">
                                        <i class="fas fa-trophy"></i>
                                        Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div style="text-align: center;">
                                        <div class="avatar" style="width: 80px; height: 80px; font-size: 1.5rem; margin: 0 auto 16px; background: linear-gradient(135deg, #f59e0b, #f97316);">
                                            <i class="fas fa-medal"></i>
                                        </div>
                                        <h4 style="margin-bottom: 8px;">${this.getAchievementTitle(avgRating)}</h4>
                                        <p style="color: var(--text-sec); font-size: 0.9rem;">${this.getAchievementDescription(avgRating)}</p>
                                        <div class="progress-bar" style="margin: 16px 0;">
                                            <div class="progress-fill" style="width: ${(avgRating / 5) * 100}%"></div>
                                        </div>
                                        <div style="font-size: 0.85rem; color: var(--text-light);">
                                            Ð”Ð¾ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ³Ð¾ ÑƒÑ€Ð¾Ð²Ð½Ñ: ${(5 - avgRating).toFixed(1)} Ð±Ð°Ð»Ð»Ð¾Ð²
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        ${user.role === 'manager' || user.role === 'admin' ? `
                            <div class="dashboard-card-full">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="card-title">
                                            <i class="fas fa-chart-pie"></i>
                                            Ð‘Ñ‹ÑÑ‚Ñ€Ð°Ñ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° Ð´Ð»Ñ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð°
                                        </div>
                                        <button class="btn btn-primary btn-sm" onclick="App.navigateTo('reports')">
                                            <i class="fas fa-chart-bar"></i> ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ð°Ñ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ°
                                        </button>
                                    </div>
                                    <div class="card-body">
                                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                                            ${this.renderManagerQuickStats()}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-rocket"></i>
                                Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 16px;">
                                <button class="btn btn-outline" style="padding: 20px; text-align: center;" onclick="App.navigateTo('my-skills')">
                                    <i class="fas fa-layer-group" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                                    <div>ÐžÑ†ÐµÐ½Ð¸Ñ‚ÑŒ Ð½Ð°Ð²Ñ‹ÐºÐ¸</div>
                                </button>
                                <button class="btn btn-outline" style="padding: 20px; text-align: center;" onclick="addQuickGoal()">
                                    <i class="fas fa-bullseye" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                                    <div>Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ†ÐµÐ»ÑŒ</div>
                                </button>
                                <button class="btn btn-outline" style="padding: 20px; text-align: center;" onclick="App.navigateTo('profile')">
                                    <i class="fas fa-user-circle" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                                    <div>ÐœÐ¾Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ</div>
                                </button>
                                <button class="btn btn-outline" style="padding: 20px; text-align: center;" onclick="App.navigateTo('notifications')">
                                    <i class="fas fa-bell" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                                    <div>Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ</div>
                                    ${unreadNotifications > 0 ? `<span class="badge badge-danger" style="position: absolute; top: 8px; right: 8px;">${unreadNotifications}</span>` : ''}
                                </button>
                                ${user.role === 'manager' ? `
                                    <button class="btn btn-outline" style="padding: 20px; text-align: center;" onclick="App.navigateTo('team')">
                                        <i class="fas fa-users" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                                        <div>ÐœÐ¾Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°</div>
                                    </button>
                                ` : ''}
                                ${user.role === 'admin' ? `
                                    <button class="btn btn-outline" style="padding: 20px; text-align: center;" onclick="App.navigateTo('admin-users')">
                                        <i class="fas fa-user-cog" style="font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                                        <div>Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ</div>
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
                
                // Quick goal function
                window.addQuickGoal = () => {
                    UI.modal({
                        title: 'Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ»Ð¸',
                        size: 'md',
                        content: `
                            <div class="form-group">
                                <label class="form-label">ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸</label>
                                <input class="form-control" id="quickGoalTitle" placeholder="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ñ‡ÐµÑ‚">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ð¡Ñ€Ð¾Ðº (Ð´Ð½ÐµÐ¹)</label>
                                <select class="form-control" id="quickGoalDays">
                                    <option value="7">1 Ð½ÐµÐ´ÐµÐ»Ñ</option>
                                    <option value="14" selected>2 Ð½ÐµÐ´ÐµÐ»Ð¸</option>
                                    <option value="30">1 Ð¼ÐµÑÑÑ†</option>
                                    <option value="90">3 Ð¼ÐµÑÑÑ†Ð°</option>
                                </select>
                            </div>
                        `,
                        onConfirm: () => {
                            const title = document.getElementById('quickGoalTitle').value.trim();
                            const days = parseInt(document.getElementById('quickGoalDays').value);
                            
                            if (!title) {
                                UI.toast('Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸', 'error');
                                return false;
                            }
                            
                            const deadline = new Date();
                            deadline.setDate(deadline.getDate() + days);
                            
                            DB.addGoal(user.id, {
                                title,
                                deadline: deadline.toISOString().split('T')[0],
                                status: 'not_started',
                                progress: 0,
                                priority: 'medium'
                            });
                            
                            UI.toast('Ð¦ÐµÐ»ÑŒ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð°', 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                return this.wrapper(html, 'Ð“Ð»Ð°Ð²Ð½Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ');
            }
            
            renderQuickGoals(goals) {
                const activeGoals = goals.filter(g => g.status !== 'completed').slice(0, 3);
                
                if (activeGoals.length === 0) {
                    return '<p style="text-align: center; color: var(--text-light);">ÐÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ†ÐµÐ»ÐµÐ¹</p>';
                }
                
                return activeGoals.map(goal => `
                    <div style="background: var(--bg-hover); padding: 12px; border-radius: var(--radius-md); margin-bottom: 12px; border-left: 3px solid var(--primary);">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <div>
                                <strong style="font-size: 0.95rem;">${goal.title}</strong>
                                <div style="font-size: 0.8rem; color: var(--text-light);">
                                    Ð”Ð¾: ${UI.formatDate(goal.deadline)}
                                </div>
                            </div>
                            <span class="badge badge-${goal.priority === 'high' ? 'danger' : goal.priority === 'medium' ? 'warning' : 'info'} badge-sm">
                                ${goal.priority}
                            </span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${goal.progress}%"></div>
                        </div>
                        <div style="font-size: 0.8rem; color: var(--text-sec); text-align: right; margin-top: 4px;">
                            ${goal.progress}%
                        </div>
                    </div>
                `).join('');
            }
            
            renderTodayEvents(events) {
                return events.map(event => {
                    const startTime = event.start.split('T')[1].substring(0, 5);
                    const endTime = event.end.split('T')[1].substring(0, 5);
                    
                    return `
                        <div style="background: var(--bg-hover); padding: 12px; border-radius: var(--radius-md); margin-bottom: 12px; border-left: 3px solid var(--${event.type === 'meeting' ? 'primary' : event.type === 'training' ? 'success' : 'warning'});">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <strong style="font-size: 0.95rem;">${event.title}</strong>
                                    <div style="font-size: 0.8rem; color: var(--text-light);">
                                        ${startTime} - ${endTime}
                                    </div>
                                </div>
                                <span class="badge badge-${event.type === 'meeting' ? 'primary' : event.type === 'training' ? 'success' : 'warning'} badge-sm">
                                    ${event.type === 'meeting' ? 'Ð’ÑÑ‚Ñ€ÐµÑ‡Ð°' : event.type === 'training' ? 'ÐžÐ±ÑƒÑ‡ÐµÐ½Ð¸Ðµ' : 'ÐžÑ†ÐµÐ½ÐºÐ°'}
                                </span>
                            </div>
                            ${event.description ? `
                                <div style="font-size: 0.85rem; color: var(--text-sec); margin-top: 8px;">
                                    ${event.description}
                                </div>
                            ` : ''}
                        </div>
                    `;
                }).join('');
            }
            
            getAchievementTitle(rating) {
                if (rating >= 4.5) return 'Ð­ÐºÑÐ¿ÐµÑ€Ñ‚';
                if (rating >= 4.0) return 'ÐŸÑ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»';
                if (rating >= 3.0) return 'Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚';
                if (rating >= 2.0) return 'ÐÐ°Ñ‡Ð¸Ð½Ð°ÑŽÑ‰Ð¸Ð¹';
                return 'ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº';
            }
            
            getAchievementDescription(rating) {
                if (rating >= 4.5) return 'Ð’Ñ‹ÑÑˆÐ¸Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹';
                if (rating >= 4.0) return 'ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð½Ð°Ð²Ñ‹ÐºÐ¸';
                if (rating >= 3.0) return 'Ð¡Ñ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð¾ÑÑ‚ ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹';
                if (rating >= 2.0) return 'ÐžÑÐ²Ð¾ÐµÐ½Ð¸Ðµ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ñ… Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²';
                return 'ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿ÑƒÑ‚Ð¸';
            }
            
            renderManagerQuickStats() {
                if (this.user.role !== 'manager' && this.user.role !== 'admin') return '';
                
                const team = DB.getUsersByDept(this.user.dept);
                const pendingReviews = DB.state.ratings.filter(r => 
                    team.some(u => u.id === r.userId) && r.status === 'pending'
                ).length;
                
                const lowRatings = team.filter(user => {
                    const ratings = DB.getUserRatings(user.id).filter(r => r.status === 'approved');
                    const avg = ratings.length > 0 ? 
                        ratings.reduce((sum, r) => sum + r.value, 0) / ratings.length : 0;
                    return avg < 3;
                }).length;
                
                const upcomingReviews = DB.state.events.filter(e => 
                    e.participants.includes(this.user.id) && 
                    e.type === 'review' &&
                    new Date(e.start) > new Date()
                ).length;
                
                return `
                    <div style="text-align: center;">
                        <div style="font-size: 2rem; font-weight: 800; color: var(--warning);">${pendingReviews}</div>
                        <div style="font-size: 0.9rem; color: var(--text-sec);">ÐžÑ†ÐµÐ½Ð¾Ðº Ð½Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 2rem; font-weight: 800; color: var(--danger);">${lowRatings}</div>
                        <div style="font-size: 0.9rem; color: var(--text-sec);">ÐÐ¸Ð·ÐºÐ¸Ðµ Ð¾Ñ†ÐµÐ½ÐºÐ¸</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 2rem; font-weight: 800; color: var(--info);">${upcomingReviews}</div>
                        <div style="font-size: 0.9rem; color: var(--text-sec);">ÐŸÑ€ÐµÐ´ÑÑ‚Ð¾ÑÑ‰Ð¸Ðµ Ð²ÑÑ‚Ñ€ÐµÑ‡Ð¸</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 2rem; font-weight: 800; color: var(--success);">${team.length}</div>
                        <div style="font-size: 0.9rem; color: var(--text-sec);">Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð² Ð² Ð¾Ñ‚Ð´ÐµÐ»Ðµ</div>
                    </div>
                `;
            }
            
            postRender() {
                // Render progress chart
                const ctx = document.getElementById('progressChart')?.getContext('2d');
                if (ctx) {
                    const ratings = DB.getUserRatings(this.user.id);
                    const monthlyData = this.getMonthlyProgress(ratings);
                    
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: monthlyData.labels,
                            datasets: [{
                                label: 'Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»',
                                data: monthlyData.data,
                                borderColor: 'rgb(99, 102, 241)',
                                backgroundColor: 'rgba(99, 102, 241, 0.1)',
                                fill: true,
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    min: 0,
                                    max: 5
                                }
                            }
                        }
                    });
                }
            }
            
            getMonthlyProgress(ratings) {
                // Generate last 6 months data
                const labels = [];
                const data = [];
                
                for (let i = 5; i >= 0; i--) {
                    const date = new Date();
                    date.setMonth(date.getMonth() - i);
                    const monthYear = date.toLocaleDateString('ru-RU', { month: 'short', year: '2-digit' });
                    labels.push(monthYear);
                    
                    // Simulate data (in real app, would filter by month)
                    const base = 3.0;
                    const variation = Math.sin(i) * 0.5 + 0.5;
                    data.push(parseFloat((base + variation).toFixed(1)));
                }
                
                return { labels, data };
            }
        }

        /**
         * ==================================================================================
         * PART 4: ADDITIONAL VIEWS (Calendar, Goals, Search)
         * ==================================================================================
         */
        
        class CalendarView extends DashboardLayout {
            render() {
                const events = DB.getUserEvents(this.user.id);
                const today = new Date();
                
                let html = `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-calendar-alt"></i>
                                ÐšÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary" onclick="addEventModal()">
                                    <i class="fas fa-plus"></i> Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ
                                </button>
                                <button class="btn btn-outline" onclick="exportCalendar()">
                                    <i class="fas fa-download"></i> Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                                <div>
                                    <h3 style="margin: 0;">${today.toLocaleDateString('ru-RU', { month: 'long', year: 'numeric' })}</h3>
                                    <p style="margin: 4px 0 0 0; color: var(--text-sec);">${events.length} ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹</p>
                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-outline" onclick="changeMonth(-1)">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                    <button class="btn btn-outline" onclick="changeMonth(0)" style="min-width: 100px;">
                                        Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ
                                    </button>
                                    <button class="btn btn-outline" onclick="changeMonth(1)">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="calendar">
                                <div class="calendar-header">
                                    <div>ÐŸÐ½</div>
                                    <div>Ð’Ñ‚</div>
                                    <div>Ð¡Ñ€</div>
                                    <div>Ð§Ñ‚</div>
                                    <div>ÐŸÑ‚</div>
                                    <div>Ð¡Ð±</div>
                                    <div>Ð’Ñ</div>
                                </div>
                                <div class="calendar-grid" id="calendarGrid">
                                    ${this.generateCalendarGrid(today, events)}
                                </div>
                            </div>
                            
                            <div style="margin-top: 32px;">
                                <h3 style="margin-bottom: 16px;">ÐŸÑ€ÐµÐ´ÑÑ‚Ð¾ÑÑ‰Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ</h3>
                                <div id="upcomingEvents">
                                    ${this.renderUpcomingEvents(events)}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                window.changeMonth = (delta) => {
                    // Simplified month navigation
                    UI.toast('ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Ð¼ÐµÑÑÑ†Ð°Ð¼ Ð² Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ', 'info');
                };
                
                window.addEventModal = () => {
                    const team = DB.getUsersByDept(this.user.dept);
                    
                    UI.modal({
                        title: 'ÐÐ¾Ð²Ð¾Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ',
                        size: 'lg',
                        content: `
                            <div class="form-group">
                                <label class="form-label required">ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ</label>
                                <input class="form-control" id="eventTitle" placeholder="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Ð•Ð¶ÐµÐ½ÐµÐ´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¼Ð¸Ñ‚Ð¸Ð½Ð³">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ</label>
                                <textarea class="form-control" id="eventDescription" rows="3" placeholder="ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ..."></textarea>
                            </div>
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð”Ð°Ñ‚Ð° Ð½Ð°Ñ‡Ð°Ð»Ð°</label>
                                    <input class="form-control" type="date" id="eventStartDate" value="${new Date().toISOString().split('T')[0]}">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð’Ñ€ÐµÐ¼Ñ Ð½Ð°Ñ‡Ð°Ð»Ð°</label>
                                    <input class="form-control" type="time" id="eventStartTime" value="10:00">
                                </div>
                            </div>
                            <div class="row" style="display: flex; gap: 16px; margin: 0 -8px;">
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð”Ð°Ñ‚Ð° Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ</label>
                                    <input class="form-control" type="date" id="eventEndDate" value="${new Date().toISOString().split('T')[0]}">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label class="form-label required">Ð’Ñ€ÐµÐ¼Ñ Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ</label>
                                    <input class="form-control" type="time" id="eventEndTime" value="11:00">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label required">Ð¢Ð¸Ð¿ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ</label>
                                <select class="form-control" id="eventType">
                                    <option value="meeting">Ð’ÑÑ‚Ñ€ÐµÑ‡Ð°</option>
                                    <option value="training">ÐžÐ±ÑƒÑ‡ÐµÐ½Ð¸Ðµ</option>
                                    <option value="review">ÐžÑ†ÐµÐ½ÐºÐ° ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¹</option>
                                    <option value="other">Ð”Ñ€ÑƒÐ³Ð¾Ðµ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ð£Ñ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¸</label>
                                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 8px; max-height: 200px; overflow-y: auto;">
                                    ${team.map(user => `
                                        <label class="form-check">
                                            <input type="checkbox" class="form-check-input" value="${user.id}" ${user.id === this.user.id ? 'checked disabled' : ''}>
                                            <span class="form-check-label">${user.name}</span>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>
                        `,
                        onConfirm: () => {
                            const title = document.getElementById('eventTitle').value.trim();
                            const description = document.getElementById('eventDescription').value.trim();
                            const startDate = document.getElementById('eventStartDate').value;
                            const startTime = document.getElementById('eventStartTime').value;
                            const endDate = document.getElementById('eventEndDate').value;
                            const endTime = document.getElementById('eventEndTime').value;
                            const type = document.getElementById('eventType').value;
                            
                            const participants = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => parseInt(cb.value));
                            
                            if (!title || !startDate || !startTime || !endDate || !endTime) {
                                UI.toast('Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ', 'error');
                                return false;
                            }
                            
                            const event = {
                                title,
                                description,
                                start: `${startDate}T${startTime}:00`,
                                end: `${endDate}T${endTime}:00`,
                                type,
                                participants
                            };
                            
                            DB.addEvent(event);
                            UI.toast('Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾', 'success');
                            App.render();
                            return true;
                        }
                    });
                };
                
                window.exportCalendar = () => {
                    const events = DB.getUserEvents(this.user.id);
                    let ics = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//SkillMatrix//Calendar//RU
`;
                    
                    events.forEach(event => {
                        ics += `BEGIN:VEVENT
SUMMARY:${event.title}
DESCRIPTION:${event.description || ''}
DTSTART:${event.start.replace(/[-:]/g, '').split('.')[0]}
DTEND:${event.end.replace(/[-:]/g, '').split('.')[0]}
END:VEVENT
`;
                    });
                    
                    ics += `END:VCALENDAR`;
                    
                    const blob = new Blob([ics], { type: 'text/calendar;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `calendar_${new Date().toISOString().split('T')[0]}.ics`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    UI.toast('ÐšÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð² iCal', 'success');
                };
                
                return this.wrapper(html, 'ÐšÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ');
            }
            
            generateCalendarGrid(date, events) {
                const year = date.getFullYear();
                const month = date.getMonth();
                const firstDay = new Date(year, month, 1).getDay();
                const lastDate = new Date(year, month + 1, 0).getDate();
                const lastDay = new Date(year, month, lastDate).getDay();
                
                const prevMonthLastDate = new Date(year, month, 0).getDate();
                
                let html = '';
                
                // Previous month days
                for (let i = firstDay === 0 ? 6 : firstDay - 1; i > 0; i--) {
                    const day = prevMonthLastDate - i + 1;
                    html += `<div class="calendar-day other-month">${day}</div>`;
                }
                
                // Current month days
                const today = new Date().toDateString();
                for (let day = 1; day <= lastDate; day++) {
                    const currentDate = new Date(year, month, day);
                    const isToday = currentDate.toDateString() === today;
                    const dayEvents = events.filter(e => 
                        e.start.startsWith(currentDate.toISOString().split('T')[0])
                    );
                    
                    html += `<div class="calendar-day ${isToday ? 'today' : ''}">`;
                    html += `<div style="font-weight: 600; margin-bottom: 8px;">${day}</div>`;
                    
                    dayEvents.slice(0, 2).forEach(event => {
                        const typeColor = event.type === 'meeting' ? 'success' : 
                                         event.type === 'training' ? 'warning' : 'primary';
                        html += `<div class="calendar-event" style="background: var(--${typeColor}-light); color: var(--${typeColor});">
                            ${event.title}
                        </div>`;
                    });
                    
                    if (dayEvents.length > 2) {
                        html += `<div class="calendar-event" style="background: var(--bg-hover); color: var(--text-sec);">
                            +${dayEvents.length - 2} ÐµÑ‰Ðµ
                        </div>`;
                    }
                    
                    html += `</div>`;
                }
                
                // Next month days
                for (let i = lastDay === 0 ? 0 : 7 - lastDay; i > 0; i--) {
                    html += `<div class="calendar-day other-month">${i}</div>`;
                }
                
                return html;
            }
            
            renderUpcomingEvents(events) {
                const now = new Date();
                const upcoming = events
                    .filter(e => new Date(e.start) > now)
                    .sort((a, b) => new Date(a.start) - new Date(b.start))
                    .slice(0, 5);
                
                if (upcoming.length === 0) {
                    return '<p style="text-align: center; color: var(--text-light); padding: 20px;">ÐŸÑ€ÐµÐ´ÑÑ‚Ð¾ÑÑ‰Ð¸Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð½ÐµÑ‚</p>';
                }
                
                return upcoming.map(event => {
                    const startDate = new Date(event.start);
                    const endDate = new Date(event.end);
                    const typeColor = event.type === 'meeting' ? 'primary' : 
                                    event.type === 'training' ? 'success' : 'warning';
                    
                    return `
                        <div style="background: var(--bg-hover); padding: 16px; border-radius: var(--radius-md); margin-bottom: 12px; border-left: 4px solid var(--${typeColor});">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h4 style="margin: 0 0 8px 0; font-size: 1rem;">${event.title}</h4>
                                    <div style="font-size: 0.85rem; color: var(--text-light);">
                                        <i class="fas fa-calendar"></i> ${startDate.toLocaleDateString('ru-RU')}
                                        <i class="fas fa-clock" style="margin-left: 12px;"></i> ${startDate.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })}
                                        - ${endDate.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })}
                                    </div>
                                    ${event.description ? `
                                        <div style="font-size: 0.9rem; color: var(--text-sec); margin-top: 8px;">
                                            ${event.description}
                                        </div>
                                    ` : ''}
                                </div>
                                <span class="badge badge-${typeColor}">
                                    ${event.type === 'meeting' ? 'Ð’ÑÑ‚Ñ€ÐµÑ‡Ð°' : event.type === 'training' ? 'ÐžÐ±ÑƒÑ‡ÐµÐ½Ð¸Ðµ' : 'ÐžÑ†ÐµÐ½ÐºÐ°'}
                                </span>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        class GoalsView extends DashboardLayout {
            render() {
                const goals = DB.getUserGoals(this.user.id);
                
                let html = `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-bullseye"></i>
                                ÐœÐ¾Ð¸ Ñ†ÐµÐ»Ð¸
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary" onclick="addGoal()">
                                    <i class="fas fa-plus"></i> ÐÐ¾Ð²Ð°Ñ Ñ†ÐµÐ»ÑŒ
                                </button>
                                <button class="btn btn-outline" onclick="exportGoals()">
                                    <i class="fas fa-download"></i> Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="tabs" id="goalsTabs">
                                <div class="tab active" onclick="switchGoalsTab('all')">Ð’ÑÐµ Ñ†ÐµÐ»Ð¸</div>
                                <div class="tab" onclick="switchGoalsTab('active')">ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ</div>
                                <div class="tab" onclick="switchGoalsTab('completed')">Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ðµ</div>
                            </div>
                            <div id="goalsTabContent" style="margin-top: 24px;"></div>
                        </div>
                    </div>
                `;
                
                window.switchGoalsTab = (tab) => {
                    const tabs = document.querySelectorAll('#goalsTabs .tab');
                    tabs.forEach(t => t.classList.remove('active'));
                    event.target.classList.add('active');
                    
                    const container = document.getElementById('goalsTabContent');
                    container.innerHTML = this.renderGoalsTab(tab, goals);
                };
                
                window.addGoal = () => {
                    // Reuse the addGoal function from UserProfile
                    if (typeof window.addGoalFromProfile !== 'undefined') {
                        window.addGoalFromProfile();
                    } else {
                        UI.modal({
                            title: 'ÐÐ¾Ð²Ð°Ñ Ñ†ÐµÐ»ÑŒ',
                            content: `
                                <div class="form-group">
                                    <label class="form-label">ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸</label>
                                    <input class="form-control" id="newGoalTitle" placeholder="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Ð˜Ð·ÑƒÑ‡Ð¸Ñ‚ÑŒ TypeScript">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ</label>
                                    <textarea class="form-control" id="newGoalDescription" rows="3" placeholder="Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ†ÐµÐ»Ð¸..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚</label>
                                    <select class="form-control" id="newGoalPriority">
                                        <option value="high">Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹</option>
                                        <option value="medium" selected>Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹</option>
                                        <option value="low">ÐÐ¸Ð·ÐºÐ¸Ð¹</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Ð”ÐµÐ´Ð»Ð°Ð¹Ð½</label>
                                    <input class="form-control" type="date" id="newGoalDeadline" value="${new Date(Date.now() + 30*24*60*60*1000).toISOString().split('T')[0]}">
                                </div>
                            `,
                            onConfirm: () => {
                                const title = document.getElementById('newGoalTitle').value.trim();
                                const description = document.getElementById('newGoalDescription').value.trim();
                                const priority = document.getElementById('newGoalPriority').value;
                                const deadline = document.getElementById('newGoalDeadline').value;
                                
                                if (!title || !deadline) {
                                    UI.toast('Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ', 'error');
                                    return false;
                                }
                                
                                DB.addGoal(this.user.id, {
                                    title,
                                    description,
                                    priority,
                                    deadline,
                                    status: 'not_started',
                                    progress: 0
                                });
                                
                                UI.toast('Ð¦ÐµÐ»ÑŒ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð°', 'success');
                                App.render();
                                return true;
                            }
                        });
                    }
                };
                
                window.exportGoals = () => {
                    const goals = DB.getUserGoals(this.user.id);
                    let csv = 'Ð¦ÐµÐ»ÑŒ,ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ,Ð¡Ñ‚Ð°Ñ‚ÑƒÑ,ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ%,ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚,Ð”ÐµÐ´Ð»Ð°Ð¹Ð½\n';
                    
                    goals.forEach(goal => {
                        csv += `"${goal.title}","${goal.description || ''}",${goal.status},${goal.progress},${goal.priority},${goal.deadline}\n`;
                    });
                    
                    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `goals_${this.user.login}_${new Date().toISOString().split('T')[0]}.csv`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    UI.toast('Ð¦ÐµÐ»Ð¸ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹', 'success');
                };
                
                // Initial render
                setTimeout(() => {
                    const container = document.getElementById('goalsTabContent');
                    if (container) {
                        container.innerHTML = this.renderGoalsTab('all', goals);
                    }
                }, 100);
                
                return this.wrapper(html, 'ÐœÐ¾Ð¸ Ñ†ÐµÐ»Ð¸');
            }
            
            renderGoalsTab(tab, allGoals) {
                let goals = allGoals;
                
                if (tab === 'active') {
                    goals = goals.filter(g => g.status !== 'completed');
                } else if (tab === 'completed') {
                    goals = goals.filter(g => g.status === 'completed');
                }
                
                if (goals.length === 0) {
                    return `
                        <div style="text-align: center; padding: 40px; color: var(--text-light);">
                            <i class="fas fa-bullseye" style="font-size: 3rem; margin-bottom: 16px;"></i>
                            <p>${tab === 'all' ? 'ÐÐµÑ‚ Ñ†ÐµÐ»ÐµÐ¹' : tab === 'active' ? 'ÐÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ†ÐµÐ»ÐµÐ¹' : 'ÐÐµÑ‚ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ñ… Ñ†ÐµÐ»ÐµÐ¹'}</p>
                            ${tab !== 'completed' ? `
                                <button class="btn btn-primary mt-3" onclick="addGoal()">
                                    <i class="fas fa-plus"></i> Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ†ÐµÐ»ÑŒ
                                </button>
                            ` : ''}
                        </div>
                    `;
                }
                
                return `
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px;">
                        ${goals.map(goal => {
                            const priorityColors = {
                                high: 'danger',
                                medium: 'warning',
                                low: 'info'
                            };
                            
                            const statusColors = {
                                not_started: 'secondary',
                                in_progress: 'warning',
                                completed: 'success'
                            };
                            
                            const statusIcons = {
                                not_started: 'fa-clock',
                                in_progress: 'fa-spinner fa-pulse',
                                completed: 'fa-check-circle'
                            };
                            
                            return `
                                <div class="card">
                                    <div class="card-header" style="padding: 16px;">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <span class="badge badge-${priorityColors[goal.priority] || 'secondary'}">${goal.priority}</span>
                                                <span class="badge badge-${statusColors[goal.status] || 'secondary'}" style="margin-left: 8px;">
                                                    <i class="fas ${statusIcons[goal.status] || 'fa-clock'}"></i> ${goal.status}
                                                </span>
                                            </div>
                                            <div class="btn-group">
                                                <button class="btn btn-sm btn-outline" onclick="editGoal('${goal.id}')">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="btn btn-sm btn-outline" onclick="deleteGoal('${goal.id}')">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-body" style="padding: 16px;">
                                        <h4 style="margin-bottom: 8px; font-size: 1.1rem;">${goal.title}</h4>
                                        ${goal.description ? `<p style="color: var(--text-sec); margin-bottom: 12px; font-size: 0.9rem;">${goal.description}</p>` : ''}
                                        
                                        <div class="progress-bar" style="margin: 12px 0;">
                                            <div class="progress-fill" style="width: ${goal.progress}%"></div>
                                        </div>
                                        <div class="d-flex justify-content-between" style="font-size: 0.85rem; color: var(--text-sec);">
                                            <span>ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ: ${goal.progress}%</span>
                                            <span>Ð”Ð¾: ${UI.formatDate(goal.deadline)}</span>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            }
        }

        class ManagerSearch extends DashboardLayout {
            render() {
                const skills = DB.getSkills();
                
                let html = `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-search"></i>
                                ÐŸÐ¾Ð¸ÑÐº Ñ‚Ð°Ð»Ð°Ð½Ñ‚Ð¾Ð²
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">ÐšÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¸ Ð¿Ð¾Ð¸ÑÐºÐ°</label>
                                <div class="filter-bar" id="filterContainer" style="min-height: 60px; display: flex; flex-wrap: wrap; gap: 8px; align-items: center;">
                                    <div style="color: var(--text-light); font-size: 0.9rem;">Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¸ Ð¿Ð¾Ð¸ÑÐºÐ°</div>
                                </div>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                                <div>
                                    <label class="form-label">ÐÐ°Ð²Ñ‹Ðº</label>
                                    <select class="form-control" id="fSkill">
                                        <option value="">Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð½Ð°Ð²Ñ‹Ðº</option>
                                        ${skills.map(s => `<option value="${s.id}">${s.name}</option>`).join('')}
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label">ÐžÐ¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€</label>
                                    <select class="form-control" id="fOp">
                                        <option value="gte">â‰¥ (Ð½Ðµ Ð¼ÐµÐ½ÑŒÑˆÐµ)</option>
                                        <option value="eq">= (Ñ€Ð°Ð²Ð½Ð¾)</option>
                                        <option value="lte">â‰¤ (Ð½Ðµ Ð±Ð¾Ð»ÑŒÑˆÐµ)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label">Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ</label>
                                    <select class="form-control" id="fVal">
                                        <option value="1">1 - ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº</option>
                                        <option value="2">2 - ÐÐ°Ñ‡Ð¸Ð½Ð°ÑŽÑ‰Ð¸Ð¹</option>
                                        <option value="3" selected>3 - ÐšÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ‚Ð½Ñ‹Ð¹</option>
                                        <option value="4">4 - ÐžÐ¿Ñ‹Ñ‚Ð½Ñ‹Ð¹</option>
                                        <option value="5">5 - Ð­ÐºÑÐ¿ÐµÑ€Ñ‚</option>
                                    </select>
                                </div>
                                <div style="display: flex; align-items: flex-end;">
                                    <button class="btn btn-primary" onclick="addFilter()" style="width: 100%;">
                                        <i class="fas fa-plus"></i> Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ
                                    </button>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹</label>
                                <div style="display: flex; gap: 16px; flex-wrap: wrap;">
                                    <div style="min-width: 200px;">
                                        <label class="form-label">ÐžÑ‚Ð´ÐµÐ»</label>
                                        <select class="form-control" id="fDept" multiple style="height: 100px;">
                                            ${CONFIG.depts.map(dept => `<option value="${dept}">${dept}</option>`).join('')}
                                        </select>
                                    </div>
                                    <div style="min-width: 200px;">
                                        <label class="form-label">Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ</label>
                                        <select class="form-control" id="fPosition" multiple style="height: 100px;">
                                            ${CONFIG.positions.map(pos => `<option value="${pos}">${pos}</option>`).join('')}
                                        </select>
                                    </div>
                                    <div>
                                        <label class="form-label">ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</label>
                                        <input type="range" class="form-control" id="fAvgRating" min="0" max="5" step="0.5" value="3" style="width: 200px;">
                                        <div style="display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--text-light);">
                                            <span>0</span>
                                            <span id="avgRatingValue">3.0</span>
                                            <span>5</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="btn btn-success" style="width: 100%; padding: 16px; font-size: 1.1rem;" onclick="runSearch()">
                                <i class="fas fa-search"></i> ÐÐ°Ð¹Ñ‚Ð¸ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²
                            </button>
                        </div>
                    </div>
                    
                    <div id="searchResults" style="margin-top: 32px;"></div>
                `;
                
                window.filters = [];
                
                window.addFilter = () => {
                    const skillSelect = document.getElementById('fSkill');
                    const skillId = skillSelect.value;
                    const skillName = skillSelect.options[skillSelect.selectedIndex].text;
                    const op = document.getElementById('fOp').value;
                    const val = document.getElementById('fVal').value;
                    
                    if (!skillId) {
                        UI.toast('Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð½Ð°Ð²Ñ‹Ðº', 'error');
                        return;
                    }
                    
                    window.filters.push({ 
                        id: skillId, 
                        name: skillName, 
                        op, 
                        val: parseInt(val) 
                    });
                    
                    renderFilters();
                };
                
                window.renderFilters = () => {
                    const container = document.getElementById('filterContainer');
                    container.innerHTML = window.filters.map((f, i) => `
                        <span class="filter-tag">
                            ${f.name} ${f.op === 'gte' ? 'â‰¥' : f.op === 'lte' ? 'â‰¤' : '='} ${f.val}
                            <i class="fas fa-times" style="margin-left: 6px; cursor: pointer;" onclick="removeFilter(${i})"></i>
                        </span>
                    `).join('');
                    
                    if (window.filters.length === 0) {
                        container.innerHTML = '<div style="color: var(--text-light); font-size: 0.9rem;">Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¸ Ð¿Ð¾Ð¸ÑÐºÐ°</div>';
                    }
                };
                
                window.removeFilter = (index) => {
                    window.filters.splice(index, 1);
                    renderFilters();
                };
                
                window.runSearch = () => {
                    const allUsers = DB.getAllUsers().filter(u => u.role === 'employee');
                    const deptFilter = Array.from(document.getElementById('fDept').selectedOptions).map(o => o.value);
                    const positionFilter = Array.from(document.getElementById('fPosition').selectedOptions).map(o => o.value);
                    const avgRatingFilter = parseFloat(document.getElementById('fAvgRating').value);
                    
                    const results = allUsers.filter(user => {
                        // Department filter
                        if (deptFilter.length > 0 && !deptFilter.includes(user.dept)) {
                            return false;
                        }
                        
                        // Position filter
                        if (positionFilter.length > 0 && !positionFilter.includes(user.position)) {
                            return false;
                        }
                        
                        // Average rating filter
                        const ratings = DB.getUserRatings(user.id).filter(r => r.status === 'approved');
                        const avgRating = ratings.length > 0 
                            ? ratings.reduce((sum, r) => sum + r.value, 0) / ratings.length 
                            : 0;
                        
                        if (avgRating < avgRatingFilter) {
                            return false;
                        }
                        
                        // Skill filters
                        return window.filters.every(filter => {
                            const rating = DB.getRating(user.id, filter.id);
                            const userVal = rating ? rating.value : 0;
                            
                            switch (filter.op) {
                                case 'gte': return userVal >= filter.val;
                                case 'lte': return userVal <= filter.val;
                                case 'eq': return userVal === filter.val;
                                default: return true;
                            }
                        });
                    });
                    
                    this.displaySearchResults(results);
                };
                
                this.displaySearchResults = (users) => {
                    const container = document.getElementById('searchResults');
                    
                    if (users.length === 0) {
                        container.innerHTML = `
                            <div class="card">
                                <div class="card-body" style="text-align: center; padding: 40px;">
                                    <i class="fas fa-search" style="font-size: 3rem; color: var(--text-light); margin-bottom: 16px;"></i>
                                    <h3 style="margin-bottom: 8px;">ÐÐ¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾</h3>
                                    <p style="color: var(--text-sec);">ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¸ Ð¿Ð¾Ð¸ÑÐºÐ°</p>
                                </div>
                            </div>
                        `;
                        return;
                    }
                    
                    let html = `
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-users"></i>
                                    ÐÐ°Ð¹Ð´ÐµÐ½Ð¾ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²: ${users.length}
                                </div>
                                <button class="btn btn-primary btn-sm" onclick="exportSearchResults()">
                                    <i class="fas fa-download"></i> Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº</th>
                                                <th>ÐžÑ‚Ð´ÐµÐ»</th>
                                                <th>Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ</th>
                                                <th>Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»</th>
                                                <th>ÐžÑ†ÐµÐ½ÐµÐ½Ð¾ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²</th>
                                                <th>Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                    `;
                    
                    users.forEach(user => {
                        const ratings = DB.getUserRatings(user.id);
                        const approvedRatings = ratings.filter(r => r.status === 'approved');
                        const avgRating = approvedRatings.length > 0 
                            ? approvedRatings.reduce((sum, r) => sum + r.value, 0) / approvedRatings.length 
                            : 0;
                        
                        // Get matched skills for this user
                        const matchedSkills = window.filters.filter(filter => {
                            const rating = DB.getRating(user.id, filter.id);
                            const userVal = rating ? rating.value : 0;
                            return userVal >= filter.val;
                        }).map(f => f.name);
                        
                        html += `
                            <tr onclick="viewUserDetails(${user.id})" style="cursor: pointer;">
                                <td>
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="avatar" style="width: 36px; height: 36px; font-size: 0.9rem;">
                                            ${user.avatar}
                                        </div>
                                        <div>
                                            <div style="font-weight: 600;">${user.name}</div>
                                            <div style="font-size: 0.85rem; color: var(--text-light);">
                                                ${matchedSkills.slice(0, 2).join(', ')}${matchedSkills.length > 2 ? '...' : ''}
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <span class="badge badge-info">${user.dept}</span>
                                </td>
                                <td>${user.position}</td>
                                <td>
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="rating-input">
                                            ${[1,2,3,4,5].map(i => `
                                                <div class="star-btn ${i <= Math.round(avgRating) ? 'active' : ''} readonly"
                                                     style="width: 20px; height: 20px; font-size: 0.7rem;">
                                                    ${i}
                                                </div>
                                            `).join('')}
                                        </div>
                                        <span>${avgRating.toFixed(1)}</span>
                                    </div>
                                </td>
                                <td>${approvedRatings.length}</td>
                                <td>
                                    <button class="btn btn-sm btn-outline" onclick="event.stopPropagation(); giveFeedback(${user.id})">
                                        <i class="fas fa-comment"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    });
                    
                    html += `</tbody></table></div></div></div>`;
                    container.innerHTML = html;
                };
                
                window.exportSearchResults = () => {
                    const allUsers = DB.getAllUsers().filter(u => u.role === 'employee');
                    const deptFilter = Array.from(document.getElementById('fDept').selectedOptions).map(o => o.value);
                    const positionFilter = Array.from(document.getElementById('fPosition').selectedOptions).map(o => o.value);
                    const avgRatingFilter = parseFloat(document.getElementById('fAvgRating').value);
                    
                    const results = allUsers.filter(user => {
                        if (deptFilter.length > 0 && !deptFilter.includes(user.dept)) return false;
                        if (positionFilter.length > 0 && !positionFilter.includes(user.position)) return false;
                        
                        const ratings = DB.getUserRatings(user.id).filter(r => r.status === 'approved');
                        const avgRating = ratings.length > 0 
                            ? ratings.reduce((sum, r) => sum + r.value, 0) / ratings.length 
                            : 0;
                        
                        if (avgRating < avgRatingFilter) return false;
                        
                        return window.filters.every(filter => {
                            const rating = DB.getRating(user.id, filter.id);
                            const userVal = rating ? rating.value : 0;
                            
                            switch (filter.op) {
                                case 'gte': return userVal >= filter.val;
                                case 'lte': return userVal <= filter.val;
                                case 'eq': return userVal === filter.val;
                                default: return true;
                            }
                        });
                    });
                    
                    let csv = 'Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº,ÐžÑ‚Ð´ÐµÐ»,Ð”Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ,Email,Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð±Ð°Ð»Ð»,ÐžÑ†ÐµÐ½ÐµÐ½Ð¾ Ð½Ð°Ð²Ñ‹ÐºÐ¾Ð²\n';
                    results.forEach(user => {
                        const ratings = DB.getUserRatings(user.id).filter(r => r.status === 'approved');
                        const avgRating = ratings.length > 0 
                            ? ratings.reduce((sum, r) => sum + r.value, 0) / ratings.length 
                            : 0;
                        
                        csv += `"${user.name}","${user.dept}","${user.position}","${user.email}",${avgRating.toFixed(2)},${ratings.length}\n`;
                    });
                    
                    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `search_results_${new Date().toISOString().split('T')[0]}.csv`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    UI.toast('Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¿Ð¾Ð¸ÑÐºÐ° ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹', 'success');
                };
                
                // Initialize avg rating display
                document.getElementById('fAvgRating').oninput = function() {
                    document.getElementById('avgRatingValue').textContent = this.value;
                };
                
                // Add viewUserDetails function if not exists
                if (typeof window.viewUserDetails === 'undefined') {
                    window.viewUserDetails = (userId) => {
                        const user = DB.getUserById(userId);
                        if (!user) return;
                        
                        const modal = UI.modal({
                            title: `ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€: ${user.name}`,
                            size: 'lg',
                            content: `
                                <div style="text-align: center; margin-bottom: 24px;">
                                    <div class="avatar" style="width: 80px; height: 80px; font-size: 1.5rem; margin: 0 auto 16px;">
                                        ${user.avatar}
                                    </div>
                                    <h3>${user.name}</h3>
                                    <p class="text-muted">${user.position} â€¢ ${user.dept}</p>
                                </div>
                                
                                <div style="background: var(--bg-hover); padding: 20px; border-radius: var(--radius-md); margin-bottom: 20px;">
                                    <h4 style="margin-bottom: 16px;">ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ</h4>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>Email</span>
                                        <strong>${user.email}</strong>
                                    </div>
                                    ${user.phone ? `
                                        <div class="d-flex justify-content-between mb-2">
                                            <span>Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½</span>
                                            <strong>${user.phone}</strong>
                                        </div>
                                    ` : ''}
                                    <div class="d-flex justify-content-between">
                                        <span>Ð’ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸ Ñ</span>
                                        <strong>${UI.formatDate(user.hireDate)}</strong>
                                    </div>
                                </div>
                                
                                <button class="btn btn-primary" style="width: 100%;" onclick="App.navigateTo('team'); document.querySelector('.modal-overlay')?.remove();">
                                    <i class="fas fa-external-link-alt"></i> ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð² ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹
                                </button>
                            `,
                            showConfirm: false,
                            cancelText: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ'
                        });
                    };
                }
                
                // Add giveFeedback function if not exists
                if (typeof window.giveFeedback === 'undefined') {
                    window.giveFeedback = (toUserId) => {
                        const skills = DB.getSkills();
                        
                        UI.modal({
                            title: 'Ð”Ð°Ñ‚ÑŒ Ð¾Ð±Ñ€Ð°Ñ‚Ð½ÑƒÑŽ ÑÐ²ÑÐ·ÑŒ',
                            size: 'lg',
                            content: `
                                <div class="form-group">
                                    <label class="form-label">ÐÐ°Ð²Ñ‹Ðº</label>
                                    <select class="form-control" id="feedbackSkill">
                                        <option value="">Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð½Ð°Ð²Ñ‹Ðº</option>
                                        ${skills.map(s => `<option value="${s.id}">${s.name}</option>`).join('')}
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÐžÑ†ÐµÐ½ÐºÐ°</label>
                                    <div class="rating-input" style="justify-content: center; margin: 10px 0;">
                                        ${[1,2,3,4,5].map(i => `
                                            <div class="star-btn" id="star-${i}"
                                                 onclick="document.querySelectorAll('[id^=star-]').forEach(btn => btn.classList.remove('active')); 
                                                          for(let j=1; j<=${i}; j++) document.getElementById('star-'+j).classList.add('active');
                                                          document.getElementById('feedbackRating').value = ${i};"
                                                 style="width: 40px; height: 40px;">
                                                ${i}
                                            </div>
                                        `).join('')}
                                    </div>
                                    <input type="hidden" id="feedbackRating" value="3">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹</label>
                                    <textarea class="form-control" id="feedbackComment" rows="4" placeholder="ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ð¾ Ð¾Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ð¾Ð±Ñ€Ð°Ñ‚Ð½ÑƒÑŽ ÑÐ²ÑÐ·ÑŒ..."></textarea>
                                </div>
                            `,
                            onConfirm: () => {
                                const skillId = document.getElementById('feedbackSkill').value;
                                const rating = parseInt(document.getElementById('feedbackRating').value);
                                const comment = document.getElementById('feedbackComment').value.trim();
                                
                                if (!skillId) {
                                    UI.toast('Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð½Ð°Ð²Ñ‹Ðº', 'error');
                                    return false;
                                }
                                
                                if (!comment) {
                                    UI.toast('Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹', 'error');
                                    return false;
                                }
                                
                                // Assuming fromUserId is current user
                                DB.addFeedback({
                                    fromUserId: Session.user.id,
                                    toUserId,
                                    skillId,
                                    rating,
                                    comment
                                });
                                
                                UI.toast('ÐžÐ±Ñ€Ð°Ñ‚Ð½Ð°Ñ ÑÐ²ÑÐ·ÑŒ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð°', 'success');
                                return true;
                            }
                        });
                    };
                }
                
                return this.wrapper(html, 'ÐŸÐ¾Ð¸ÑÐº Ñ‚Ð°Ð»Ð°Ð½Ñ‚Ð¾Ð²');
            }
        }

        /**
         * ==================================================================================
         * PART 5: APP BOOTSTRAP WITH ALL ROUTES
         * ==================================================================================
         */
        
        // Register all routes
        App.addRoute('login', LoginView);
        App.addRoute('dashboard', MainDashboard);
        
        // Employee routes
        App.addRoute('my-skills', EmployeeSkills);
        App.addRoute('profile', UserProfile);
        App.addRoute('goals', GoalsView);
        
        // Manager routes
        App.addRoute('team', ManagerTeam);
        App.addRoute('compare', ManagerCompare);
        App.addRoute('search', ManagerSearch);
        App.addRoute('calendar', CalendarView);
        
        // Admin routes
        App.addRoute('admin-skills', AdminSkills);
        App.addRoute('admin-users', AdminUsers);
        App.addRoute('reports', AdminReports);
        
        // Common routes
        App.addRoute('notifications', NotificationsView);
        App.addRoute('settings', SettingsView);
        
        // Add role requirements
        App.routes['admin-skills'].requiredRole = 'admin';
        App.routes['admin-users'].requiredRole = 'admin';
        App.routes['reports'].requiredRole = 'manager';
        App.routes['team'].requiredRole = 'manager';
        App.routes['compare'].requiredRole = 'manager';
        App.routes['search'].requiredRole = 'manager';
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            // Show loading animation
            document.getElementById('root').innerHTML = `
                <div class="login-container" style="background: var(--bg-body);">
                    <div style="text-align: center;">
                        <div class="spinner spinner-lg" style="margin: 0 auto 20px;"></div>
                        <h2>SkillMatrix PRO</h2>
                        <p>Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹...</p>
                    </div>
                </div>
            `;
            
            setTimeout(() => {
                App.init();
            }, 500);
        });

        // Make App globally available for navigation
        window.App = App;
        window.Session = Session;
        window.DB = DB;
        window.UI = UI;
        window.CONFIG = CONFIG;

        // Helper function to check if user is logged in
        window.checkAuth = () => {
            return !!Session.user;
        };
    </script>
</body>
</html>